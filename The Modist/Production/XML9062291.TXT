OBJECT XMLport 9062291 Migrate Enhanced Workflows
{
  OBJECT-PROPERTIES
  {
    Date=07/10/15;
    Time=11:51:40 AM;
    Modified=Yes;
    Version List=NA2016.14;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Migrate Enhanced Workflows;
               ENG=Migrate Enhanced Workflows];
    Encoding=UTF-8;
    Format/Evaluate=XML Format/Evaluate;
    OnInitXMLport=BEGIN
                    MigrationToolkit.InitialiseParameters(XMLPORT::"Migrate Enhanced Workflows", Direction, ErrorLevel, ErrorLevelEnabled);
                  END;

    OnPostXMLport=BEGIN
                    MigrationToolkit.FinalMessage();
                  END;

    Format=Xml;
    FileName=Enhanced Workflows.xml;
  }
  ELEMENTS
  {
    { [{95E8F7A2-D2A3-46CB-AB8D-3C7F70AC7FFE}];  ;Root                ;Element ;Text    ;
                                                  VariableName=dRoot;
                                                  MaxOccurs=Once }

    { [{D39C4DEE-FC4E-45A4-B3FE-41096A663D4E}];1 ;Header              ;Element ;Text    ;
                                                  VariableName=dHeader;
                                                  MaxOccurs=Once }

    { [{723A6B0E-C51F-4F29-8188-8F0CAB4FFC2E}];2 ;XmlPortID           ;Attribute;Text   ;
                                                  VariableName=dXmlPortId;
                                                  Import::OnAfterAssignVariable=BEGIN
                                                                                  MigrationToolkit.CheckXmlPortId(dXmlPortId);
                                                                                END;

                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 dXmlPortId := MigrationToolkit.GetXmlPortIdText();
                                                                               END;
                                                                                }

    { [{929DEBB8-BF16-4F32-BB54-134729134398}];2 ;XmlPortVersion      ;Attribute;Text   ;
                                                  VariableName=dXmlPortVersion;
                                                  Import::OnAfterAssignVariable=BEGIN
                                                                                  MigrationToolkit.CheckXmlPortVersion(dXmlPortVersion);
                                                                                END;

                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 dXmlPortVersion := MigrationToolkit.GetXmlPortVersion();
                                                                               END;
                                                                                }

    { [{3B09761D-9BAD-4304-A2BE-B86E90CA9BFC}];1 ;Data                ;Element ;Text    ;
                                                  VariableName=dData;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{F1F7B97D-F3CE-4365-BB08-F8D263C0043B}];2 ;EnhancedWorkflows   ;Element ;Text    ;
                                                  VariableName=dEnhancedWorkflows;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{D148688F-A37A-4A4C-A463-14A2A14EB6DB}];3 ;EnhancedWorkflow    ;Element ;Table   ;
                                                  ReqFilterFields=Field1;
                                                  VariableName=dEnhancedWorkflow;
                                                  SourceTable=Table9062258;
                                                  AutoUpdate=Yes;
                                                  MinOccurs=Zero;
                                                  Import::OnAfterInitRecord=BEGIN
                                                                              WorkflowInitImport();
                                                                            END;

                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 WorkflowBeforeImport();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             WorkflowBeforeExport();
                                                                           END;

                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 WorkflowBeforeImport();
                                                                               END;
                                                                                }

    { [{F2822F29-1D2F-4C73-BC95-33632F6E44B6}];4 ;No                  ;Attribute;Field  ;
                                                  DataType=Code;
                                                  SourceField=dEnhancedWorkflow::No. }

    { [{B7252DE7-DE09-4C82-AC7E-F69EA9F8F2DC}];4 ;WorkflowType        ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::Workflow Type }

    { [{0E7C05DF-8064-4E93-B6DC-395882345588}];4 ;Enabled             ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Enabled }

    { [{21480CD6-EBD3-4B7E-89DA-A5E3457E0A7A}];4 ;Description         ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Description }

    { [{F9296437-359C-4390-B400-3CED7B9FA72A}];4 ;WhereUsed           ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Where Used }

    { [{66BAABD1-DD96-42FD-BEC5-FE4A47069F85}];4 ;InformationText     ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Information Text }

    { [{744B4EC2-F7B8-4293-BEC9-AC42D983952B}];4 ;InstructionText     ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Instruction Text }

    { [{00679BCB-E586-4ABF-BFA4-2B996F8EF51F}];4 ;SendEMailNotification;Attribute;Field ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Send E-Mail Notification }

    { [{04A6EDA9-30D7-46D3-9ED0-FEF960EDBA27}];4 ;SendPopupNotification;Attribute;Field ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Send Popup Notification }

    { [{AAF6BA63-D151-4835-9593-4689420EACE8}];4 ;DefaultActionText   ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Default Action Text }

    { [{C98EF8AF-5FC0-40A9-8D40-B9A37200949D}];4 ;IncludeWeekends     ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Include Weekends }

    { [{C8651293-40AC-43BF-AC77-138B815EB30B}];4 ;WorkDayStarts       ;Attribute;Field  ;
                                                  DataType=Time;
                                                  SourceField=dEnhancedWorkflow::Work Day Starts }

    { [{E4E66074-2C69-427B-B03A-08E49D466A14}];4 ;WorkDayEnds         ;Attribute;Field  ;
                                                  DataType=Time;
                                                  SourceField=dEnhancedWorkflow::Work Day Ends }

    { [{C43F89B0-42AB-421F-BBAD-CD7B35427597}];4 ;EmbedLink1inEmail   ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Embed Link 1 in Email }

    { [{050C5C35-AF43-4477-9837-499AA9D46F11}];4 ;EmbedLink2inEmail   ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Embed Link 2 in Email }

    { [{9B328EB0-2654-4CA1-BFA6-FF547EAEDB5E}];4 ;EmbedLink3inEmail   ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Embed Link 3 in Email }

    { [{74938365-94B4-42DA-A1C3-6D3E0824B1FA}];4 ;AttachmentFileName  ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Attachment File Name }

    { [{6FD7F646-E132-4F17-8EDB-ECCC52DA4D48}];4 ;AttachedFile        ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Attached File }

    { [{4B1483BD-6856-4D49-8633-0087B401B39A}];4 ;EnableEmailResponse ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Enable Email Response }

    { [{4B37FC6F-9C81-4EBA-B131-B2CCB1C5DCCD}];4 ;RequiredforApproval ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Required for Approval }

    { [{696C1BD2-3100-446B-89F2-41105CA6B6DA}];4 ;NoSeries            ;Attribute;Field  ;
                                                  DataType=Code;
                                                  SourceField=dEnhancedWorkflow::No. Series }

    { [{1CEFEE16-F167-48D8-9083-3D434C1ECEB7}];4 ;OneWorkflowOnly     ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::One Workflow Only }

    { [{564D49EC-654B-4D6B-AAC4-0D770E236944}];4 ;Link1Caption        ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Link 1 Caption }

    { [{348498DE-4FCB-4AFB-A1D4-94F0C796EA4D}];4 ;Link2Caption        ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Link 2 Caption }

    { [{BAFD1022-31BD-49A7-8B9A-9363C1D2F918}];4 ;Link3Caption        ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::Link 3 Caption }

    { [{59054476-D9EA-4FA7-AEB0-D5FCE7B8B3F8}];4 ;ApprovalStatusCode  ;Attribute;Field  ;
                                                  DataType=Code;
                                                  SourceField=dEnhancedWorkflow::Approval Status Code }

    { [{B019B5FA-278E-45FB-B7C0-941B7D5E0CFB}];4 ;TableID             ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Table ID }

    { [{2DE998BF-915D-4E80-91B9-27BB03F2BEE4}];4 ;OnStartSetFieldType ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::On Start Set Field Type }

    { [{C668BCB2-826A-42CF-B1CF-DB3B35F22D26}];4 ;OnStartSetFieldNo   ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::On Start Set Field No. }

    { [{1849AFA7-B8E0-4354-AE57-E4DBE242A402}];4 ;OnStartSetFieldValueType;Attribute;Field;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::On Start Set Field Value Type }

    { [{B62D8A9D-084F-4C71-B548-B451D38417A7}];4 ;OnStartSetFieldValue;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::On Start Set Field Value }

    { [{38F95998-008E-4F67-863F-CAB143620386}];4 ;OnStartAmountFieldType;Attribute;Field;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::On Start Amount Field Type }

    { [{08C0C1EB-87AE-47F9-B289-40349DA370AE}];4 ;OnStartAmountFieldNo;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::On Start Amount Field No. }

    { [{F59FC245-5600-49A3-9D66-B4D20B2C3B9A}];4 ;OnStartRoutingFieldType;Attribute;Field;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::On Start Routing Field Type }

    { [{831A0F27-31DF-4D14-AF3E-0DAFDF91B3D5}];4 ;OnStartRoutingFieldNo;Attribute;Field ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::On Start Routing Field No. }

    { [{8F955666-6BCB-4ECD-85DB-BE6E2BEAA1D7}];4 ;OnStartReleaseRecord;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::On Start Release Record }

    { [{6FDADCF5-3C8A-4738-AA01-CFD8114442B4}];4 ;OnStartInfoTextFieldType;Attribute;Field;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::On Start InfoText Field Type }

    { [{AD057009-F01C-4FE7-BEFE-198A53A19B52}];4 ;OnStartInfoTextFieldNo;Attribute;Field;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::On Start InfoText Field No. }

    { [{D9365DE9-1611-482D-ADE0-74F79D4C71B0}];4 ;OnStartPersonFieldType;Attribute;Field;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::On Start Person Field Type }

    { [{AE3E19B6-72A3-4499-99B7-EE57BE46EC8B}];4 ;OnStartPersonFieldNo;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::On Start Person Field No. }

    { [{865C9FF8-533C-47CA-AFCB-5DAC611A4DA6}];4 ;OnStartInfoTextConcatDef;Attribute;Field;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::On Start InfoText Concat Def. }

    { [{CE8AA33A-45D5-4488-AA7C-0BB605E641FF}];4 ;InsertLogicCodeunitID;Attribute;Field ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Insert Logic Codeunit ID }

    { [{5D049323-808A-4D2D-99CF-17C6AC774A45}];4 ;RespLogicCodeunitID ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Resp. Logic Codeunit ID }

    { [{EC82CFFF-5EDB-4664-82ED-E5D5E7CC9BB6}];4 ;PageID              ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Page ID }

    { [{C21E2F50-6C4B-4D5B-8257-8257E71FD911}];4 ;InsertFunctionCode  ;Attribute;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Insert Function Code }

    { [{D8117C68-92D0-4805-B7BE-BC87E5D03296}];4 ;ResponseFunctionCode;Attribute;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Response Function Code }

    { [{7B968095-3E26-4ADC-BED3-E7ED0C8FF19B}];4 ;AllowOverrideNextWFlow;Attribute;Field;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Allow Override Next WFlow }

    { [{CC664FEA-EA17-43FA-B880-E125B74E19A1}];4 ;CloseifSeqAnswerisNeg;Attribute;Field ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Close if Seq. Answer is Neg. }

    { [{3DF0C4AE-AEC7-478D-BE0A-085085F3842A}];4 ;GroupDecisionMethod ;Attribute;Field  ;
                                                  DataType=Code;
                                                  SourceField=dEnhancedWorkflow::Group Decision Method }

    { [{729C3E19-19A3-4DD2-BB33-A4AD4866623E}];4 ;MinResponsesRequired;Attribute;Field  ;
                                                  DataType=Integer;
                                                  SourceField=dEnhancedWorkflow::Min. Responses Required }

    { [{128AA84E-988D-4406-8AC9-D15D278086D2}];4 ;AllResponsesRequired;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::All Responses Required }

    { [{6C183145-B3E2-4CA5-A16C-8CB490829621}];4 ;EmailRecordLinksasAttach;Attribute;Field;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Email Record Links as Attach. }

    { [{745E73CE-B531-4A74-817F-69B06233B81C}];4 ;WorkflowGrouping1   ;Attribute;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Workflow Grouping 1 }

    { [{077E3F5E-B3B5-490D-90D4-EEBC144F4D75}];4 ;WorkflowGrouping    ;Attribute;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Workflow Grouping 2 }

    { [{4D75CA16-F342-4360-B00F-9E8B6BE701E7}];4 ;SplitDecisionContactNo;Attribute;Field;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Split Decision Contact No. }

    { [{14B27E1E-C708-4400-A096-AAB13DF830BA}];4 ;IsHoldWorkflow      ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Is Hold Workflow }

    { [{5DD5E0F3-EB24-474F-A2C1-969AEBA38159}];4 ;EstDuration         ;Attribute;Field  ;
                                                  DataType=Duration;
                                                  SourceField=dEnhancedWorkflow::Est. Duration }

    { [{7FAE5A66-C7E2-4F83-9F8D-09B9AD086E0A}];4 ;AutoResponse        ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Auto Response }

    { [{B5E5AAB5-0ABD-42B8-AE0C-9D520DA4B393}];4 ;JetReportID         ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Jet Report ID }

    { [{A567774D-0F9B-449D-A3B8-7C60CC1BD7E5}];4 ;JetReportParameter1 ;Attribute;Field  ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Jet Report Parameter 1 }

    { [{E85ED3BE-2276-460B-84D0-25DD51140A51}];4 ;JetReportParameter2 ;Attribute;Field  ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Jet Report Parameter 2 }

    { [{02CE267B-97EB-4B75-AA84-6B3FB1BABA5A}];4 ;JetReportParameter3 ;Attribute;Field  ;
                                                  DataType=Text;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Jet Report Parameter 3 }

    { [{BBCC91B2-FA73-4844-BCD3-74FFBE79F897}];4 ;ReportID            ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::Report ID }

    { [{5CC3DDAA-503E-4CB8-B4D2-D9B2E72AB709}];4 ;DOCSEntryIDtoSend   ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  SourceField=dEnhancedWorkflow::DOCS Entry ID to Send }

    { [{A84DB198-D325-4E6F-904E-58FE7E264B92}];4 ;SendFAttachmentswithNot;Attribute;Field;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Send FAttachments with Not. }

    { [{06470F48-849A-4381-8BB3-4C2B6A3C62D5}];4 ;FAttachmentTypeFilter;Attribute;Field ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::FAttachment Type Filter }

    { [{0C0EDFA0-806A-4476-A2D1-52ADBDE04A7C}];4 ;NotificationOnly    ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflow::Notification Only }

    { [{0CA3E9AB-9BB1-4D05-9BC8-460EE241C163}];4 ;OnErrWFlowDisabled  ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::OnErr: WFlow Disabled }

    { [{B4F6111A-C8DD-4540-B230-52D63DC9C870}];4 ;OnErrWFlowDisabledResp;Attribute;Field;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::OnErr: WFlow Disabled Resp. }

    { [{448E8985-33DA-47D1-9C25-D7401E90A991}];4 ;OnErrWFlowDisabledErrMsg;Attribute;Field;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::OnErr: WFlow Disabled Err. Msg }

    { [{A1313308-1A48-45F8-9526-CA485EE929C5}];4 ;OnErrNoRecipients   ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::OnErr: No Recipients }

    { [{C9C3FBBF-CE79-41A7-A8D8-23A6695F275C}];4 ;OnErrNoRecipientsResp;Attribute;Field ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflow::OnErr: No Recipients Resp. }

    { [{E80166DA-5815-46F5-87FE-9B7702CFC858}];4 ;OnErrNoRecipientsErrMsg;Attribute;Field;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflow::OnErr: No Recipients Err. Msg }

    { [{9CB27094-9257-4033-8267-12A0F75EA84F}];4 ;OriginatorisRecipientAction;Attribute;Field;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflow::Originator is Recipient Action }

    { [{1DE3337E-BB9C-4D5A-BD96-E8FB294174D4}];4 ;Attachment          ;Element ;Text    ;
                                                  VariableName=dEnhancedWorkflowAttachment;
                                                  TextType=BigText;
                                                  DataType=Text }

    { [{C150CEE0-0278-4B88-9864-C02BB98FE573}];4 ;EmailHTMLTemplate   ;Element ;Text    ;
                                                  VariableName=dEnhancedWorkflowEmailHTMLTmpl;
                                                  TextType=BigText;
                                                  DataType=Text }

    { [{BDD7A99F-F6CE-44A6-973B-EB2093805852}];4 ;WorkflowResponses   ;Element ;Text    ;
                                                  VariableName=dEnhancedWorkflowResponses;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{AC437CD3-8121-4B1B-B578-8369F871B27F}];5 ;WorkflowResponse    ;Element ;Table   ;
                                                  VariableName=dEnhancedWorkflowResponse;
                                                  SourceTable=Table9062259;
                                                  SourceTableView=SORTING(Field1,Field5);
                                                  LinkFields=Field1=FIELD(Field1);
                                                  LinkTable=dEnhancedWorkflow;
                                                  AutoUpdate=Yes;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 WorkflowResponseBeforeImport();
                                                                               END;

                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 WorkflowResponseBeforeImport();
                                                                               END;
                                                                                }

    { [{C3535D1D-B577-4BC8-80A3-3514632B1E49}];6 ;AutoResponse        ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflowResponse::Auto Response }

    { [{4884598E-4FB0-4C19-9C6A-08F4D499CAAD}];6 ;CancelledResponse   ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflowResponse::Cancelled Response }

    { [{95650871-FB81-4D86-9693-765C9998599C}];6 ;Code                ;Attribute;Field  ;
                                                  DataType=Code;
                                                  SourceField=dEnhancedWorkflowResponse::Code }

    { [{1811B84E-9E52-423B-A4A6-C766709ED741}];6 ;ResponseDescription ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflowResponse::Response Description }

    { [{CE9C61B1-B695-4B92-8156-2C9D6A9693D3}];6 ;NextWorkflowNo      ;Attribute;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowResponse::Next Workflow No. }

    { [{055E264A-0A9D-4F7C-94D0-7096021E3BC3}];6 ;ResponseWorkflowNo  ;Attribute;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowResponse::Response Workflow No. }

    { [{653C7B38-3711-4DE1-81E1-96A80F475B91}];6 ;TableID             ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowResponse::Table ID }

    { [{F61508CD-4367-4E43-83DA-ADE535DFC11C}];6 ;FieldType           ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflowResponse::Field Type }

    { [{3B61A7F8-9E11-431A-AFC9-7711CDB96667}];6 ;FieldID             ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowResponse::Field ID }

    { [{28AB1F5B-6563-4079-B41D-298B34B821F4}];6 ;FieldValue          ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflowResponse::Field Value }

    { [{2CF9E83E-71CB-4E52-B2D9-185B25687E56}];6 ;UpdateFieldwith     ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflowResponse::Update Field with }

    { [{12CD8A59-41F5-44B6-AD44-42BAD3AA961A}];6 ;ResponseType        ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflowResponse::Response Type }

    { [{48EA9710-DF68-4F8B-961A-02254D396520}];6 ;RespOptionTableID   ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowResponse::Resp. Option Table ID }

    { [{1C203312-5ED4-4D6A-AF38-6B22326A417E}];6 ;RespOptionValueFieldID;Attribute;Field;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowResponse::Resp. Option Value Field ID }

    { [{84D43D79-FCB5-4496-92B1-28265C777808}];6 ;RespOptionDescFieldID;Attribute;Field ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowResponse::Resp. Option Desc. Field ID }

    { [{BF62B405-3033-42BB-9F0B-B6573E7092A2}];6 ;RespOptionValueType ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflowResponse::Resp. Option Value Type }

    { [{DFA6B7EF-D07F-4187-AA96-4F18759B937F}];6 ;UseFieldType        ;Attribute;Field  ;
                                                  DataType=Option;
                                                  SourceField=dEnhancedWorkflowResponse::Use Field Type }

    { [{06D373FF-39BD-49D9-887C-B565D2BC5D54}];6 ;UseFieldID          ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowResponse::Use Field ID }

    { [{A2331BB5-E6E7-4B2E-8147-2CECC158E120}];6 ;EnhancedWorkflowRespOptions;Element;Text;
                                                  VariableName=dEnhancedWorkflowResponseOpt;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{14897948-AA1F-49C1-B6FD-3B495C16D2C0}];7 ;EnhancedWorkflowRespOption;Element;Table;
                                                  VariableName=dEnhancedWorkflowRespOption;
                                                  SourceTable=Table9062260;
                                                  SourceTableView=SORTING(Field1,Field2,Field3);
                                                  LinkFields=Field1=FIELD(Field1),
                                                             Field2=FIELD(Field5);
                                                  LinkTable=dEnhancedWorkflowResponse;
                                                  AutoUpdate=Yes;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 WorkflowResponseOptionBeforeImport();
                                                                               END;

                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 WorkflowResponseOptionBeforeImport();
                                                                               END;
                                                                                }

    { [{03515596-CD8E-4357-90A4-FA0F4F7D4614}];8 ;ResponseCode        ;Attribute;Field  ;
                                                  DataType=Code;
                                                  SourceField=dEnhancedWorkflowRespOption::Response Code }

    { [{3A325CA2-084D-41DC-9954-49A954BD8A31}];8 ;Value               ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflowRespOption::Value }

    { [{51FBD796-99BD-4E46-918D-F10E5C6E7EC2}];8 ;Description         ;Attribute;Field  ;
                                                  DataType=Text;
                                                  SourceField=dEnhancedWorkflowRespOption::Description }

    { [{B2F799D7-F969-4126-A519-CCF2F1809989}];4 ;EnhancedWorkflowContacts;Element;Text ;
                                                  VariableName=dEnhancedWorkflowContacts;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{6A10F6A6-3C64-490D-86ED-0E6E9B4CB773}];5 ;EnhancedWorkflowContact;Element;Table ;
                                                  VariableName=dEnhancedWorkflowContact;
                                                  SourceTable=Table9062264;
                                                  SourceTableView=SORTING(Field10,Field12);
                                                  LinkFields=Field10=FIELD(Field1);
                                                  LinkTable=dEnhancedWorkflow;
                                                  AutoUpdate=Yes;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 WorkflowContactBeforeImport();
                                                                               END;

                                                  Export::OnPreXMLItem=BEGIN
                                                                         IF (DontMigrateContacts) THEN
                                                                           currXMLport.BREAK();
                                                                       END;

                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 WorkflowContactBeforeImport();
                                                                               END;
                                                                                }

    { [{EC348A67-8BF2-4AC6-B755-DBBC12C58273}];6 ;LineNo              ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  SourceField=dEnhancedWorkflowContact::Line No. }

    { [{61DD8753-EE64-4B64-A725-B42B3C911308}];6 ;ContactNo           ;Attribute;Field  ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=dEnhancedWorkflowContact::Contact No. }

    { [{8B2A077A-1C3A-49A1-87FE-E7A760D08F4E}];6 ;WorkflowAmountEqualorAbove;Attribute;Field;
                                                  DataType=Decimal;
                                                  SourceField=dEnhancedWorkflowContact::Workflow Amount Equal or Above }

    { [{E5D2C18E-214E-4833-A30D-DEE72E8111D1}];6 ;MandatoryToAccept   ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflowContact::Mandatory To Accept }

    { [{3A71C7A7-474F-40D6-B494-688FB9D96DCB}];6 ;ParameterCode       ;Attribute;Field  ;
                                                  DataType=Code;
                                                  SourceField=dEnhancedWorkflowContact::Parameter Code }

    { [{C2352AE2-11BC-4DBD-87DE-8D58017A6A42}];6 ;Sequence            ;Attribute;Field  ;
                                                  DataType=Integer;
                                                  SourceField=dEnhancedWorkflowContact::Sequence }

    { [{B028B6D6-7EE7-4849-9586-6E1455215BDD}];6 ;WorkflowAmountFrom  ;Attribute;Field  ;
                                                  DataType=Decimal;
                                                  SourceField=dEnhancedWorkflowContact::Workflow Amount From }

    { [{9A73F3E2-919B-41C4-A731-1776210D7139}];6 ;WorkflowAmountTo    ;Attribute;Field  ;
                                                  DataType=Decimal;
                                                  SourceField=dEnhancedWorkflowContact::Workflow Amount To }

    { [{FAC7D749-3B52-4656-B774-26427978C7C4}];6 ;RoutingParameter    ;Attribute;Field  ;
                                                  DataType=Code;
                                                  SourceField=dEnhancedWorkflowContact::Routing Parameter }

    { [{6541ECCD-F8E4-445F-9ED0-3706ACFEBB26}];6 ;UseWorkflowAmountFrom;Attribute;Field ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflowContact::Use Workflow Amount From }

    { [{58C73132-E2F8-45B3-8080-9E6B1009AACA}];6 ;UseWorkflowAmountTo ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflowContact::Use Workflow Amount To }

    { [{6E58A88F-B9AC-4DF8-858C-33F2C37CE196}];6 ;CC                  ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflowContact::CC }

    { [{B0008488-9C92-4D4E-8139-2051BB5BCAD8}];6 ;EmailNotification   ;Attribute;Field  ;
                                                  DataType=Boolean;
                                                  SourceField=dEnhancedWorkflowContact::E-mail Notification }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   currXMLport.IMPORTFILE(MigrationToolkit.UpdateParameters(Direction, ErrorLevel, ErrorLevelEnabled));
                 END;

    }
    CONTROLS
    {
      { 1000001000;;Container;
                  Name=ContentAreaContainer;
                  CaptionML=[ENU=Content Area;
                             ENG=Content Area];
                  ContainerType=ContentArea }

      { 1000001001;1;Group  ;
                  Name=OptionsGroup;
                  CaptionML=[ENU=Options;
                             ENG=Options];
                  GroupType=Group }

      { 1000001002;2;Field  ;
                  Name=Direction;
                  CaptionML=[ENU=Direction;
                             ENG=Direction];
                  SourceExpr=Direction;
                  OnValidate=BEGIN
                               currXMLport.IMPORTFILE(MigrationToolkit.UpdateParameters(Direction, ErrorLevel, ErrorLevelEnabled));
                               RequestOptionsPage.UPDATE(FALSE);
                             END;
                              }

      { 1000001003;2;Field  ;
                  Name=ErrorLevelField;
                  CaptionML=[ENU=Error Level;
                             ENG=Error Level];
                  SourceExpr=ErrorLevel;
                  Enabled=ErrorLevelEnabled }

      { 1000000000;2;Field  ;
                  Name=DontMigrateContactsField;
                  CaptionML=ENU=Don't Migrate Contacts;
                  SourceExpr=DontMigrateContacts }

    }
  }
  CODE
  {
    VAR
      Blob@1000000011 : Record 99008535;
      BlobToolkit@1000000010 : Codeunit 9062242;
      MigrationToolkit@1000000003 : Codeunit 9062484;
      XmlPortId@1000000008 : Integer;
      XmlPortVersion@1000000007 : Text;
      Direction@1000000006 : ' ,Export,Import';
      ErrorLevel@1000000005 : ' ,Errors,Confirmations,Warnings,Nothing';
      ErrorLevelEnabled@1000000004 : Boolean INDATASET;
      DontMigrateContacts@1000000000 : Boolean;
      AllObj@9062229 : Record 2000000038;

    LOCAL PROCEDURE WorkflowBeforeExport@1000000002();
    BEGIN
      dEnhancedWorkflow.CALCFIELDS(Attachment);
      Blob.Blob := dEnhancedWorkflow.Attachment;
      BlobToolkit.ToBase64BigText(Blob, dEnhancedWorkflowAttachment);
      dEnhancedWorkflow.CALCFIELDS("Email HTML Template");
      Blob.Blob := dEnhancedWorkflow."Email HTML Template";
      BlobToolkit.ToBase64BigText(Blob, dEnhancedWorkflowEmailHTMLTmpl);
    END;

    LOCAL PROCEDURE WorkflowInitImport@1000000001();
    BEGIN
      CLEAR(dEnhancedWorkflowAttachment);
      CLEAR(dEnhancedWorkflowEmailHTMLTmpl);
    END;

    LOCAL PROCEDURE WorkflowBeforeImport@9062229();
    VAR
      lJetReportParameter@9062231 : Record 9062297;
      lWorkflowFunction@9062230 : Record 9062262;
    BEGIN
      MigrationToolkit.SetRecord(DATABASE::"Enhanced Workflow", dEnhancedWorkflow);
      MigrationToolkit.CheckRelation_Code(DATABASE::"No. Series", dEnhancedWorkflow."No. Series", TRUE);
      MigrationToolkit.CheckCodeunitRelation(dEnhancedWorkflow."Insert Logic Codeunit ID");
      MigrationToolkit.CheckCodeunitRelation(dEnhancedWorkflow."Resp. Logic Codeunit ID");
      MigrationToolkit.CheckPageRelation(dEnhancedWorkflow."Page ID");
      MigrationToolkit.CheckTableRelation(dEnhancedWorkflow."Table ID");
      MigrationToolkit.CheckRelation_ConstCode(DATABASE::"Enhanced Workflow Function", lWorkflowFunction.Type::Insert, dEnhancedWorkflow."Insert Function Code", FALSE);
      MigrationToolkit.CheckRelation_ConstCode(DATABASE::"Enhanced Workflow Function", lWorkflowFunction.Type::Response, dEnhancedWorkflow."Response Function Code", FALSE);
      MigrationToolkit.CheckRelation_ConstCode(DATABASE::"General Lookup", 'DECISIONMETHOD', dEnhancedWorkflow."Group Decision Method", FALSE);
      MigrationToolkit.CheckRelation_ConstCode(DATABASE::"General Lookup", 'WFLOWGROUP1', dEnhancedWorkflow."Workflow Grouping 1", FALSE);
      MigrationToolkit.CheckRelation_ConstCode(DATABASE::"General Lookup", 'WFLOWGROUP2', dEnhancedWorkflow."Workflow Grouping 2", FALSE);
      MigrationToolkit.CheckRelation_Code(DATABASE::Contact, dEnhancedWorkflow."Split Decision Contact No.", FALSE);
      MigrationToolkit.CheckRelation_Int(DATABASE::"Jet Report Header", dEnhancedWorkflow."Jet Report ID", FALSE);
      MigrationToolkit.CheckRelation_ConstText(DATABASE::"Jet Report Parameter", dEnhancedWorkflow."Jet Report ID", dEnhancedWorkflow."Jet Report Parameter 1", FALSE);
      MigrationToolkit.CheckRelation_ConstText(DATABASE::"Jet Report Parameter", dEnhancedWorkflow."Jet Report ID", dEnhancedWorkflow."Jet Report Parameter 2", FALSE);
      MigrationToolkit.CheckRelation_ConstText(DATABASE::"Jet Report Parameter", dEnhancedWorkflow."Jet Report ID", dEnhancedWorkflow."Jet Report Parameter 3", FALSE);
      MigrationToolkit.CheckReportRelation(dEnhancedWorkflow."Report ID");
      MigrationToolkit.CheckRelation_Int(DATABASE::"Document Library", dEnhancedWorkflow."DOCS Entry ID to Send", FALSE);

      BlobToolkit.FromBase64BigText(dEnhancedWorkflowAttachment, Blob);
      dEnhancedWorkflow.Attachment := Blob.Blob;
      BlobToolkit.FromBase64BigText(dEnhancedWorkflowEmailHTMLTmpl, Blob);
      dEnhancedWorkflow."Email HTML Template" := Blob.Blob;
    END;

    LOCAL PROCEDURE WorkflowResponseBeforeImport@9062230();
    VAR
      EnhancedWorkflow@9062230 : Record 9062258;
    BEGIN
      //DOC NA2016.11+
      IF EnhancedWorkflow.GET(dEnhancedWorkflowResponse."Workflow No.") THEN
        IF (EnhancedWorkflow."Checklist Type" <> '') THEN
          currXMLport.SKIP();
      //DOC NA2016.11-
      MigrationToolkit.SetRecord(DATABASE::"Enhanced Workflow Response", dEnhancedWorkflowResponse);
      MigrationToolkit.CheckTableRelation(dEnhancedWorkflowResponse."Table ID");
      MigrationToolkit.CheckFieldRelation(dEnhancedWorkflowResponse."Table ID", dEnhancedWorkflowResponse."Field ID");
      MigrationToolkit.CheckTableRelation(dEnhancedWorkflowResponse."Resp. Option Table ID");
      MigrationToolkit.CheckFieldRelation(dEnhancedWorkflowResponse."Resp. Option Table ID", dEnhancedWorkflowResponse."Resp. Option Value Field ID");
      MigrationToolkit.CheckFieldRelation(dEnhancedWorkflowResponse."Resp. Option Table ID", dEnhancedWorkflowResponse."Resp. Option Desc. Field ID");
      MigrationToolkit.CheckFieldRelation(dEnhancedWorkflowResponse."Table ID", dEnhancedWorkflowResponse."Use Field ID");
    END;

    LOCAL PROCEDURE WorkflowResponseOptionBeforeImport@9062231();
    BEGIN
    END;

    LOCAL PROCEDURE WorkflowContactBeforeImport@9062232();
    BEGIN
      IF (DontMigrateContacts) THEN
        currXMLport.SKIP();
      MigrationToolkit.SetRecord(DATABASE::"Enhanced Workflow Contact", dEnhancedWorkflowContact);
      MigrationToolkit.CheckRelation_Code(DATABASE::Contact, dEnhancedWorkflowContact."Contact No.", FALSE);
      IF (dEnhancedWorkflowContact."Contact No." = '') THEN
        currXMLport.SKIP();
    END;

    BEGIN
    {
      //DOC NA2015.5  JH 26/02/2015 - Created
      //DOC NA2015.8  JH 27/07/2015 - Fixes
      //DOC NA2016.10 JH 28/08/2015 - Upgraded to 2016
      //DOC NA2016.10 AZ 11/09/2015 - Relations errors handling
      //DOC NA2016.11 AP 05/11/2015 - Skip importing the responses if the record has a checklist as they will be automatically created
      //DOC NA2016.14 JH 17/02/2016 - BLOB migration fixes
    }
    END.
  }
}

