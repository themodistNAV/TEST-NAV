OBJECT Table 5940 Service Item
{
  OBJECT-PROPERTIES
  {
    Date=26/02/16;
    Time=12:00:00 PM;
    Version List=NAVW19.00.00.45243;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Description;
    OnInsert=BEGIN
               ServMgtSetup.GET ;
               IF "No." = '' THEN BEGIN
                 ServMgtSetup.TESTFIELD("Service Item Nos.");
                 NoSeriesMgt.InitSeries(ServMgtSetup."Service Item Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               "Response Time (Hours)" := ServMgtSetup."Default Response Time (Hours)";

               ServLogMgt.ServItemCreated(Rec);
             END;

    OnDelete=VAR
               ResultDescription@1000 : Text;
             BEGIN
               MoveEntries.MoveServiceItemLedgerEntries(Rec);

               ResultDescription := CheckIfCanBeDeleted;
               IF ResultDescription <> '' THEN
                 ERROR(ResultDescription);

               DeleteServItemComponents;

               ServCommentLine.RESET;
               ServCommentLine.SETRANGE("Table Name",ServCommentLine."Table Name"::"Service Item");
               ServCommentLine.SETRANGE("Table Subtype",0);
               ServCommentLine.SETRANGE("No.","No.");
               ServCommentLine.DELETEALL;

               ResSkillMgt.DeleteServItemResSkills("No.");
               ServLogMgt.ServItemDeleted("No.");

               DimMgt.DeleteDefaultDim(DATABASE::"Service Item","No.");
             END;

    OnRename=BEGIN
               IF "No." <> xRec."No." THEN BEGIN
                 ServLogMgt.ServItemNoChange(Rec,xRec);
                 ServContractLine.RESET;
                 ServContractLine.SETCURRENTKEY("Service Item No.","Contract Status");
                 ServContractLine.SETRANGE("Service Item No.",xRec."No.");
                 ServContractLine.SETRANGE("Contract Type",ServContractLine."Contract Type"::Contract);
                 IF ServContractLine.FIND('-') THEN
                   REPEAT
                     ContractChangeLog.LogContractChange(
                       ServContractLine."Contract No.",1,
                       ServContractLine.FIELDCAPTION("Service Item No."),3,
                       xRec."No.","No.","No.",0);
                   UNTIL ServContractLine.NEXT = 0;
               END;
             END;

    CaptionML=[ENU=Service Item;
               ENG=Service Item];
    LookupPageID=Page5981;
    DrillDownPageID=Page5981;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Description;
                                                   OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  ServMgtSetup.GET;
                                                                  NoSeriesMgt.TestManual(ServMgtSetup."Service Item Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              ENG=No.] }
    { 2   ;   ;Serial No.          ;Code20        ;OnValidate=BEGIN
                                                                IF "Serial No." <> xRec."Serial No." THEN
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Serial No."));

                                                                IF "Serial No." <> '' THEN BEGIN
                                                                  ServItem.RESET;
                                                                  ServItem.SETCURRENTKEY("Item No.","Serial No.");
                                                                  ServItem.SETRANGE("Item No.","Item No.");
                                                                  ServItem.SETRANGE("Serial No.","Serial No.");
                                                                  ServItem.SETFILTER("No.",'<>%1',"No.");
                                                                  IF ServItem.FINDFIRST THEN BEGIN
                                                                    IF "Item No." <> '' THEN
                                                                      ERROR(
                                                                        Text003,
                                                                        FIELDCAPTION("Serial No."),"Serial No.",TABLECAPTION,ServItem."No.");
                                                                    MESSAGE(
                                                                      Text003,
                                                                      FIELDCAPTION("Serial No."),"Serial No.",TABLECAPTION,ServItem."No.")
                                                                  END;
                                                                END;

                                                                IF "Serial No." <> xRec."Serial No." THEN
                                                                  ServLogMgt.ServItemSerialNoChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Serial No.;
                                                              ENG=Serial No.] }
    { 3   ;   ;Service Item Group Code;Code10     ;TableRelation="Service Item Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Service Item Group Code" = "Service Item Group Code" THEN BEGIN
                                                                  IF NOT CancelResSkillAssignment THEN
                                                                    ResSkillMgt.RevalidateRelation(
                                                                      ResSkill.Type::"Service Item",
                                                                      "No.",
                                                                      ResSkill.Type::"Service Item Group",
                                                                      "Service Item Group Code")
                                                                END ELSE BEGIN
                                                                  IF NOT CancelResSkillAssignment THEN BEGIN
                                                                    IF CancelResSkillChanges THEN
                                                                      ResSkillMgt.SkipValidationDialogs;

                                                                    IF NOT ResSkillMgt.ChangeRelationWithGroup(
                                                                         ResSkill.Type::"Service Item",
                                                                         "No.",
                                                                         ResSkill.Type::"Service Item Group",
                                                                         "Service Item Group Code",
                                                                         xRec."Service Item Group Code")
                                                                    THEN
                                                                      ERROR('');

                                                                    IF CancelResSkillChanges THEN BEGIN
                                                                      ResSkillMgt.DropGlobals;
                                                                      CancelResSkillChanges := FALSE;
                                                                    END ELSE
                                                                      CancelResSkillChanges := TRUE;
                                                                  END;

                                                                  IF "Service Item Group Code" <> '' THEN BEGIN
                                                                    ServItemGr.GET("Service Item Group Code");
                                                                    "Default Contract Discount %" := ServItemGr."Default Contract Discount %";
                                                                    IF "Service Price Group Code" = '' THEN
                                                                      "Service Price Group Code" := ServItemGr."Default Serv. Price Group Code";
                                                                    IF (xRec."Service Item Group Code" <> "Service Item Group Code") AND
                                                                       (ServItemGr."Default Response Time (Hours)" <> 0)
                                                                    THEN
                                                                      "Response Time (Hours)" := ServItemGr."Default Response Time (Hours)";
                                                                  END;
                                                                END;
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Service Item Group Code;
                                                              ENG=Service Item Group Code] }
    { 4   ;   ;Description         ;Text50        ;OnValidate=BEGIN
                                                                IF ("Search Description" = UPPERCASE(xRec.Description)) OR ("Search Description" = '') THEN
                                                                  "Search Description" := Description;
                                                              END;

                                                   CaptionML=[ENU=Description;
                                                              ENG=Description] }
    { 5   ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              ENG=Description 2] }
    { 6   ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                IF Status <> xRec.Status THEN BEGIN
                                                                  IF (Status = Status::Installed) AND ("Installation Date" = 0D) THEN
                                                                    "Installation Date" := WORKDATE;
                                                                  ServLogMgt.ServItemStatusChange(Rec,xRec);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              ENG=Status];
                                                   OptionCaptionML=[ENU=" ,Own Service Item,Installed,Temporarily Installed,Defective";
                                                                    ENG=" ,Own Service Item,Installed,Temporarily Installed,Defective"];
                                                   OptionString=[ ,Own Service Item,Installed,Temporarily Installed,Defective] }
    { 7   ;   ;Priority            ;Option        ;CaptionML=[ENU=Priority;
                                                              ENG=Priority];
                                                   OptionCaptionML=[ENU=Low,Medium,High;
                                                                    ENG=Low,Medium,High];
                                                   OptionString=Low,Medium,High }
    { 8   ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF "Customer No." <> xRec."Customer No." THEN BEGIN
                                                                  IF CheckifActiveServContLineExist THEN
                                                                    ERROR(
                                                                      Text004,
                                                                      FIELDCAPTION("Customer No."),"Customer No.",TABLECAPTION,"No.");
                                                                  ErrMessageIfServItemLinesExist(FIELDCAPTION("Customer No."));
                                                                  IF ServLedgEntryExist THEN
                                                                    IF NOT CONFIRM(
                                                                         Text017,
                                                                         FALSE,TABLECAPTION,FIELDCAPTION("Customer No."))
                                                                    THEN BEGIN
                                                                      "Customer No." := xRec."Customer No.";
                                                                      EXIT;
                                                                    END;
                                                                  "Ship-to Code" := '';
                                                                  IF ("Customer No." <> '') AND
                                                                     (xRec."Customer No." = '')
                                                                  THEN
                                                                    Status := Status::Installed;
                                                                  ServLogMgt.ServItemCustChange(Rec,xRec);
                                                                  ServLogMgt.ServItemShipToCodeChange(Rec,xRec);
                                                                END;
                                                              END;

                                                   ValidateTableRelation=Yes;
                                                   CaptionML=[ENU=Customer No.;
                                                              ENG=Customer No.] }
    { 9   ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   OnValidate=BEGIN
                                                                IF "Ship-to Code" <> xRec."Ship-to Code" THEN BEGIN
                                                                  IF CheckifActiveServContLineExist THEN
                                                                    ERROR(
                                                                      Text004,
                                                                      FIELDCAPTION("Ship-to Code"),"Ship-to Code",TABLECAPTION,"No.");
                                                                  ErrMessageIfServItemLinesExist(FIELDCAPTION("Ship-to Code"));
                                                                  IF ServLedgEntryExist THEN
                                                                    IF NOT CONFIRM(
                                                                         Text017,
                                                                         FALSE,TABLECAPTION,FIELDCAPTION("Customer No."))
                                                                    THEN BEGIN
                                                                      "Ship-to Code" := xRec."Ship-to Code";
                                                                      EXIT;
                                                                    END;
                                                                  ServLogMgt.ServItemShipToCodeChange(Rec,xRec);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              ENG=Ship-to Code] }
    { 10  ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   OnValidate=BEGIN
                                                                IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                  IF "Item No." <> '' THEN BEGIN
                                                                    CALCFIELDS("Service Item Components");
                                                                    IF "Service Item Components" THEN
                                                                      IF NOT CONFIRM(
                                                                           Text005 +
                                                                           Text006,FALSE,
                                                                           FIELDCAPTION("Item No."),FIELDCAPTION("Service Item Components"))
                                                                      THEN BEGIN
                                                                        "Item No." := xRec."Item No.";
                                                                        EXIT;
                                                                      END;
                                                                  END;
                                                                  IF NOT CancelResSkillAssignment THEN BEGIN
                                                                    IF CancelResSkillChanges THEN
                                                                      ResSkillMgt.SkipValidationDialogs;
                                                                    IF NOT ResSkillMgt.ChangeRelationWithItem(
                                                                         ResSkill.Type::"Service Item",
                                                                         "No.",
                                                                         ResSkill.Type::Item,
                                                                         "Item No.",
                                                                         xRec."Item No.",
                                                                         xRec."Service Item Group Code")
                                                                    THEN
                                                                      ERROR('');
                                                                    IF CancelResSkillChanges THEN BEGIN
                                                                      ResSkillMgt.DropGlobals;
                                                                      CancelResSkillChanges := FALSE;
                                                                    END ELSE
                                                                      CancelResSkillChanges := TRUE;
                                                                  END;
                                                                  IF "Item No." <> '' THEN BEGIN
                                                                    Item.GET("Item No.");
                                                                    VALIDATE("Service Item Group Code",Item."Service Item Group");
                                                                    VALIDATE("Serial No.");
                                                                    VALIDATE("Sales Unit Cost",Item."Unit Cost");
                                                                    VALIDATE("Sales Unit Price",Item."Unit Price");
                                                                    "Variant Code" := '';
                                                                    "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                    IF Description = '' THEN
                                                                      VALIDATE(Description,Item.Description);
                                                                    IF "Service Item Components" THEN BEGIN
                                                                      DeleteServItemComponents;
                                                                      CALCFIELDS("Service Item Components");
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Serial No." := '';
                                                                    VALIDATE("Sales Unit Price",0);
                                                                    VALIDATE("Sales Unit Cost",0);
                                                                    "Variant Code" := '';
                                                                    "Service Item Group Code" := '';
                                                                    "Unit of Measure Code" := '';
                                                                  END;
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Item No."));
                                                                END ELSE
                                                                  IF NOT CancelResSkillAssignment THEN
                                                                    ResSkillMgt.RevalidateRelation(
                                                                      ResSkill.Type::"Service Item",
                                                                      "No.",
                                                                      ResSkill.Type::Item,
                                                                      "Item No.");

                                                                ServLogMgt.ServItemItemNoChange(Rec,xRec);
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              ENG=Item No.] }
    { 11  ;   ;Unit of Measure Code;Code10        ;TableRelation=IF (Item No.=FILTER(<>'')) "Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.))
                                                                 ELSE "Unit of Measure";
                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              ENG=Unit of Measure Code] }
    { 12  ;   ;Location of Service Item;Text30    ;CaptionML=[ENU=Location of Service Item;
                                                              ENG=Location of Service Item] }
    { 13  ;   ;Sales Unit Price    ;Decimal       ;OnValidate=BEGIN
                                                                ServMgtSetup.GET;
                                                                Currency.InitRoundingPrecision;
                                                                IF (ServMgtSetup."Contract Value Calc. Method" =
                                                                    ServMgtSetup."Contract Value Calc. Method"::"Based on Unit Price") AND
                                                                   ("Sales Unit Price" <> xRec."Sales Unit Price")
                                                                THEN
                                                                  "Default Contract Value" :=
                                                                    ROUND("Sales Unit Price" * ServMgtSetup."Contract Value %" / 100,
                                                                      Currency."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Sales Unit Price;
                                                              ENG=Sales Unit Price];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 14  ;   ;Sales Unit Cost     ;Decimal       ;OnValidate=BEGIN
                                                                ServMgtSetup.GET;
                                                                Currency.InitRoundingPrecision;
                                                                "Default Contract Cost" :=
                                                                  ROUND("Sales Unit Cost" * ServMgtSetup."Contract Value %" / 100,
                                                                    Currency."Unit-Amount Rounding Precision");
                                                                IF (ServMgtSetup."Contract Value Calc. Method" =
                                                                    ServMgtSetup."Contract Value Calc. Method"::"Based on Unit Cost") AND
                                                                   ("Sales Unit Cost" <> xRec."Sales Unit Cost")
                                                                THEN
                                                                  "Default Contract Value" := "Default Contract Cost";
                                                              END;

                                                   CaptionML=[ENU=Sales Unit Cost;
                                                              ENG=Sales Unit Cost];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 15  ;   ;Warranty Starting Date (Labor);Date;OnValidate=BEGIN
                                                                IF "Warranty Starting Date (Labor)" <> xRec."Warranty Starting Date (Labor)" THEN
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Warranty Starting Date (Labor)"));

                                                                ServMgtSetup.GET;
                                                                ServMgtSetup.TESTFIELD("Default Warranty Duration");
                                                                IF "Warranty Starting Date (Labor)" <> xRec."Warranty Starting Date (Labor)" THEN
                                                                  IF "Warranty Starting Date (Labor)" <> 0D THEN
                                                                    VALIDATE("Warranty Ending Date (Labor)",CALCDATE(ServMgtSetup."Default Warranty Duration","Warranty Starting Date (Labor)"))
                                                                  ELSE
                                                                    "Warranty Ending Date (Labor)" := 0D;

                                                                IF "Warranty Starting Date (Labor)" <> 0D THEN
                                                                  IF "Warranty Starting Date (Parts)" = 0D THEN
                                                                    VALIDATE("Warranty Starting Date (Parts)","Warranty Starting Date (Labor)");
                                                              END;

                                                   CaptionML=[ENU=Warranty Starting Date (Labor);
                                                              ENG=Warranty Starting Date (Labour)] }
    { 16  ;   ;Warranty Ending Date (Labor);Date  ;OnValidate=BEGIN
                                                                IF "Warranty Ending Date (Labor)" <> xRec."Warranty Ending Date (Labor)" THEN
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Warranty Ending Date (Labor)"));

                                                                IF "Warranty Ending Date (Labor)" < "Warranty Starting Date (Labor)" THEN
                                                                  ERROR(
                                                                    Text007,
                                                                    FIELDCAPTION("Warranty Starting Date (Labor)"),FIELDCAPTION("Warranty Ending Date (Labor)"));

                                                                ServMgtSetup.GET;
                                                                IF "Warranty % (Labor)" = 0 THEN
                                                                  "Warranty % (Labor)" := ServMgtSetup."Warranty Disc. % (Labor)";
                                                              END;

                                                   CaptionML=[ENU=Warranty Ending Date (Labor);
                                                              ENG=Warranty Ending Date (Labour)] }
    { 17  ;   ;Warranty Starting Date (Parts);Date;OnValidate=VAR
                                                                ItemTrackingCode@1000 : Record 6502;
                                                              BEGIN
                                                                IF "Warranty Starting Date (Parts)" <> xRec."Warranty Starting Date (Parts)" THEN
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Warranty Starting Date (Parts)"));

                                                                IF "Warranty Starting Date (Parts)" <> xRec."Warranty Starting Date (Parts)" THEN
                                                                  IF "Warranty Starting Date (Parts)" <> 0D THEN BEGIN
                                                                    IF Item.GET("Item No.") AND (Item."Item Tracking Code" <> '') AND
                                                                       ItemTrackingCode.GET(Item."Item Tracking Code") AND
                                                                       (FORMAT(ItemTrackingCode."Warranty Date Formula") <> '')
                                                                    THEN
                                                                      VALIDATE(
                                                                        "Warranty Ending Date (Parts)",
                                                                        CALCDATE(ItemTrackingCode."Warranty Date Formula",
                                                                          "Warranty Starting Date (Parts)"))
                                                                    ELSE BEGIN
                                                                      ServMgtSetup.GET;
                                                                      ServMgtSetup.TESTFIELD("Default Warranty Duration");
                                                                      VALIDATE(
                                                                        "Warranty Ending Date (Parts)",
                                                                        CALCDATE(ServMgtSetup."Default Warranty Duration",
                                                                          "Warranty Starting Date (Parts)"));
                                                                    END;
                                                                  END ELSE
                                                                    "Warranty Ending Date (Parts)" := 0D;

                                                                IF "Warranty Starting Date (Parts)" <> 0D THEN
                                                                  IF "Warranty Starting Date (Labor)" = 0D THEN
                                                                    VALIDATE("Warranty Starting Date (Labor)","Warranty Starting Date (Parts)");
                                                              END;

                                                   CaptionML=[ENU=Warranty Starting Date (Parts);
                                                              ENG=Warranty Starting Date (Parts)] }
    { 18  ;   ;Warranty Ending Date (Parts);Date  ;OnValidate=BEGIN
                                                                IF "Warranty Ending Date (Parts)" < "Warranty Starting Date (Parts)" THEN
                                                                  ERROR(
                                                                    Text007,
                                                                    FIELDCAPTION("Warranty Starting Date (Parts)"),FIELDCAPTION("Warranty Ending Date (Parts)"));

                                                                IF "Warranty Ending Date (Parts)" <> xRec."Warranty Ending Date (Parts)" THEN
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Warranty Ending Date (Parts)"));

                                                                ServMgtSetup.GET;
                                                                IF "Warranty % (Parts)" = 0 THEN
                                                                  "Warranty % (Parts)" := ServMgtSetup."Warranty Disc. % (Parts)";
                                                              END;

                                                   CaptionML=[ENU=Warranty Ending Date (Parts);
                                                              ENG=Warranty Ending Date (Parts)] }
    { 19  ;   ;Warranty % (Parts)  ;Decimal       ;OnValidate=BEGIN
                                                                IF "Warranty % (Parts)" <> xRec."Warranty % (Parts)" THEN
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Warranty % (Parts)"));
                                                              END;

                                                   CaptionML=[ENU=Warranty % (Parts);
                                                              ENG=Warranty % (Parts)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   BlankZero=Yes }
    { 20  ;   ;Warranty % (Labor)  ;Decimal       ;OnValidate=BEGIN
                                                                IF "Warranty % (Labor)" <> xRec."Warranty % (Labor)" THEN
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Warranty % (Labor)"));
                                                              END;

                                                   CaptionML=[ENU=Warranty % (Labor);
                                                              ENG=Warranty % (Labour)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   BlankZero=Yes }
    { 21  ;   ;Response Time (Hours);Decimal      ;CaptionML=[ENU=Response Time (Hours);
                                                              ENG=Response Time (Hours)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   BlankZero=Yes }
    { 22  ;   ;Installation Date   ;Date          ;CaptionML=[ENU=Installation Date;
                                                              ENG=Installation Date] }
    { 23  ;   ;Sales Date          ;Date          ;OnValidate=BEGIN
                                                                IF "Sales Date" > 0D THEN BEGIN
                                                                  IF "Warranty Starting Date (Parts)" = 0D THEN
                                                                    VALIDATE("Warranty Starting Date (Parts)","Sales Date");
                                                                  IF "Warranty Starting Date (Labor)" = 0D THEN
                                                                    VALIDATE("Warranty Starting Date (Labor)","Sales Date");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Sales Date;
                                                              ENG=Sales Date] }
    { 24  ;   ;Last Service Date   ;Date          ;CaptionML=[ENU=Last Service Date;
                                                              ENG=Last Service Date] }
    { 25  ;   ;Default Contract Value;Decimal     ;CaptionML=[ENU=Default Contract Value;
                                                              ENG=Default Contract Value];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 26  ;   ;Default Contract Discount %;Decimal;CaptionML=[ENU=Default Contract Discount %;
                                                              ENG=Default Contract Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   BlankZero=Yes }
    { 28  ;   ;No. of Active Contracts;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Contract Line" WHERE (Service Item No.=FIELD(No.),
                                                                                                    Contract Status=FILTER(<>Cancelled)));
                                                   CaptionML=[ENU=No. of Active Contracts;
                                                              ENG=No. of Active Contracts] }
    { 33  ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[ENU=Vendor No.;
                                                              ENG=Vendor No.] }
    { 34  ;   ;Vendor Item No.     ;Code20        ;CaptionML=[ENU=Vendor Item No.;
                                                              ENG=Vendor Item No.] }
    { 47  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              ENG=No. Series] }
    { 48  ;   ;Item Description    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Item.Description WHERE (No.=FIELD(Item No.)));
                                                   CaptionML=[ENU=Item Description;
                                                              ENG=Item Description];
                                                   Editable=No }
    { 49  ;   ;Name                ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Name;
                                                              ENG=Name];
                                                   Editable=No }
    { 50  ;   ;Address             ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Address WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Address;
                                                              ENG=Address];
                                                   Editable=No }
    { 51  ;   ;Address 2           ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Address 2" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Address 2;
                                                              ENG=Address 2];
                                                   Editable=No }
    { 52  ;   ;Post Code           ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Post Code" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Post Code;
                                                              ENG=Post Code];
                                                   Editable=No }
    { 53  ;   ;City                ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.City WHERE (No.=FIELD(Customer No.)));
                                                   TableRelation="Post Code".City;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              ENG=City];
                                                   Editable=No }
    { 54  ;   ;Contact             ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Contact WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Contact;
                                                              ENG=Contact];
                                                   Editable=No }
    { 55  ;   ;Phone No.           ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Phone No." WHERE (No.=FIELD(Customer No.)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              ENG=Phone No.];
                                                   Editable=No }
    { 56  ;   ;Ship-to Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address".Name WHERE (Customer No.=FIELD(Customer No.),
                                                                                                    Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to Name;
                                                              ENG=Ship-to Name];
                                                   Editable=No }
    { 57  ;   ;Ship-to Address     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address".Address WHERE (Customer No.=FIELD(Customer No.),
                                                                                                       Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to Address;
                                                              ENG=Ship-to Address];
                                                   Editable=No }
    { 58  ;   ;Ship-to Address 2   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address"."Address 2" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                           Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to Address 2;
                                                              ENG=Ship-to Address 2];
                                                   Editable=No }
    { 59  ;   ;Ship-to Post Code   ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address"."Post Code" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                           Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to Post Code;
                                                              ENG=Ship-to Post Code];
                                                   Editable=No }
    { 60  ;   ;Ship-to City        ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address".City WHERE (Customer No.=FIELD(Customer No.),
                                                                                                    Code=FIELD(Ship-to Code)));
                                                   TableRelation="Post Code".City;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              ENG=Ship-to City];
                                                   Editable=No }
    { 61  ;   ;Ship-to Contact     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address".Contact WHERE (Customer No.=FIELD(Customer No.),
                                                                                                       Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to Contact;
                                                              ENG=Ship-to Contact];
                                                   Editable=No }
    { 62  ;   ;Ship-to Phone No.   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address"."Phone No." WHERE (Customer No.=FIELD(Customer No.),
                                                                                                           Code=FIELD(Ship-to Code)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone No.;
                                                              ENG=Ship-to Phone No.];
                                                   Editable=No }
    { 63  ;   ;Usage (Cost)        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Ledger Entry"."Cost Amount" WHERE (Entry Type=CONST(Usage),
                                                                                                               Service Item No. (Serviced)=FIELD(No.),
                                                                                                               Service Contract No.=FIELD(Contract Filter),
                                                                                                               Service Order No.=FIELD(Service Order Filter),
                                                                                                               Type=FIELD(Type Filter),
                                                                                                               Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Usage (Cost);
                                                              ENG=Usage (Cost)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 64  ;   ;Usage (Amount)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Ledger Entry"."Amount (LCY)" WHERE (Entry Type=CONST(Usage),
                                                                                                                Service Item No. (Serviced)=FIELD(No.),
                                                                                                                Service Contract No.=FIELD(Contract Filter),
                                                                                                                Service Order No.=FIELD(Service Order Filter),
                                                                                                                Type=FIELD(Type Filter),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Usage (Amount);
                                                              ENG=Usage (Amount)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 65  ;   ;Invoiced Amount     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service Ledger Entry"."Amount (LCY)" WHERE (Entry Type=CONST(Sale),
                                                                                                                 Moved from Prepaid Acc.=CONST(Yes),
                                                                                                                 Service Item No. (Serviced)=FIELD(No.),
                                                                                                                 Service Contract No.=FIELD(Contract Filter),
                                                                                                                 Service Order No.=FIELD(Service Order Filter),
                                                                                                                 Type=FIELD(Type Filter),
                                                                                                                 Posting Date=FIELD(Date Filter),
                                                                                                                 Open=CONST(No)));
                                                   CaptionML=[ENU=Invoiced Amount;
                                                              ENG=Invoiced Amount];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 66  ;   ;Total Quantity      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Ledger Entry".Quantity WHERE (Entry Type=CONST(Usage),
                                                                                                          Service Item No. (Serviced)=FIELD(No.),
                                                                                                          Service Contract No.=FIELD(Contract Filter),
                                                                                                          Service Order No.=FIELD(Service Order Filter),
                                                                                                          Type=FIELD(Type Filter),
                                                                                                          Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Total Quantity;
                                                              ENG=Total Quantity];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 67  ;   ;Total Qty. Invoiced ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service Ledger Entry"."Charged Qty." WHERE (Entry Type=CONST(Sale),
                                                                                                                 Service Item No. (Serviced)=FIELD(No.),
                                                                                                                 Service Contract No.=FIELD(Contract Filter),
                                                                                                                 Service Order No.=FIELD(Service Order Filter),
                                                                                                                 Type=FIELD(Type Filter),
                                                                                                                 Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Total Qty. Invoiced;
                                                              ENG=Total Qty. Invoiced];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 68  ;   ;Resources Used      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service Ledger Entry"."Cost Amount" WHERE (Service Item No. (Serviced)=FIELD(No.),
                                                                                                                Entry Type=CONST(Sale),
                                                                                                                Type=CONST(Resource),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Resources Used;
                                                              ENG=Resources Used];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 69  ;   ;Parts Used          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service Ledger Entry"."Cost Amount" WHERE (Service Item No. (Serviced)=FIELD(No.),
                                                                                                                Entry Type=CONST(Sale),
                                                                                                                Type=CONST(Item),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Parts Used;
                                                              ENG=Parts Used];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 70  ;   ;Cost Used           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service Ledger Entry"."Cost Amount" WHERE (Service Item No. (Serviced)=FIELD(No.),
                                                                                                                Entry Type=CONST(Sale),
                                                                                                                Type=CONST(Service Cost),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Cost Used;
                                                              ENG=Cost Used];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 71  ;   ;Vendor Name         ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Vendor.Name WHERE (No.=FIELD(Vendor No.)));
                                                   CaptionML=[ENU=Vendor Name;
                                                              ENG=Vendor Name];
                                                   Editable=No }
    { 72  ;   ;Vendor Item Name    ;Text50        ;CaptionML=[ENU=Vendor Item Name;
                                                              ENG=Vendor Item Name] }
    { 73  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Comment Line" WHERE (Table Name=CONST(Service Item),
                                                                                                   Table Subtype=CONST(0),
                                                                                                   No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              ENG=Comment];
                                                   Editable=No }
    { 74  ;   ;Service Item Components;Boolean    ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Item Component" WHERE (Parent Service Item No.=FIELD(No.),
                                                                                                     Active=CONST(Yes)));
                                                   CaptionML=[ENU=Service Item Components;
                                                              ENG=Service Item Components];
                                                   Editable=No }
    { 75  ;   ;Preferred Resource  ;Code20        ;TableRelation=Resource.No.;
                                                   OnLookup=VAR
                                                              Resource@1001 : Record 156;
                                                              SkilledResourceList@1000 : Page 6023;
                                                            BEGIN
                                                              SkilledResourceList.Initialize(ResSkill.Type::"Service Item","No.",Description);
                                                              SkilledResourceList.LOOKUPMODE(TRUE);
                                                              IF Resource.GET("Preferred Resource") THEN
                                                                SkilledResourceList.SETRECORD(Resource);
                                                              IF SkilledResourceList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                SkilledResourceList.GETRECORD(Resource);
                                                                "Preferred Resource" := Resource."No.";
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Preferred Resource;
                                                              ENG=Preferred Resource] }
    { 76  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                IF "Variant Code" <> xRec."Variant Code" THEN
                                                                  MessageIfServItemLinesExist(FIELDCAPTION("Variant Code"));
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              ENG=Variant Code] }
    { 77  ;   ;County              ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.County WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=County;
                                                              ENG=County];
                                                   Editable=No }
    { 78  ;   ;Ship-to County      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address".County WHERE (Customer No.=FIELD(Customer No.),
                                                                                                      Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to County;
                                                              ENG=Ship-to County];
                                                   Editable=No }
    { 79  ;   ;Contract Cost       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service Ledger Entry"."Cost Amount" WHERE (Entry Type=CONST(Sale),
                                                                                                                Service Item No. (Serviced)=FIELD(No.),
                                                                                                                Service Contract No.=FIELD(Contract Filter),
                                                                                                                Service Order No.=FIELD(Service Order Filter),
                                                                                                                Type=CONST(Service Contract),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Contract Cost;
                                                              ENG=Contract Cost] }
    { 81  ;   ;Country/Region Code ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Country/Region Code" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Country/Region Code;
                                                              ENG=Country/Region Code];
                                                   Editable=No }
    { 82  ;   ;Ship-to Country/Region Code;Code10 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address"."Country/Region Code" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                     Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              ENG=Ship-to Country/Region Code];
                                                   Editable=No }
    { 83  ;   ;Name 2              ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Name 2" WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Name 2;
                                                              ENG=Name 2];
                                                   Editable=No }
    { 84  ;   ;Ship-to Name 2      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ship-to Address"."Name 2" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                        Code=FIELD(Ship-to Code)));
                                                   CaptionML=[ENU=Ship-to Name 2;
                                                              ENG=Ship-to Name 2];
                                                   Editable=No }
    { 85  ;   ;Service Price Group Code;Code10    ;TableRelation="Service Price Group";
                                                   CaptionML=[ENU=Service Price Group Code;
                                                              ENG=Service Price Group Code] }
    { 86  ;   ;Default Contract Cost;Decimal      ;CaptionML=[ENU=Default Contract Cost;
                                                              ENG=Default Contract Cost];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2 }
    { 87  ;   ;Prepaid Amount      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service Ledger Entry"."Amount (LCY)" WHERE (Entry Type=CONST(Sale),
                                                                                                                 Moved from Prepaid Acc.=CONST(No),
                                                                                                                 Service Item No. (Serviced)=FIELD(No.),
                                                                                                                 Service Contract No.=FIELD(Contract Filter),
                                                                                                                 Service Order No.=FIELD(Service Order Filter),
                                                                                                                 Type=FIELD(Type Filter),
                                                                                                                 Posting Date=FIELD(Date Filter),
                                                                                                                 Open=CONST(No)));
                                                   CaptionML=[ENU=Prepaid Amount;
                                                              ENG=Prepaid Amount];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 88  ;   ;Search Description  ;Code50        ;CaptionML=[ENU=Search Description;
                                                              ENG=Search Description] }
    { 89  ;   ;Service Contracts   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Contract Line" WHERE (Service Item No.=FIELD(No.)));
                                                   CaptionML=[ENU=Service Contracts;
                                                              ENG=Service Contracts];
                                                   Editable=No }
    { 90  ;   ;Total Qty. Consumed ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Service Ledger Entry".Quantity WHERE (Entry Type=CONST(Consume),
                                                                                                           Service Item No. (Serviced)=FIELD(No.),
                                                                                                           Service Contract No.=FIELD(Contract Filter),
                                                                                                           Service Order No.=FIELD(Service Order Filter),
                                                                                                           Type=FIELD(Type Filter),
                                                                                                           Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Total Qty. Consumed;
                                                              ENG=Total Qty. Consumed];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 100 ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              ENG=Date Filter] }
    { 101 ;   ;Type Filter         ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Type Filter;
                                                              ENG=Type Filter];
                                                   OptionCaptionML=[ENU=" ,Resource,Item,Service Cost,Service Contract,G/L Account";
                                                                    ENG=" ,Resource,Item,Service Cost,Service Contract,G/L Account"];
                                                   OptionString=[ ,Resource,Item,Service Cost,Service Contract,G/L Account] }
    { 102 ;   ;Contract Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="Service Contract Header"."Contract No." WHERE (Contract Type=CONST(Contract));
                                                   CaptionML=[ENU=Contract Filter;
                                                              ENG=Contract Filter] }
    { 103 ;   ;Service Order Filter;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="Service Header".No.;
                                                   CaptionML=[ENU=Service Order Filter;
                                                              ENG=Service Order Filter] }
    { 104 ;   ;Sales/Serv. Shpt. Document No.;Code20;
                                                   TableRelation="Sales Shipment Line"."Document No.";
                                                   CaptionML=[ENU=Sales/Serv. Shpt. Document No.;
                                                              ENG=Sales/Serv. Shpt. Document No.] }
    { 105 ;   ;Sales/Serv. Shpt. Line No.;Integer ;TableRelation="Sales Shipment Line"."Line No." WHERE (Document No.=FIELD(Sales/Serv. Shpt. Document No.));
                                                   CaptionML=[ENU=Sales/Serv. Shpt. Line No.;
                                                              ENG=Sales/Serv. Shpt. Line No.] }
    { 106 ;   ;Shipment Type       ;Option        ;CaptionML=[ENU=Shipment Type;
                                                              ENG=Shipment Type];
                                                   OptionCaptionML=[ENU=Sales,Service;
                                                                    ENG=Sales,Service];
                                                   OptionString=Sales,Service }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Item No.,Serial No.                      }
    {    ;Customer No.,Ship-to Code,Item No.,Serial No. }
    {    ;Warranty Ending Date (Parts),Customer No.,Ship-to Code }
    {    ;Sales/Serv. Shpt. Document No.,Sales/Serv. Shpt. Line No. }
    {    ;Service Item Group Code                  }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Description,Status,Item No.,Service Contracts }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete %1 %2,because it is attached to a service order.;ENG=You cannot delete %1 %2,because it is attached to a service order.';
      Text001@1001 : TextConst 'ENU=You cannot delete %1 %2, because it is used as %3 for %1 %4.;ENG=You cannot delete %1 %2, because it is used as %3 for %1 %4.';
      Text002@1002 : TextConst 'ENU=You cannot delete %1 %2, because it belongs to one or more contracts.;ENG=You cannot delete %1 %2, because it belongs to one or more contracts.';
      Text003@1003 : TextConst 'ENU=%1 %2 already exists in %3 %4.;ENG=%1 %2 already exists in %3 %4.';
      Text004@1004 : TextConst 'ENU=You cannot change %1 %2 because the %3 %4 belongs to one or more contracts.;ENG=You cannot change %1 %2 because the %3 %4 belongs to one or more contracts.';
      Text005@1005 : TextConst 'ENU=Changing the %1 will delete the existing %2 on the %2 list.\\;ENG=Changing the %1 will delete the existing %2 on the %2 list.\\';
      Text006@1006 : TextConst 'ENU=Do you want to change the %1?;ENG=Do you want to change the %1?';
      Text007@1007 : TextConst 'ENU=%1 cannot be later than %2.;ENG=%1 cannot be later than %2.';
      Text014@1014 : TextConst 'ENU=You have changed %1 on the service item, but it has not been changed on the associated service orders/quotes.\;ENG=You have changed %1 on the service item, but it has not been changed on the associated service orders/quotes.\';
      Text015@1015 : TextConst 'ENU=You must update them manually.;ENG=You must update them manually.';
      ServMgtSetup@1016 : Record 5911;
      ServItem@1017 : Record 5940;
      ServItemGr@1018 : Record 5904;
      ServContract@1019 : Record 5965;
      ServContractLine@1031 : Record 5964;
      ServCommentLine@1020 : Record 5906;
      Item@1021 : Record 27;
      ContractChangeLog@1022 : Record 5967;
      ServLedgEntry@1024 : Record 5907;
      ServItemLine@1025 : Record 5901;
      ServItemComponent@1026 : Record 5941;
      ResSkill@1034 : Record 5956;
      Currency@1008 : Record 4;
      NoSeriesMgt@1027 : Codeunit 396;
      ServLogMgt@1028 : Codeunit 5906;
      MoveEntries@1032 : Codeunit 361;
      ResSkillMgt@1033 : Codeunit 5931;
      Text016@1029 : TextConst 'ENU=You cannot change the %1 because there are outstanding service orders/quotes attached to it.;ENG=You cannot change the %1 because there are outstanding service orders/quotes attached to it.';
      Text017@1030 : TextConst 'ENU=Service ledger entries exist for this %1\\ Do you want to change the %2?;ENG=Service ledger entries exist for this %1\\ Do you want to change the %2?';
      DimMgt@1039 : Codeunit 408;
      CancelResSkillChanges@1035 : Boolean;
      CancelResSkillAssignment@1036 : Boolean;

    PROCEDURE AssistEdit@3(OldServItem@1000 : Record 5940) : Boolean;
    BEGIN
      WITH ServItem DO BEGIN
        ServItem := Rec;
        ServMgtSetup.GET;
        ServMgtSetup.TESTFIELD("Service Item Nos.");
        IF NoSeriesMgt.SelectSeries(ServMgtSetup."Service Item Nos.",OldServItem."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := ServItem;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE ServItemLinesExist@2() : Boolean;
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Service Item No.");
      ServItemLine.SETRANGE("Service Item No.","No.");
      EXIT(ServItemLine.FINDFIRST);
    END;

    LOCAL PROCEDURE MessageIfServItemLinesExist@8(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF ServItemLinesExist THEN
        MESSAGE(
          Text014 +
          Text015,
          ChangedFieldName);
    END;

    LOCAL PROCEDURE DeleteServItemComponents@6();
    BEGIN
      ServItemComponent.RESET;
      ServItemComponent.SETRANGE("Parent Service Item No.","No.");
      ServItemComponent.DELETEALL;
    END;

    LOCAL PROCEDURE ErrMessageIfServItemLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF ServItemLinesExist THEN
        ERROR(
          Text016,
          ChangedFieldName);
    END;

    LOCAL PROCEDURE ServLedgEntryExist@1() : Boolean;
    BEGIN
      ServLedgEntry.RESET;
      ServLedgEntry.SETCURRENTKEY(
        "Service Item No. (Serviced)","Entry Type","Moved from Prepaid Acc.",
        Type,"Posting Date",Open);
      ServLedgEntry.SETRANGE("Service Item No. (Serviced)","No.");
      EXIT(ServLedgEntry.FINDFIRST);
    END;

    LOCAL PROCEDURE CheckifActiveServContLineExist@4() : Boolean;
    BEGIN
      ServContractLine.RESET;
      ServContractLine.SETCURRENTKEY("Service Item No.","Contract Status");
      ServContractLine.SETRANGE("Service Item No.","No.");
      ServContractLine.SETFILTER("Contract Status",'<>%1',ServContractLine."Contract Status"::Cancelled);
      EXIT(ServContractLine.FIND('-'));
    END;

    PROCEDURE CheckIfCanBeDeleted@5() : Text;
    VAR
      ServiceLedgerEntry@1000 : Record 5907;
    BEGIN
      IF ServItemLinesExist THEN
        EXIT(
          STRSUBSTNO(
            Text000,
            TABLECAPTION,"No."));

      ServItemComponent.RESET;
      ServItemComponent.SETCURRENTKEY(Type,"No.",Active);
      ServItemComponent.SETRANGE(Type,ServItemComponent.Type::"Service Item");
      ServItemComponent.SETRANGE("No.","No.");
      IF ServItemComponent.FINDFIRST THEN
        EXIT(
          STRSUBSTNO(
            Text001,
            TABLECAPTION,"No.",ServItemComponent.TABLECAPTION,ServItemComponent."Parent Service Item No."));

      ServContractLine.RESET;
      ServContractLine.SETCURRENTKEY("Service Item No.","Contract Status");
      ServContractLine.SETRANGE("Service Item No.","No.");
      ServContractLine.SETFILTER("Contract Status",'<>%1',ServContractLine."Contract Status"::Cancelled);
      IF ServContractLine.FIND('-') THEN
        IF ServContract.GET(ServContractLine."Contract Type",ServContractLine."Contract No.") THEN
          EXIT(
            STRSUBSTNO(Text002,TABLECAPTION,"No."));

      EXIT(MoveEntries.CheckIfServiceItemCanBeDeleted(ServiceLedgerEntry,"No."));
    END;

    LOCAL PROCEDURE OmitAssignResSkillDialog@9();
    BEGIN
      ResSkillMgt.SkipValidationDialogs
    END;

    PROCEDURE OmitAssignResSkills@10(IsSetOmitted@1000 : Boolean);
    BEGIN
      CancelResSkillAssignment := IsSetOmitted;
    END;

    BEGIN
    END.
  }
}

