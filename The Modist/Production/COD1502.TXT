OBJECT Codeunit 1502 Workflow Setup
{
  OBJECT-PROPERTIES
  {
    Date=15/09/15;
    Time=12:00:00 PM;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      MsTemplateTok@1065 : TextConst '@@@={Locked};ENU=MS-;ENG=MS-';
      PurchInvWorkflowCodeTxt@1002 : TextConst '@@@={Locked};ENU=PIW;ENG=PIW';
      PurchInvWorkflowDescriptionTxt@1001 : TextConst 'ENU=Purchase Invoice Workflow;ENG=Purchase Invoice Workflow';
      IncDocOCRWorkflowCodeTxt@1090 : TextConst '@@@={Locked};ENU=INCDOC-OCR;ENG=INCDOC-OCR';
      IncDocOCRWorkflowDescriptionTxt@1091 : TextConst 'ENU=Incoming Document OCR Workflow;ENG=Incoming Document OCR Workflow';
      IncDocExchWorkflowCodeTxt@1092 : TextConst '@@@={Locked};ENU=INCDOC-DOCEXCH;ENG=INCDOC-DOCEXCH';
      IncDocExchWorkflowDescriptionTxt@1093 : TextConst 'ENU=Incoming Document Exchange Workflow;ENG=Incoming Document Exchange Workflow';
      IncDocWorkflowCodeTxt@1004 : TextConst '@@@={Locked};ENU=INCDOC;ENG=INCDOC';
      IncDocWorkflowDescTxt@1005 : TextConst 'ENU=Incoming Document Workflow;ENG=Incoming Document Workflow';
      IncomingDocumentApprWorkflowCodeTxt@1080 : TextConst '@@@={Locked};ENU=INCDOCAPW;ENG=INCDOCAPW';
      PurchInvoiceApprWorkflowCodeTxt@1006 : TextConst '@@@={Locked};ENU=PIAPW;ENG=PIAPW';
      PurchReturnOrderApprWorkflowCodeTxt@1012 : TextConst '@@@={Locked};ENU=PROAPW;ENG=PROAPW';
      PurchQuoteApprWorkflowCodeTxt@1016 : TextConst '@@@={Locked};ENU=PQAPW;ENG=PQAPW';
      PurchOrderApprWorkflowCodeTxt@1018 : TextConst '@@@={Locked};ENU=POAPW;ENG=POAPW';
      PurchCreditMemoApprWorkflowCodeTxt@1019 : TextConst '@@@={Locked};ENU=PCMAPW;ENG=PCMAPW';
      PurchBlanketOrderApprWorkflowCodeTxt@1020 : TextConst '@@@={Locked};ENU=BPOAPW;ENG=BPOAPW';
      IncomingDocumentApprWorkflowDescTxt@1081 : TextConst 'ENU=Incoming Document Approval Workflow;ENG=Incoming Document Approval Workflow';
      PurchInvoiceApprWorkflowDescTxt@1007 : TextConst 'ENU=Purchase Invoice Approval Workflow;ENG=Purchase Invoice Approval Workflow';
      PurchReturnOrderApprWorkflowDescTxt@1014 : TextConst 'ENU=Purchase Return Order Approval Workflow;ENG=Purchase Return Order Approval Workflow';
      PurchQuoteApprWorkflowDescTxt@1023 : TextConst 'ENU=Purchase Quote Approval Workflow;ENG=Purchase Quote Approval Workflow';
      PurchOrderApprWorkflowDescTxt@1022 : TextConst 'ENU=Purchase Order Approval Workflow;ENG=Purchase Order Approval Workflow';
      PurchCreditMemoApprWorkflowDescTxt@1025 : TextConst 'ENU=Purchase Credit Memo Approval Workflow;ENG=Purchase Credit Memo Approval Workflow';
      PurchBlanketOrderApprWorkflowDescTxt@1024 : TextConst 'ENU=Blanket Purchase Order Approval Workflow;ENG=Blanket Purchase Order Approval Workflow';
      PendingApprovalsCondnTxt@1017 : TextConst '@@@={Locked};ENU="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Approval Entry"">%1</DataItem></DataItems></ReportParameters>";ENG="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Approval Entry"">%1</DataItem></DataItems></ReportParameters>"';
      PurchHeaderTypeCondnTxt@1011 : TextConst '@@@={Locked};ENU="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Purchase Header"">%1</DataItem><DataItem name=""Purchase Line"">%2</DataItem></DataItems></ReportParameters>";ENG="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Purchase Header"">%1</DataItem><DataItem name=""Purchase Line"">%2</DataItem></DataItems></ReportParameters>"';
      SalesHeaderTypeCondnTxt@1035 : TextConst '@@@={Locked};ENU="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Sales Header"">%1</DataItem><DataItem name=""Sales Line"">%2</DataItem></DataItems></ReportParameters>";ENG="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Sales Header"">%1</DataItem><DataItem name=""Sales Line"">%2</DataItem></DataItems></ReportParameters>"';
      IncomingDocumentTypeCondnTxt@1083 : TextConst '@@@={Locked};ENU="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Incoming Document"">%1</DataItem><DataItem name=""Incoming Document Attachment"">%2</DataItem></DataItems></ReportParameters>";ENG="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Incoming Document"">%1</DataItem><DataItem name=""Incoming Document Attachment"">%2</DataItem></DataItems></ReportParameters>"';
      CustomerTypeCondnTxt@1149 : TextConst '@@@={Locked};ENU="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Customer"">%1</DataItem></DataItems></ReportParameters>";ENG="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Customer"">%1</DataItem></DataItems></ReportParameters>"';
      GeneralJournalBatchTypeCondnTxt@1059 : TextConst '@@@={Locked};ENU="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Gen. Journal Batch"">%1</DataItem></DataItems></ReportParameters>";ENG="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Gen. Journal Batch"">%1</DataItem></DataItems></ReportParameters>"';
      GeneralJournalLineTypeCondnTxt@1063 : TextConst '@@@={Locked};ENU="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Gen. Journal Line"">%1</DataItem></DataItems></ReportParameters>";ENG="<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?><ReportParameters><DataItems><DataItem name=""Gen. Journal Line"">%1</DataItem></DataItems></ReportParameters>"';
      InvalidEventCondErr@1026 : TextConst 'ENU=No event conditions are specified.;ENG=No event conditions are specified.';
      OverdueWorkflowCodeTxt@1000 : TextConst '@@@={Locked};ENU=OVERDUE;ENG=OVERDUE';
      OverdueWorkflowDescTxt@1003 : TextConst 'ENU=Overdue Approval Requests Workflow;ENG=Overdue Approval Requests Workflow';
      WorkflowEventHandling@1052 : Codeunit 1520;
      WorkflowResponseHandling@1051 : Codeunit 1521;
      WorkflowRequestPageHandling@1060 : Codeunit 1522;
      BlankDateFormula@1009 : DateFormula;
      SalesInvoiceApprWorkflowCodeTxt@1034 : TextConst '@@@={Locked};ENU=SIAPW;ENG=SIAPW';
      SalesReturnOrderApprWorkflowCodeTxt@1033 : TextConst '@@@={Locked};ENU=SROAPW;ENG=SROAPW';
      SalesQuoteApprWorkflowCodeTxt@1032 : TextConst '@@@={Locked};ENU=SQAPW;ENG=SQAPW';
      SalesOrderApprWorkflowCodeTxt@1031 : TextConst '@@@={Locked};ENU=SOAPW;ENG=SOAPW';
      SalesCreditMemoApprWorkflowCodeTxt@1030 : TextConst '@@@={Locked};ENU=SCMAPW;ENG=SCMAPW';
      SalesBlanketOrderApprWorkflowCodeTxt@1029 : TextConst '@@@={Locked};ENU=BSOAPW;ENG=BSOAPW';
      SalesInvoiceCreditLimitApprWorkflowCodeTxt@1036 : TextConst '@@@={Locked};ENU=SICLAPW;ENG=SICLAPW';
      SalesOrderCreditLimitApprWorkflowCodeTxt@1037 : TextConst '@@@={Locked};ENU=SOCLAPW;ENG=SOCLAPW';
      SalesRetOrderCrLimitApprWorkflowCodeTxt@1043 : TextConst '@@@={Locked};ENU=SROCLAPW;ENG=SROCLAPW';
      SalesQuoteCrLimitApprWorkflowCodeTxt@1042 : TextConst '@@@={Locked};ENU=SQCLAPW;ENG=SQCLAPW';
      SalesCrMemoCrLimitApprWorkflowCodeTxt@1041 : TextConst '@@@={Locked};ENU=SCMCLAPW;ENG=SCMCLAPW';
      SalesBlanketOrderCrLimitApprWorkflowCodeTxt@1040 : TextConst '@@@={Locked};ENU=BSOCLAPW;ENG=BSOCLAPW';
      SalesInvoiceApprWorkflowDescTxt@1028 : TextConst 'ENU=Sales Invoice Approval Workflow;ENG=Sales Invoice Approval Workflow';
      SalesReturnOrderApprWorkflowDescTxt@1027 : TextConst 'ENU=Sales Return Order Approval Workflow;ENG=Sales Return Order Approval Workflow';
      SalesQuoteApprWorkflowDescTxt@1021 : TextConst 'ENU=Sales Quote Approval Workflow;ENG=Sales Quote Approval Workflow';
      SalesOrderApprWorkflowDescTxt@1015 : TextConst 'ENU=Sales Order Approval Workflow;ENG=Sales Order Approval Workflow';
      SalesCreditMemoApprWorkflowDescTxt@1013 : TextConst 'ENU=Sales Credit Memo Approval Workflow;ENG=Sales Credit Memo Approval Workflow';
      SalesBlanketOrderApprWorkflowDescTxt@1010 : TextConst 'ENU=Blanket Sales Order Approval Workflow;ENG=Blanket Sales Order Approval Workflow';
      SalesInvoiceCreditLimitApprWorkflowDescTxt@1038 : TextConst 'ENU=Sales Invoice Credit Limit Approval Workflow;ENG=Sales Invoice Credit Limit Approval Workflow';
      SalesOrderCreditLimitApprWorkflowDescTxt@1039 : TextConst 'ENU=Sales Order Credit Limit Approval Workflow;ENG=Sales Order Credit Limit Approval Workflow';
      SalesRetOrderCrLimitApprWorkflowDescTxt@1047 : TextConst 'ENU=Sales Return Order Credit Limit Approval Workflow;ENG=Sales Return Order Credit Limit Approval Workflow';
      SalesQuoteCrLimitApprWorkflowDescTxt@1046 : TextConst 'ENU=Sales Quote Credit Limit Approval Workflow;ENG=Sales Quote Credit Limit Approval Workflow';
      SalesCrMemoCrLimitApprWorkflowDescTxt@1045 : TextConst 'ENU=Sales Credit Memo Credit Limit Approval Workflow;ENG=Sales Credit Memo Credit Limit Approval Workflow';
      SalesBlanketOrderCrLimitApprWorkflowDescTxt@1044 : TextConst 'ENU=Blanket Sales Order Credit Limit Approval Workflow;ENG=Blanket Sales Order Credit Limit Approval Workflow';
      MailNotifyJobQueueCategoryCodeTxt@1050 : TextConst '@@@=Must be max. 10 chars and no spacing.;ENU=MAILNOTIFY;ENG=MAILNOTIFY';
      MailNotifyJobQueueCategoryDescTxt@1049 : TextConst 'ENU=Sends notification;ENG=Sends notification';
      NotifyJobQueueCodeTxt@1048 : TextConst '@@@=Must be max. 10 chars and no spacing.;ENU=NOTIFY;ENG=NOTIFY';
      NotifyJobQueueDescTxt@1008 : TextConst 'ENU=Notification Job Queue;ENG=Notification Job Queue';
      DelegateJobQueueCategoryCodeTxt@1064 : TextConst '@@@=Must be max. 10 chars and no spacing.;ENU=DELEGATE;ENG=DELEGATE';
      DelegateJobQueueCategoryDescTxt@1058 : TextConst 'ENU=Delegates approval entries;ENG=Delegates approval entries';
      DelegateJobQueueCodeTxt@1057 : TextConst '@@@=Must be max. 10 chars and no spacing.;ENU=DELEGATE;ENG=DELEGATE';
      DelegateJobQueueDescTxt@1056 : TextConst 'ENU=Delegation Job Queue;ENG=Delegation Job Queue';
      CustomerApprWorkflowCodeTxt@1148 : TextConst '@@@={Locked};ENU=CUSTAPW;ENG=CUSTAPW';
      CustomerApprWorkflowDescTxt@1108 : TextConst 'ENU=Customer Approval Workflow;ENG=Customer Approval Workflow';
      CustomerCredLmtChangeApprWorkflowCodeTxt@1070 : TextConst '@@@={Locked};ENU=CCLCAPW;ENG=CCLCAPW';
      CustomerCredLmtChangeApprWorkflowDescTxt@1069 : TextConst 'ENU=Customer Credit Limit Change Approval Workflow;ENG=Customer Credit Limit Change Approval Workflow';
      GeneralJournalBatchApprWorkflowCodeTxt@1054 : TextConst '@@@={Locked};ENU=GJBAPW;ENG=GJBAPW';
      GeneralJournalBatchApprWorkflowDescTxt@1053 : TextConst 'ENU=General Journal Batch Approval Workflow;ENG=General Journal Batch Approval Workflow';
      GeneralJournalLineApprWorkflowCodeTxt@1062 : TextConst '@@@={Locked};ENU=GJLAPW;ENG=GJLAPW';
      GeneralJournalLineApprWorkflowDescTxt@1061 : TextConst 'ENU=General Journal Line Approval Workflow;ENG=General Journal Line Approval Workflow';
      GeneralJournalBatchIsNotBalancedMsg@1055 : TextConst '@@@=General Journal Batch refers to the name of a record.;ENU=The selected general journal batch is not balanced and cannot be sent for approval.;ENG=The selected general journal batch is not balanced and cannot be sent for approval.';
      ApprovalRequestCanceledMsg@1165 : TextConst 'ENU=The approval request for the record has been canceled.;ENG=The approval request for the record has been cancelled.';
      SendToOCRWorkflowCodeTxt@1067 : TextConst '@@@={Locked};ENU=INCDOC-OCR;ENG=INCDOC-OCR';
      CustCredLmtChangeSentForAppTxt@1072 : TextConst 'ENU=The customer credit limit change was sent for approval.;ENG=The customer credit limit change was sent for approval.';
      IntegrationCategoryTxt@1071 : TextConst '@@@={Locked};ENU=INT;ENG=INT';
      SalesMktCategoryTxt@1073 : TextConst '@@@={Locked};ENU=SALES;ENG=SALES';
      PurchPayCategoryTxt@1074 : TextConst '@@@={Locked};ENU=PURCH;ENG=PURCH';
      PurchDocCategoryTxt@1075 : TextConst '@@@={Locked};ENU=PURCHDOC;ENG=PURCHDOC';
      SalesDocCategoryTxt@1076 : TextConst '@@@={Locked};ENU=SALESDOC;ENG=SALESDOC';
      AdminCategoryTxt@1077 : TextConst '@@@={Locked};ENU=ADMIN;ENG=ADMIN';
      FinCategoryTxt@1087 : TextConst '@@@={Locked};ENU=FIN;ENG=FIN';
      IntegrationCategoryDescTxt@1086 : TextConst 'ENU=Integration;ENG=Integration';
      SalesMktCategoryDescTxt@1085 : TextConst 'ENU=Sales and Marketing;ENG=Sales and Marketing';
      PurchPayCategoryDescTxt@1084 : TextConst 'ENU=Purchases and Payables;ENG=Purchases and Payables';
      PurchDocCategoryDescTxt@1082 : TextConst 'ENU=Purchase Documents;ENG=Purchase Documents';
      SalesDocCategoryDescTxt@1079 : TextConst 'ENU=Sales Documents;ENG=Sales Documents';
      AdminCategoryDescTxt@1078 : TextConst 'ENU=Administration;ENG=Administration';
      FinCategoryDescTxt@1088 : TextConst 'ENU=Finance;ENG=Finance';

    PROCEDURE InitWorkflow@23();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      WorkflowEventHandling.CreateEventsLibrary;
      WorkflowRequestPageHandling.CreateEntitiesAndFields;
      WorkflowRequestPageHandling.AssignEntitiesToWorkflowEvents;
      WorkflowResponseHandling.CreateResponsesLibrary;
      InsertWorkflowCategories;
      InsertJobQueueData;

      Workflow.SETRANGE(Template,TRUE);
      IF Workflow.FINDFIRST THEN
        EXIT;

      InsertWorkflowTemplates;
    END;

    LOCAL PROCEDURE InsertWorkflowTemplates@24();
    BEGIN
      InsertApprovalsTableRelations;

      InsertIncomingDocumentWorkflowTemplate;
      InsertIncomingDocumentApprovalWorkflowTemplate;
      InsertIncomingDocumentOCRWorkflowTemplate;
      InsertIncomingDocumentDocExchWorkflowTemplate;

      InsertPurchaseInvoiceWorkflowTemplate;

      InsertPurchaseBlanketOrderApprovalWorkflowTemplate;
      InsertPurchaseCreditMemoApprovalWorkflowTemplate;
      InsertPurchaseInvoiceApprovalWorkflowTemplate;
      InsertPurchaseOrderApprovalWorkflowTemplate;
      InsertPurchaseQuoteApprovalWorkflowTemplate;
      InsertPurchaseReturnOrderApprovalWorkflowTemplate;

      InsertSalesBlanketOrderApprovalWorkflowTemplate;
      InsertSalesCreditMemoApprovalWorkflowTemplate;
      InsertSalesInvoiceApprovalWorkflowTemplate;
      InsertSalesOrderApprovalWorkflowTemplate;
      InsertSalesQuoteApprovalWorkflowTemplate;
      InsertSalesReturnOrderApprovalWorkflowTemplate;

      InsertSalesInvoiceCreditLimitApprovalWorkflowTemplate;
      InsertSalesOrderCreditLimitApprovalWorkflowTemplate;

      InsertOverdueApprovalsWorkflowTemplate;

      InsertCustomerApprovalWorkflowTemplate;
      InsertCustomerCreditLimitChangeApprovalWorkflowTemplate;

      InsertGeneralJournalBatchApprovalWorkflowTemplate;
      InsertGeneralJournalLineApprovalWorkflowTemplate;
    END;

    PROCEDURE InsertWorkflowCategories@126();
    BEGIN
      InsertWorkflowCategory(IntegrationCategoryTxt,IntegrationCategoryDescTxt);
      InsertWorkflowCategory(SalesMktCategoryTxt,SalesMktCategoryDescTxt);
      InsertWorkflowCategory(PurchPayCategoryTxt,PurchPayCategoryDescTxt);
      InsertWorkflowCategory(PurchDocCategoryTxt,PurchDocCategoryDescTxt);
      InsertWorkflowCategory(SalesDocCategoryTxt,SalesDocCategoryDescTxt);
      InsertWorkflowCategory(AdminCategoryTxt,AdminCategoryDescTxt);
      InsertWorkflowCategory(FinCategoryTxt,FinCategoryDescTxt);

      OnAddWorkflowCategoriesToLibrary;
    END;

    [Integration]
    LOCAL PROCEDURE OnAddWorkflowCategoriesToLibrary@134();
    BEGIN
    END;

    LOCAL PROCEDURE InsertWorkflow@80(VAR Workflow@1003 : Record 1501;WorkflowCode@1001 : Code[20];WorkflowDescription@1002 : Text[100];CategoryCode@1000 : Code[20]);
    BEGIN
      Workflow.INIT;
      Workflow.Code := WorkflowCode;
      Workflow.Description := WorkflowDescription;
      Workflow.Category := CategoryCode;
      Workflow.Enabled := FALSE;
      Workflow.INSERT;
    END;

    LOCAL PROCEDURE InsertWorkflowTemplate@52(VAR Workflow@1003 : Record 1501;WorkflowCode@1001 : Code[17];WorkflowDescription@1002 : Text[100];CategoryCode@1000 : Code[20]);
    BEGIN
      Workflow.INIT;
      Workflow.Code := GetWorkflowTemplateCode(WorkflowCode);
      Workflow.Description := WorkflowDescription;
      Workflow.Category := CategoryCode;
      Workflow.Enabled := FALSE;
      IF Workflow.INSERT THEN;
    END;

    PROCEDURE InsertApprovalsTableRelations@50();
    VAR
      IncomingDocument@1003 : Record 130;
      ApprovalEntry@1000 : Record 454;
    BEGIN
      InsertTableRelation(DATABASE::"Purchase Header",0,
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Record ID to Approve"));

      InsertTableRelation(DATABASE::"Sales Header",0,
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Record ID to Approve"));

      InsertTableRelation(DATABASE::Customer,0,
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Record ID to Approve"));
      InsertTableRelation(DATABASE::Vendor,0,
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Record ID to Approve"));
      InsertTableRelation(DATABASE::Item,0,
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Record ID to Approve"));
      InsertTableRelation(DATABASE::"Gen. Journal Line",0,
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Record ID to Approve"));
      InsertTableRelation(DATABASE::"Gen. Journal Batch",0,
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Record ID to Approve"));

      InsertTableRelation(
        DATABASE::"Incoming Document",IncomingDocument.FIELDNO("Entry No."),
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Document No."));
      InsertTableRelation(
        DATABASE::"Approval Entry",ApprovalEntry.FIELDNO("Document No."),
        DATABASE::"Incoming Document",IncomingDocument.FIELDNO("Entry No."));
    END;

    LOCAL PROCEDURE InsertIncomingDocumentWorkflowTemplate@65();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,IncDocWorkflowCodeTxt,IncDocWorkflowDescTxt,IntegrationCategoryTxt);
      InsertIncomingDocumentWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertIncomingDocumentWorkflowDetails@77(VAR Workflow@1000 : Record 1501);
    VAR
      IncomingDocument@1005 : Record 130;
      PurchaseHeader@1004 : Record 38;
      OnIncomingDocumentCreatedEventID@1001 : Integer;
    BEGIN
      InsertTableRelation(DATABASE::"Incoming Document",IncomingDocument.FIELDNO("Entry No."),
        DATABASE::"Purchase Header",PurchaseHeader.FIELDNO("Incoming Document Entry No."));
      InsertTableRelation(DATABASE::"Purchase Header",PurchaseHeader.FIELDNO("Incoming Document Entry No."),
        DATABASE::"Incoming Document",IncomingDocument.FIELDNO("Entry No."));

      OnIncomingDocumentCreatedEventID :=
        InsertEntryPointEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterInsertIncomingDocumentCode);
      InsertResponseStep(Workflow,WorkflowResponseHandling.CreateNotificationEntryCode,OnIncomingDocumentCreatedEventID);
    END;

    LOCAL PROCEDURE InsertIncomingDocumentOCRWorkflowTemplate@133();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,IncDocOCRWorkflowCodeTxt,IncDocOCRWorkflowDescriptionTxt,IntegrationCategoryTxt);
      InsertIncomingDocumentOCRWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertIncomingDocumentOCRWorkflowDetails@138(VAR Workflow@1003 : Record 1501);
    VAR
      IncomingDocument@1000 : Record 130;
      OCRSuccessEventID@1015 : Integer;
      CreateDocResponseID@1004 : Integer;
      NotifyResponseID@1016 : Integer;
      DocSuccessEventID@1007 : Integer;
      DocErrorEventID@1006 : Integer;
    BEGIN
      OCRSuccessEventID :=
        InsertEntryPointEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterReceiveFromOCRIncomingDocCode);
      InsertEventArgument(OCRSuccessEventID,BuildIncomingDocumentOCRTypeConditions(IncomingDocument."OCR Status"::Success));
      CreateDocResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.GetCreateDocFromIncomingDocCode,OCRSuccessEventID);

      DocSuccessEventID :=
        InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterCreateDocFromIncomingDocSuccessCode,CreateDocResponseID);
      InsertEventArgument(DocSuccessEventID,BuildIncomingDocumentTypeConditions(IncomingDocument.Status::Created));
      InsertResponseStep(Workflow,WorkflowResponseHandling.DoNothingCode,DocSuccessEventID);

      DocErrorEventID :=
        InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterCreateDocFromIncomingDocFailCode,CreateDocResponseID);
      InsertEventArgument(DocErrorEventID,BuildIncomingDocumentTypeConditions(IncomingDocument.Status::Failed));
      NotifyResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CreateNotificationEntryCode,DocErrorEventID);

      InsertNotificationArgument(NotifyResponseID,'',PAGE::"Incoming Document",'');
    END;

    LOCAL PROCEDURE InsertIncomingDocumentDocExchWorkflowTemplate@129();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,IncDocExchWorkflowCodeTxt,IncDocExchWorkflowDescriptionTxt,IntegrationCategoryTxt);
      InsertIncomingDocumentDocExchWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertIncomingDocumentDocExchWorkflowDetails@127(VAR Workflow@1003 : Record 1501);
    VAR
      IncomingDocument@1000 : Record 130;
      IncDocCreatedEventID@1008 : Integer;
      DocReleasedEventID@1013 : Integer;
      DocSuccessEventID@1015 : Integer;
      DocErrorEventID@1005 : Integer;
      ReleaseDocResponseID@1010 : Integer;
      CreateDocResponseID@1004 : Integer;
      NotifyResponseID@1016 : Integer;
    BEGIN
      IncDocCreatedEventID :=
        InsertEntryPointEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterReceiveFromDocExchIncomingDocCode);
      InsertEventArgument(IncDocCreatedEventID,BuildIncomingDocumentTypeConditions(IncomingDocument.Status::New));
      ReleaseDocResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.ReleaseDocumentCode,IncDocCreatedEventID);

      DocReleasedEventID :=
        InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterReleaseIncomingDocCode,ReleaseDocResponseID);
      InsertEventArgument(DocReleasedEventID,BuildIncomingDocumentTypeConditions(IncomingDocument.Status::Released));
      CreateDocResponseID :=
        InsertResponseStep(Workflow,WorkflowResponseHandling.GetCreateDocFromIncomingDocCode,DocReleasedEventID);

      DocSuccessEventID :=
        InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterCreateDocFromIncomingDocSuccessCode,CreateDocResponseID);
      InsertEventArgument(DocSuccessEventID,BuildIncomingDocumentTypeConditions(IncomingDocument.Status::Created));
      InsertResponseStep(Workflow,WorkflowResponseHandling.DoNothingCode,DocSuccessEventID);

      DocErrorEventID :=
        InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterCreateDocFromIncomingDocFailCode,CreateDocResponseID);
      InsertEventArgument(DocErrorEventID,BuildIncomingDocumentTypeConditions(IncomingDocument.Status::Failed));
      NotifyResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CreateNotificationEntryCode,DocErrorEventID);

      InsertNotificationArgument(NotifyResponseID,'',PAGE::"Incoming Document",'');
    END;

    LOCAL PROCEDURE InsertPurchaseInvoiceWorkflowTemplate@79();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,PurchInvWorkflowCodeTxt,PurchInvWorkflowDescriptionTxt,PurchDocCategoryTxt);
      InsertPurchaseInvoiceWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertPurchaseInvoiceWorkflowDetails@85(VAR Workflow@1003 : Record 1501);
    VAR
      PurchaseHeader@1000 : Record 38;
      PurchInvHeader@1001 : Record 122;
      GenJournalLine@1002 : Record 81;
      DocReleasedEventID@1008 : Integer;
      PostedEventID@1013 : Integer;
      JournalLineCreatedEventID@1015 : Integer;
      PostDocAsyncResponseID@1010 : Integer;
      CreatePmtLineResponseID@1014 : Integer;
      NotifyResponseID@1016 : Integer;
    BEGIN
      InsertTableRelation(DATABASE::"Purchase Header",PurchaseHeader.FIELDNO("No."),
        DATABASE::"Purch. Inv. Header",PurchInvHeader.FIELDNO("Pre-Assigned No."));
      InsertTableRelation(DATABASE::"Purch. Inv. Header",PurchaseHeader.FIELDNO("No."),
        DATABASE::"Gen. Journal Line",GenJournalLine.FIELDNO("Applies-to Doc. No."));

      DocReleasedEventID := InsertEntryPointEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterReleasePurchaseDocCode);
      InsertEventArgument(DocReleasedEventID,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::Invoice,PurchaseHeader.Status::Released));

      PostDocAsyncResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.PostDocumentAsyncCode,DocReleasedEventID);

      PostedEventID :=
        InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterPostPurchaseDocCode,PostDocAsyncResponseID);
      CreatePmtLineResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CreatePmtLineForPostedPurchaseDocAsyncCode,
          PostedEventID);
      InsertPmtLineCreationArgument(CreatePmtLineResponseID,'','');

      JournalLineCreatedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnAfterInsertGeneralJournalLineCode,
          CreatePmtLineResponseID);

      GenJournalLine.SETRANGE("Document Type",GenJournalLine."Document Type"::Payment);
      InsertEventArgument(JournalLineCreatedEventID,BuildGeneralJournalLineTypeConditions(GenJournalLine));

      NotifyResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CreateNotificationEntryCode,JournalLineCreatedEventID);
      InsertNotificationArgument(NotifyResponseID,'',PAGE::"Payment Journal",'');
    END;

    PROCEDURE InsertIncomingDocumentApprovalWorkflowTemplate@110();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,IncomingDocumentApprWorkflowCodeTxt,IncomingDocumentApprWorkflowDescTxt,IntegrationCategoryTxt);
      InsertIncomingDocumentApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertIncomingDocumentApprovalWorkflowDetails@108(VAR Workflow@1001 : Record 1501);
    VAR
      IncomingDocument@1000 : Record 130;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Workflow User Group",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(
        Workflow,
        BuildIncomingDocumentTypeConditions(IncomingDocument.Status::New),
        WorkflowEventHandling.RunWorkflowOnSendIncomingDocForApprovalCode,
        BuildIncomingDocumentTypeConditions(IncomingDocument.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelIncomingDocApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertPurchaseInvoiceApprovalWorkflowTemplate@81();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,PurchInvoiceApprWorkflowCodeTxt,PurchInvoiceApprWorkflowDescTxt,PurchDocCategoryTxt);
      InsertPurchaseInvoiceApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertPurchaseInvoiceApprovalWorkflowDetails@91(VAR Workflow@1001 : Record 1501);
    VAR
      PurchaseHeader@1000 : Record 38;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::Invoice,PurchaseHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendPurchaseDocForApprovalCode,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::Invoice,PurchaseHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelPurchaseApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertPurchaseBlanketOrderApprovalWorkflowTemplate@83();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,PurchBlanketOrderApprWorkflowCodeTxt,PurchBlanketOrderApprWorkflowDescTxt,PurchDocCategoryTxt);
      InsertPurchaseBlanketOrderApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertPurchaseBlanketOrderApprovalWorkflowDetails@102(VAR Workflow@1001 : Record 1501);
    VAR
      PurchaseHeader@1000 : Record 38;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Workflow User Group",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::"Blanket Order",PurchaseHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendPurchaseDocForApprovalCode,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::"Blanket Order",PurchaseHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelPurchaseApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertPurchaseCreditMemoApprovalWorkflowTemplate@86();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,PurchCreditMemoApprWorkflowCodeTxt,PurchCreditMemoApprWorkflowDescTxt,PurchDocCategoryTxt);
      InsertPurchaseCreditMemoApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertPurchaseCreditMemoApprovalWorkflowDetails@106(VAR Workflow@1001 : Record 1501);
    VAR
      PurchaseHeader@1000 : Record 38;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::"Credit Memo",PurchaseHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendPurchaseDocForApprovalCode,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::"Credit Memo",PurchaseHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelPurchaseApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertPurchaseOrderApprovalWorkflowTemplate@88();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,PurchOrderApprWorkflowCodeTxt,PurchOrderApprWorkflowDescTxt,PurchDocCategoryTxt);
      InsertPurchaseOrderApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertPurchaseOrderApprovalWorkflowDetails@112(VAR Workflow@1001 : Record 1501);
    VAR
      PurchaseHeader@1000 : Record 38;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::Approver,WorkflowStepArgument."Approver Limit Type"::"Approver Chain",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::Order,PurchaseHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendPurchaseDocForApprovalCode,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::Order,PurchaseHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelPurchaseApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertPurchaseQuoteApprovalWorkflowTemplate@90();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,PurchQuoteApprWorkflowCodeTxt,PurchQuoteApprWorkflowDescTxt,PurchDocCategoryTxt);
      InsertPurchaseQuoteApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertPurchaseQuoteApprovalWorkflowDetails@117(VAR Workflow@1001 : Record 1501);
    VAR
      PurchaseHeader@1000 : Record 38;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::Approver,WorkflowStepArgument."Approver Limit Type"::"Approver Chain",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::Quote,PurchaseHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendPurchaseDocForApprovalCode,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::Quote,PurchaseHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelPurchaseApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertPurchaseReturnOrderApprovalWorkflowTemplate@92();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,PurchReturnOrderApprWorkflowCodeTxt,PurchReturnOrderApprWorkflowDescTxt,PurchDocCategoryTxt);
      InsertPurchaseReturnOrderApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertPurchaseReturnOrderApprovalWorkflowDetails@119(VAR Workflow@1001 : Record 1501);
    VAR
      PurchaseHeader@1000 : Record 38;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::"Return Order",PurchaseHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendPurchaseDocForApprovalCode,
        BuildPurchHeaderTypeConditions(PurchaseHeader."Document Type"::"Return Order",PurchaseHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelPurchaseApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesInvoiceApprovalWorkflowTemplate@94();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,SalesInvoiceApprWorkflowCodeTxt,SalesInvoiceApprWorkflowDescTxt,SalesDocCategoryTxt);
      InsertSalesInvoiceApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertSalesInvoiceApprovalWorkflowDetails@82(VAR Workflow@1001 : Record 1501);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Invoice,SalesHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendSalesDocForApprovalCode,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Invoice,SalesHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelSalesApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesBlanketOrderApprovalWorkflowTemplate@96();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,SalesBlanketOrderApprWorkflowCodeTxt,SalesBlanketOrderApprWorkflowDescTxt,SalesDocCategoryTxt);
      InsertSalesBlanketOrderApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertSalesBlanketOrderApprovalWorkflowDetails@87(VAR Workflow@1001 : Record 1501);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Workflow User Group",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::"Blanket Order",SalesHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendSalesDocForApprovalCode,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::"Blanket Order",SalesHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelSalesApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesCreditMemoApprovalWorkflowTemplate@98();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,SalesCreditMemoApprWorkflowCodeTxt,SalesCreditMemoApprWorkflowDescTxt,SalesDocCategoryTxt);
      InsertSalesCreditMemoApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertSalesCreditMemoApprovalWorkflowDetails@95(VAR Workflow@1001 : Record 1501);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::"Credit Memo",SalesHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendSalesDocForApprovalCode,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::"Credit Memo",SalesHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelSalesApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesOrderApprovalWorkflowTemplate@100();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,SalesOrderApprWorkflowCodeTxt,SalesOrderApprWorkflowDescTxt,SalesDocCategoryTxt);
      InsertSalesOrderApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertSalesOrderApprovalWorkflowDetails@99(VAR Workflow@1001 : Record 1501);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",
        WorkflowStepArgument."Approver Limit Type"::"Approver Chain",0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Order,SalesHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendSalesDocForApprovalCode,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Order,SalesHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelSalesApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesQuoteApprovalWorkflowTemplate@103();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,SalesQuoteApprWorkflowCodeTxt,SalesQuoteApprWorkflowDescTxt,SalesDocCategoryTxt);
      InsertSalesQuoteApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertSalesQuoteApprovalWorkflowDetails@104(VAR Workflow@1001 : Record 1501);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Quote,SalesHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendSalesDocForApprovalCode,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Quote,SalesHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelSalesApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesReturnOrderApprovalWorkflowTemplate@105();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,SalesReturnOrderApprWorkflowCodeTxt,SalesReturnOrderApprWorkflowDescTxt,SalesDocCategoryTxt);
      InsertSalesReturnOrderApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertSalesReturnOrderApprovalWorkflowDetails@113(VAR Workflow@1001 : Record 1501);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1003 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::"Return Order",SalesHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendSalesDocForApprovalCode,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::"Return Order",SalesHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelSalesApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesInvoiceCreditLimitApprovalWorkflowTemplate@107();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,SalesInvoiceCreditLimitApprWorkflowCodeTxt,
        SalesInvoiceCreditLimitApprWorkflowDescTxt,SalesDocCategoryTxt);
      InsertSalesInvoiceCreditLimitApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertSalesInvoiceCreditLimitApprovalWorkflowDetails@116(VAR Workflow@1002 : Record 1501);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1001 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertSalesDocWithCreditLimitApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Invoice,SalesHeader.Status::Open),
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Invoice,SalesHeader.Status::"Pending Approval"),
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesOrderCreditLimitApprovalWorkflowTemplate@109();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,SalesOrderCreditLimitApprWorkflowCodeTxt,
        SalesOrderCreditLimitApprWorkflowDescTxt,SalesDocCategoryTxt);
      InsertSalesOrderCreditLimitApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertSalesOrderCreditLimitApprovalWorkflowDetails@120(VAR Workflow@1000 : Record 1501);
    VAR
      SalesHeader@1002 : Record 36;
      WorkflowStepArgument@1001 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Salesperson/Purchaser",
        WorkflowStepArgument."Approver Limit Type"::"Approver Chain",0,'',BlankDateFormula,TRUE);

      InsertSalesDocWithCreditLimitApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Order,SalesHeader.Status::Open),
        BuildSalesHeaderTypeConditions(SalesHeader."Document Type"::Order,SalesHeader.Status::"Pending Approval"),
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertSalesDocWithCreditLimitApprovalWorkflowSteps@54(Workflow@1000 : Record 1501;DocSentForApprovalConditionString@1001 : Text;DocCanceledConditionString@1023 : Text;WorkflowStepArgument@1020 : Record 1523;ShowConfirmationMessage@1026 : Boolean);
    VAR
      SentForApprovalEventID@1004 : Integer;
      CheckCustomerCreditLimitResponseID@1006 : Integer;
      CustomerCreditLimitExceededEventID@1007 : Integer;
      CustomerCreditLimitNotExceededEventID@1008 : Integer;
      SetStatusToPendingApprovalResponseID@1002 : Integer;
      CreateApprovalRequestResponseID@1019 : Integer;
      SendApprovalRequestResponseID@1018 : Integer;
      OnAllRequestsApprovedEventID@1017 : Integer;
      OnRequestApprovedEventID@1016 : Integer;
      SendApprovalRequestResponseID2@1015 : Integer;
      OnRequestRejectedEventID@1014 : Integer;
      RejectAllApprovalsResponseID@1013 : Integer;
      OnRequestCanceledEventID@1012 : Integer;
      CancelAllApprovalsResponseID@1011 : Integer;
      OnRequestDelegatedEventID@1010 : Integer;
      SentApprovalRequestResponseID3@1009 : Integer;
      SetStatusToPendingApprovalResponseID2@1025 : Integer;
      CreateAndApproveApprovalRequestResponseID@1021 : Integer;
      OpenDocumentResponseID@1003 : Integer;
      ShowMessageResponseID@1005 : Integer;
    BEGIN
      SentForApprovalEventID := InsertEntryPointEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnSendSalesDocForApprovalCode);
      InsertEventArgument(SentForApprovalEventID,DocSentForApprovalConditionString);

      CheckCustomerCreditLimitResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CheckCustomerCreditLimitCode,
          SentForApprovalEventID);

      CustomerCreditLimitExceededEventID := InsertEventStep(Workflow,
          WorkflowEventHandling.RunWorkflowOnCustomerCreditLimitExceededCode,CheckCustomerCreditLimitResponseID);

      SetStatusToPendingApprovalResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.SetStatusToPendingApprovalCode,
          CustomerCreditLimitExceededEventID);
      CreateApprovalRequestResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CreateApprovalRequestsCode,
          SetStatusToPendingApprovalResponseID);
      InsertApprovalArgument(CreateApprovalRequestResponseID,
        WorkflowStepArgument."Approver Type",WorkflowStepArgument."Approver Limit Type",
        WorkflowStepArgument."Workflow User Group Code",WorkflowStepArgument."Due Date Formula",ShowConfirmationMessage);
      SendApprovalRequestResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          CreateApprovalRequestResponseID);

      InsertNotificationArgument(SendApprovalRequestResponseID,'',0,'');

      OnAllRequestsApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnAllRequestsApprovedEventID,BuildNoPendingApprovalsConditions);
      InsertResponseStep(Workflow,WorkflowResponseHandling.ReleaseDocumentCode,OnAllRequestsApprovedEventID);

      OnRequestApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnRequestApprovedEventID,BuildPendingApprovalsConditions);
      SendApprovalRequestResponseID2 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestApprovedEventID);

      SetNextStep(Workflow,SendApprovalRequestResponseID2,SendApprovalRequestResponseID);

      OnRequestRejectedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnRejectApprovalRequestCode,
          SendApprovalRequestResponseID);
      RejectAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RejectAllApprovalRequestsCode,
          OnRequestRejectedEventID);
      InsertNotificationArgument(RejectAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');
      InsertResponseStep(Workflow,WorkflowResponseHandling.OpenDocumentCode,RejectAllApprovalsResponseID);

      OnRequestCanceledEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnCancelSalesApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnRequestCanceledEventID,DocCanceledConditionString);
      CancelAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CancelAllApprovalRequestsCode,
          OnRequestCanceledEventID);
      InsertNotificationArgument(CancelAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');
      OpenDocumentResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.OpenDocumentCode,CancelAllApprovalsResponseID);
      ShowMessageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.ShowMessageCode,OpenDocumentResponseID);
      InsertMessageArgument(ShowMessageResponseID,ApprovalRequestCanceledMsg);

      OnRequestDelegatedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnDelegateApprovalRequestCode,
          SendApprovalRequestResponseID);
      SentApprovalRequestResponseID3 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestDelegatedEventID);

      SetNextStep(Workflow,SentApprovalRequestResponseID3,SendApprovalRequestResponseID);

      CustomerCreditLimitNotExceededEventID := InsertEventStep(Workflow,
          WorkflowEventHandling.RunWorkflowOnCustomerCreditLimitNotExceededCode,CheckCustomerCreditLimitResponseID);

      SetStatusToPendingApprovalResponseID2 := InsertResponseStep(Workflow,WorkflowResponseHandling.SetStatusToPendingApprovalCode,
          CustomerCreditLimitNotExceededEventID);

      CreateAndApproveApprovalRequestResponseID := InsertResponseStep(Workflow,
          WorkflowResponseHandling.CreateAndApproveApprovalRequestAutomaticallyCode,SetStatusToPendingApprovalResponseID2);
      InsertResponseStep(Workflow,WorkflowResponseHandling.ReleaseDocumentCode,
        CreateAndApproveApprovalRequestResponseID);
    END;

    LOCAL PROCEDURE InsertOverdueApprovalsWorkflowTemplate@111();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,OverdueWorkflowCodeTxt,OverdueWorkflowDescTxt,AdminCategoryTxt);
      InsertOverdueApprovalsWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    PROCEDURE InsertOverdueApprovalsWorkflow@18() : Code[20];
    VAR
      Workflow@1002 : Record 1501;
    BEGIN
      InsertWorkflow(Workflow,GetWorkflowCode(OverdueWorkflowCodeTxt),OverdueWorkflowDescTxt,AdminCategoryTxt);
      InsertOverdueApprovalsWorkflowDetails(Workflow);
      EXIT(Workflow.Code);
    END;

    LOCAL PROCEDURE InsertOverdueApprovalsWorkflowDetails@122(VAR Workflow@1002 : Record 1501);
    VAR
      OnSendOverdueNotificationsEventID@1003 : Integer;
    BEGIN
      OnSendOverdueNotificationsEventID :=
        InsertEntryPointEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnSendOverdueNotificationsCode);
      InsertResponseStep(Workflow,WorkflowResponseHandling.CreateOverdueNotificationCode,OnSendOverdueNotificationsEventID);
    END;

    LOCAL PROCEDURE InsertCustomerApprovalWorkflowTemplate@115();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,CustomerApprWorkflowCodeTxt,CustomerApprWorkflowDescTxt,SalesMktCategoryTxt);
      InsertCustomerApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    PROCEDURE InsertCustomerApprovalWorkflow@78();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflow(Workflow,GetWorkflowCode(CustomerApprWorkflowCodeTxt),CustomerApprWorkflowDescTxt,SalesMktCategoryTxt);
      InsertCustomerApprovalWorkflowDetails(Workflow);
    END;

    LOCAL PROCEDURE InsertCustomerApprovalWorkflowDetails@125(VAR Workflow@1000 : Record 1501);
    VAR
      WorkflowStepArgument@1004 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::Approver,WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertRecApprovalWorkflowSteps(Workflow,BuildCustomerTypeConditions,
        WorkflowEventHandling.RunWorkflowOnSendCustomerForApprovalCode,
        WorkflowResponseHandling.CreateApprovalRequestsCode,
        WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
        WorkflowEventHandling.RunWorkflowOnCancelCustomerApprovalRequestCode,
        WorkflowStepArgument,
        TRUE,TRUE);
    END;

    LOCAL PROCEDURE InsertCustomerCreditLimitChangeApprovalWorkflowTemplate@121();
    VAR
      Workflow@1000 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,CustomerCredLmtChangeApprWorkflowCodeTxt,
        CustomerCredLmtChangeApprWorkflowDescTxt,SalesMktCategoryTxt);
      InsertCustomerCreditLimitChangeApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertCustomerCreditLimitChangeApprovalWorkflowDetails@114(VAR Workflow@1000 : Record 1501);
    VAR
      Customer@1001 : Record 18;
      WorkflowRule@1002 : Record 1524;
      WorkflowStepArgument@1004 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::"Workflow User Group",WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,FALSE);

      InsertRecChangedApprovalWorkflowSteps(Workflow,WorkflowRule.Operator::Increased,
        WorkflowEventHandling.RunWorkflowOnCustomerChangedCode,
        WorkflowResponseHandling.CreateApprovalRequestsCode,
        WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
        WorkflowStepArgument,DATABASE::Customer,Customer.FIELDNO("Credit Limit (LCY)"),
        CustCredLmtChangeSentForAppTxt);
    END;

    LOCAL PROCEDURE InsertGeneralJournalBatchApprovalWorkflowTemplate@2();
    VAR
      Workflow@1002 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,GeneralJournalBatchApprWorkflowCodeTxt,
        GeneralJournalBatchApprWorkflowDescTxt,FinCategoryTxt);
      InsertGeneralJournalBatchApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertGeneralJournalBatchApprovalWorkflowDetails@15(VAR Workflow@1000 : Record 1501);
    VAR
      WorkflowStepArgument@1004 : Record 1523;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::Approver,WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,TRUE);

      InsertGenJnlBatchApprovalWorkflowSteps(Workflow,BuildGeneralJournalBatchTypeConditions,
        WorkflowEventHandling.RunWorkflowOnSendGeneralJournalBatchForApprovalCode,
        WorkflowResponseHandling.CreateApprovalRequestsCode,
        WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
        WorkflowEventHandling.RunWorkflowOnCancelGeneralJournalBatchApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertGeneralJournalLineApprovalWorkflowTemplate@32();
    VAR
      Workflow@1002 : Record 1501;
    BEGIN
      InsertWorkflowTemplate(Workflow,GeneralJournalLineApprWorkflowCodeTxt,
        GeneralJournalLineApprWorkflowDescTxt,FinCategoryTxt);
      InsertGeneralJournalLineApprovalWorkflowDetails(Workflow);
      MarkWorkflowAsTemplate(Workflow);
    END;

    LOCAL PROCEDURE InsertGeneralJournalLineApprovalWorkflowDetails@31(VAR Workflow@1000 : Record 1501);
    VAR
      WorkflowStepArgument@1004 : Record 1523;
      GenJournalLine@1001 : Record 81;
    BEGIN
      PopulateWorkflowStepArgument(WorkflowStepArgument,
        WorkflowStepArgument."Approver Type"::Approver,WorkflowStepArgument."Approver Limit Type"::"Direct Approver",
        0,'',BlankDateFormula,FALSE);

      GenJournalLine.INIT;
      InsertRecApprovalWorkflowSteps(Workflow,BuildGeneralJournalLineTypeConditions(GenJournalLine),
        WorkflowEventHandling.RunWorkflowOnSendGeneralJournalLineForApprovalCode,
        WorkflowResponseHandling.CreateApprovalRequestsCode,
        WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
        WorkflowEventHandling.RunWorkflowOnCancelGeneralJournalLineApprovalRequestCode,
        WorkflowStepArgument,
        FALSE,FALSE);
    END;

    PROCEDURE IncomingDocumentWorkflowCode@3() : Code[17];
    BEGIN
      EXIT(IncDocWorkflowCodeTxt);
    END;

    PROCEDURE IncomingDocumentApprovalWorkflowCode@184() : Code[17];
    BEGIN
      EXIT(IncomingDocumentApprWorkflowCodeTxt);
    END;

    PROCEDURE IncomingDocumentOCRWorkflowCode@146() : Code[17];
    BEGIN
      EXIT(IncDocOCRWorkflowCodeTxt);
    END;

    PROCEDURE PurchaseInvoiceWorkflowCode@9() : Code[17];
    BEGIN
      EXIT(PurchInvWorkflowCodeTxt);
    END;

    PROCEDURE PurchaseInvoiceApprovalWorkflowCode@11() : Code[17];
    BEGIN
      EXIT(PurchInvoiceApprWorkflowCodeTxt);
    END;

    PROCEDURE PurchaseBlanketOrderApprovalWorkflowCode@38() : Code[17];
    BEGIN
      EXIT(PurchBlanketOrderApprWorkflowCodeTxt);
    END;

    PROCEDURE PurchaseCreditMemoApprovalWorkflowCode@39() : Code[17];
    BEGIN
      EXIT(PurchCreditMemoApprWorkflowCodeTxt);
    END;

    PROCEDURE PurchaseQuoteApprovalWorkflowCode@40() : Code[17];
    BEGIN
      EXIT(PurchQuoteApprWorkflowCodeTxt);
    END;

    PROCEDURE PurchaseOrderApprovalWorkflowCode@45() : Code[17];
    BEGIN
      EXIT(PurchOrderApprWorkflowCodeTxt);
    END;

    PROCEDURE PurchaseReturnOrderApprovalWorkflowCode@46() : Code[17];
    BEGIN
      EXIT(PurchReturnOrderApprWorkflowCodeTxt);
    END;

    PROCEDURE SalesInvoiceApprovalWorkflowCode@48() : Code[17];
    BEGIN
      EXIT(SalesInvoiceApprWorkflowCodeTxt);
    END;

    PROCEDURE SalesBlanketOrderApprovalWorkflowCode@47() : Code[17];
    BEGIN
      EXIT(SalesBlanketOrderApprWorkflowCodeTxt);
    END;

    PROCEDURE SalesCreditMemoApprovalWorkflowCode@29() : Code[17];
    BEGIN
      EXIT(SalesCreditMemoApprWorkflowCodeTxt);
    END;

    PROCEDURE SalesQuoteApprovalWorkflowCode@28() : Code[17];
    BEGIN
      EXIT(SalesQuoteApprWorkflowCodeTxt);
    END;

    PROCEDURE SalesOrderApprovalWorkflowCode@27() : Code[17];
    BEGIN
      EXIT(SalesOrderApprWorkflowCodeTxt);
    END;

    PROCEDURE SalesReturnOrderApprovalWorkflowCode@26() : Code[17];
    BEGIN
      EXIT(SalesReturnOrderApprWorkflowCodeTxt);
    END;

    PROCEDURE OverdueNotificationsWorkflowCode@20() : Code[17];
    BEGIN
      EXIT(OverdueWorkflowCodeTxt);
    END;

    PROCEDURE SalesInvoiceCreditLimitApprovalWorkflowCode@25() : Code[17];
    BEGIN
      EXIT(SalesInvoiceCreditLimitApprWorkflowCodeTxt);
    END;

    PROCEDURE SalesOrderCreditLimitApprovalWorkflowCode@49() : Code[17];
    BEGIN
      EXIT(SalesOrderCreditLimitApprWorkflowCodeTxt);
    END;

    PROCEDURE CustomerWorkflowCode@75() : Code[17];
    BEGIN
      EXIT(CustomerApprWorkflowCodeTxt);
    END;

    PROCEDURE CustomerCreditLimitChangeApprovalWorkflowCode@132() : Code[17];
    BEGIN
      EXIT(CustomerCredLmtChangeApprWorkflowCodeTxt);
    END;

    PROCEDURE GeneralJournalBatchApprovalWorkflowCode@4() : Code[17];
    BEGIN
      EXIT(GeneralJournalBatchApprWorkflowCodeTxt);
    END;

    PROCEDURE GeneralJournalLineApprovalWorkflowCode@6() : Code[17];
    BEGIN
      EXIT(GeneralJournalLineApprWorkflowCodeTxt);
    END;

    PROCEDURE SendToOCRWorkflowCode@180() : Code[17];
    BEGIN
      EXIT(SendToOCRWorkflowCodeTxt);
    END;

    PROCEDURE InsertDocApprovalWorkflowSteps@7(Workflow@1003 : Record 1501;DocSendForApprovalConditionString@1006 : Text;DocSendForApprovalEventCode@1001 : Code[128];DocCanceledConditionString@1009 : Text;DocCanceledEventCode@1004 : Code[128];WorkflowStepArgument@1000 : Record 1523;ShowConfirmationMessage@1019 : Boolean);
    VAR
      SentForApprovalEventID@1010 : Integer;
      SetStatusToPendingApprovalResponseID@1002 : Integer;
      CreateApprovalRequestResponseID@1012 : Integer;
      SendApprovalRequestResponseID@1013 : Integer;
      OnAllRequestsApprovedEventID@1014 : Integer;
      OnRequestApprovedEventID@1016 : Integer;
      SendApprovalRequestResponseID2@1017 : Integer;
      OnRequestRejectedEventID@1018 : Integer;
      RejectAllApprovalsResponseID@1020 : Integer;
      OnRequestCanceledEventID@1022 : Integer;
      CancelAllApprovalsResponseID@1023 : Integer;
      OnRequestDelegatedEventID@1025 : Integer;
      SentApprovalRequestResponseID3@1026 : Integer;
      RestrictRecordUsageResponseID@1005 : Integer;
      AllowRecordUsageResponseID@1008 : Integer;
      OpenDocumentResponceID@1011 : Integer;
      ShowMessageResponseID@1015 : Integer;
    BEGIN
      SentForApprovalEventID := InsertEntryPointEventStep(Workflow,DocSendForApprovalEventCode);
      InsertEventArgument(SentForApprovalEventID,DocSendForApprovalConditionString);

      RestrictRecordUsageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RestrictRecordUsageCode,
          SentForApprovalEventID);
      SetStatusToPendingApprovalResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.SetStatusToPendingApprovalCode,
          RestrictRecordUsageResponseID);
      CreateApprovalRequestResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CreateApprovalRequestsCode,
          SetStatusToPendingApprovalResponseID);
      InsertApprovalArgument(CreateApprovalRequestResponseID,
        WorkflowStepArgument."Approver Type",WorkflowStepArgument."Approver Limit Type",
        WorkflowStepArgument."Workflow User Group Code",WorkflowStepArgument."Due Date Formula",ShowConfirmationMessage);
      SendApprovalRequestResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          CreateApprovalRequestResponseID);
      InsertNotificationArgument(SendApprovalRequestResponseID,'',0,'');

      OnAllRequestsApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnAllRequestsApprovedEventID,BuildNoPendingApprovalsConditions);
      AllowRecordUsageResponseID :=
        InsertResponseStep(Workflow,WorkflowResponseHandling.AllowRecordUsageCode,OnAllRequestsApprovedEventID);
      InsertResponseStep(Workflow,WorkflowResponseHandling.ReleaseDocumentCode,AllowRecordUsageResponseID);

      OnRequestApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnRequestApprovedEventID,BuildPendingApprovalsConditions);
      SendApprovalRequestResponseID2 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestApprovedEventID);

      SetNextStep(Workflow,SendApprovalRequestResponseID2,SendApprovalRequestResponseID);

      OnRequestRejectedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnRejectApprovalRequestCode,
          SendApprovalRequestResponseID);
      RejectAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RejectAllApprovalRequestsCode,
          OnRequestRejectedEventID);
      InsertNotificationArgument(RejectAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');
      InsertResponseStep(Workflow,WorkflowResponseHandling.OpenDocumentCode,RejectAllApprovalsResponseID);

      OnRequestCanceledEventID := InsertEventStep(Workflow,DocCanceledEventCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnRequestCanceledEventID,DocCanceledConditionString);
      CancelAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CancelAllApprovalRequestsCode,
          OnRequestCanceledEventID);
      InsertNotificationArgument(CancelAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');
      AllowRecordUsageResponseID :=
        InsertResponseStep(Workflow,WorkflowResponseHandling.AllowRecordUsageCode,CancelAllApprovalsResponseID);
      OpenDocumentResponceID := InsertResponseStep(Workflow,WorkflowResponseHandling.OpenDocumentCode,AllowRecordUsageResponseID);
      ShowMessageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.ShowMessageCode,OpenDocumentResponceID);
      InsertMessageArgument(ShowMessageResponseID,ApprovalRequestCanceledMsg);

      OnRequestDelegatedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnDelegateApprovalRequestCode,
          SendApprovalRequestResponseID);
      SentApprovalRequestResponseID3 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestDelegatedEventID);

      SetNextStep(Workflow,SentApprovalRequestResponseID3,SendApprovalRequestResponseID);
    END;

    PROCEDURE InsertRecApprovalWorkflowSteps@76(Workflow@1003 : Record 1501;ConditionString@1006 : Text;RecSendForApprovalEventCode@1001 : Code[128];RecCreateApprovalRequestsCode@1005 : Code[128];RecSendApprovalRequestForApprovalCode@1007 : Code[128];RecCanceledEventCode@1004 : Code[128];WorkflowStepArgument@1000 : Record 1523;ShowConfirmationMessage@1009 : Boolean;RemoveRestrictionOnCancel@1019 : Boolean);
    VAR
      SentForApprovalEventID@1010 : Integer;
      CreateApprovalRequestResponseID@1012 : Integer;
      SendApprovalRequestResponseID@1013 : Integer;
      OnAllRequestsApprovedEventID@1014 : Integer;
      OnRequestApprovedEventID@1016 : Integer;
      SendApprovalRequestResponseID2@1017 : Integer;
      OnRequestRejectedEventID@1018 : Integer;
      RejectAllApprovalsResponseID@1020 : Integer;
      OnRequestCanceledEventID@1022 : Integer;
      CancelAllApprovalsResponseID@1023 : Integer;
      OnRequestDelegatedEventID@1025 : Integer;
      SentApprovalRequestResponseID3@1026 : Integer;
      RestrictUsageResponseID@1008 : Integer;
      AllowRecordUsageResponseID@1011 : Integer;
      ShowMessageResponseID@1015 : Integer;
      TempResponseResponseID@1021 : Integer;
    BEGIN
      SentForApprovalEventID := InsertEntryPointEventStep(Workflow,RecSendForApprovalEventCode);
      InsertEventArgument(SentForApprovalEventID,ConditionString);

      RestrictUsageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RestrictRecordUsageCode,
          SentForApprovalEventID);
      CreateApprovalRequestResponseID := InsertResponseStep(Workflow,RecCreateApprovalRequestsCode,
          RestrictUsageResponseID);
      InsertApprovalArgument(CreateApprovalRequestResponseID,
        WorkflowStepArgument."Approver Type",WorkflowStepArgument."Approver Limit Type",
        WorkflowStepArgument."Workflow User Group Code",WorkflowStepArgument."Due Date Formula",ShowConfirmationMessage);
      SendApprovalRequestResponseID := InsertResponseStep(Workflow,RecSendApprovalRequestForApprovalCode,
          CreateApprovalRequestResponseID);
      InsertNotificationArgument(SendApprovalRequestResponseID,'',0,'');

      OnAllRequestsApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnAllRequestsApprovedEventID,BuildNoPendingApprovalsConditions);
      InsertResponseStep(Workflow,WorkflowResponseHandling.AllowRecordUsageCode,OnAllRequestsApprovedEventID);

      OnRequestApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnRequestApprovedEventID,BuildPendingApprovalsConditions);
      SendApprovalRequestResponseID2 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestApprovedEventID);

      SetNextStep(Workflow,SendApprovalRequestResponseID2,SendApprovalRequestResponseID);

      OnRequestRejectedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnRejectApprovalRequestCode,
          SendApprovalRequestResponseID);
      RejectAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RejectAllApprovalRequestsCode,
          OnRequestRejectedEventID);
      InsertNotificationArgument(RejectAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');

      OnRequestCanceledEventID := InsertEventStep(Workflow,RecCanceledEventCode,SendApprovalRequestResponseID);
      CancelAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CancelAllApprovalRequestsCode,
          OnRequestCanceledEventID);
      InsertNotificationArgument(CancelAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');

      TempResponseResponseID := CancelAllApprovalsResponseID;
      IF RemoveRestrictionOnCancel THEN BEGIN
        AllowRecordUsageResponseID :=
          InsertResponseStep(Workflow,WorkflowResponseHandling.AllowRecordUsageCode,CancelAllApprovalsResponseID);
        TempResponseResponseID := AllowRecordUsageResponseID;
      END;
      IF ShowConfirmationMessage THEN BEGIN
        ShowMessageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.ShowMessageCode,TempResponseResponseID);
        InsertMessageArgument(ShowMessageResponseID,ApprovalRequestCanceledMsg);
      END;

      OnRequestDelegatedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnDelegateApprovalRequestCode,
          SendApprovalRequestResponseID);
      SentApprovalRequestResponseID3 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestDelegatedEventID);

      SetNextStep(Workflow,SentApprovalRequestResponseID3,SendApprovalRequestResponseID);
    END;

    PROCEDURE InsertRecChangedApprovalWorkflowSteps@135(Workflow@1003 : Record 1501;RuleOperator@1006 : Option;RecChangedEventCode@1001 : Code[128];RecCreateApprovalRequestsCode@1005 : Code[128];RecSendApprovalRequestForApprovalCode@1007 : Code[128];VAR WorkflowStepArgument@1000 : Record 1523;TableNo@1024 : Integer;FieldNo@1027 : Integer;RecordChangeApprovalMsg@1019 : Text);
    VAR
      CustomerChangedEventID@1010 : Integer;
      RevertFieldResponseID@1002 : Integer;
      CreateApprovalRequestResponseID@1012 : Integer;
      SendApprovalRequestResponseID@1013 : Integer;
      OnAllRequestsApprovedEventID@1014 : Integer;
      OnRequestApprovedEventID@1016 : Integer;
      SendApprovalRequestResponseID2@1017 : Integer;
      OnRequestRejectedEventID@1018 : Integer;
      RejectAllApprovalsResponseID@1020 : Integer;
      DiscardNewValuesResponseID@1008 : Integer;
      OnRequestDelegatedEventID@1025 : Integer;
      SentApprovalRequestResponseID3@1026 : Integer;
      ShowMessageResponseID@1015 : Integer;
      ApplyNewValuesResponseID@1011 : Integer;
    BEGIN
      CustomerChangedEventID := InsertEntryPointEventStep(Workflow,RecChangedEventCode);
      InsertEventRule(CustomerChangedEventID,FieldNo,RuleOperator);

      RevertFieldResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RevertValueForFieldCode,
          CustomerChangedEventID);
      InsertChangeRecValueArgument(RevertFieldResponseID,TableNo,FieldNo);
      CreateApprovalRequestResponseID := InsertResponseStep(Workflow,RecCreateApprovalRequestsCode,
          RevertFieldResponseID);
      InsertApprovalArgument(CreateApprovalRequestResponseID,WorkflowStepArgument."Approver Type",
        WorkflowStepArgument."Approver Limit Type",WorkflowStepArgument."Workflow User Group Code",
        WorkflowStepArgument."Due Date Formula",FALSE);
      SendApprovalRequestResponseID := InsertResponseStep(Workflow,RecSendApprovalRequestForApprovalCode,
          CreateApprovalRequestResponseID);
      InsertNotificationArgument(SendApprovalRequestResponseID,'',0,'');
      ShowMessageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.ShowMessageCode,
          SendApprovalRequestResponseID);
      InsertMessageArgument(ShowMessageResponseID,COPYSTR(RecordChangeApprovalMsg,1,250));

      OnAllRequestsApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          ShowMessageResponseID);
      InsertEventArgument(OnAllRequestsApprovedEventID,BuildNoPendingApprovalsConditions);
      ApplyNewValuesResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.ApplyNewValuesCode,
          OnAllRequestsApprovedEventID);
      InsertChangeRecValueArgument(ApplyNewValuesResponseID,TableNo,FieldNo);

      OnRequestApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          ShowMessageResponseID);
      InsertEventArgument(OnRequestApprovedEventID,BuildPendingApprovalsConditions);
      SendApprovalRequestResponseID2 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestApprovedEventID);

      SetNextStep(Workflow,SendApprovalRequestResponseID2,ShowMessageResponseID);

      OnRequestRejectedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnRejectApprovalRequestCode,
          ShowMessageResponseID);
      DiscardNewValuesResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.DiscardNewValuesCode,
          OnRequestRejectedEventID);
      RejectAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RejectAllApprovalRequestsCode,
          DiscardNewValuesResponseID);
      InsertNotificationArgument(RejectAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');

      OnRequestDelegatedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnDelegateApprovalRequestCode,
          ShowMessageResponseID);
      SentApprovalRequestResponseID3 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestDelegatedEventID);

      SetNextStep(Workflow,SentApprovalRequestResponseID3,ShowMessageResponseID);
    END;

    PROCEDURE InsertGenJnlBatchApprovalWorkflowSteps@8(Workflow@1003 : Record 1501;ConditionString@1006 : Text;RecSendForApprovalEventCode@1001 : Code[128];RecCreateApprovalRequestsCode@1005 : Code[128];RecSendApprovalRequestForApprovalCode@1007 : Code[128];RecCanceledEventCode@1004 : Code[128];WorkflowStepArgument@1000 : Record 1523;ShowConfirmationMessage@1024 : Boolean);
    VAR
      SentForApprovalEventID@1010 : Integer;
      CheckBatchBalanceResponseID@1008 : Integer;
      OnBatchIsBalancedEventID@1009 : Integer;
      OnBatchIsNotBalancedEventID@1011 : Integer;
      CreateApprovalRequestResponseID@1012 : Integer;
      SendApprovalRequestResponseID@1013 : Integer;
      OnAllRequestsApprovedEventID@1014 : Integer;
      OnRequestApprovedEventID@1016 : Integer;
      SendApprovalRequestResponseID2@1017 : Integer;
      OnRequestRejectedEventID@1018 : Integer;
      RejectAllApprovalsResponseID@1020 : Integer;
      OnRequestCanceledEventID@1022 : Integer;
      CancelAllApprovalsResponseID@1023 : Integer;
      OnRequestDelegatedEventID@1025 : Integer;
      SentApprovalRequestResponseID3@1026 : Integer;
      ShowMessageResponseID@1015 : Integer;
      RestrictUsageResponseID@1019 : Integer;
      AllowRecordUsageResponseID@1021 : Integer;
    BEGIN
      SentForApprovalEventID := InsertEntryPointEventStep(Workflow,RecSendForApprovalEventCode);
      InsertEventArgument(SentForApprovalEventID,ConditionString);

      CheckBatchBalanceResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CheckGeneralJournalBatchBalanceCode,
          SentForApprovalEventID);

      OnBatchIsBalancedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnGeneralJournalBatchBalancedCode,
          CheckBatchBalanceResponseID);

      RestrictUsageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RestrictRecordUsageCode,
          OnBatchIsBalancedEventID);
      CreateApprovalRequestResponseID := InsertResponseStep(Workflow,RecCreateApprovalRequestsCode,
          RestrictUsageResponseID);
      InsertApprovalArgument(CreateApprovalRequestResponseID,
        WorkflowStepArgument."Approver Type",WorkflowStepArgument."Approver Limit Type",
        WorkflowStepArgument."Workflow User Group Code",WorkflowStepArgument."Due Date Formula",ShowConfirmationMessage);
      SendApprovalRequestResponseID := InsertResponseStep(Workflow,RecSendApprovalRequestForApprovalCode,
          CreateApprovalRequestResponseID);
      InsertNotificationArgument(SendApprovalRequestResponseID,'',0,'');

      OnAllRequestsApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnAllRequestsApprovedEventID,BuildNoPendingApprovalsConditions);
      InsertResponseStep(Workflow,WorkflowResponseHandling.AllowRecordUsageCode,OnAllRequestsApprovedEventID);

      OnRequestApprovedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnApproveApprovalRequestCode,
          SendApprovalRequestResponseID);
      InsertEventArgument(OnRequestApprovedEventID,BuildPendingApprovalsConditions);
      SendApprovalRequestResponseID2 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestApprovedEventID);

      SetNextStep(Workflow,SendApprovalRequestResponseID2,SendApprovalRequestResponseID);

      OnRequestRejectedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnRejectApprovalRequestCode,
          SendApprovalRequestResponseID);
      RejectAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.RejectAllApprovalRequestsCode,
          OnRequestRejectedEventID);
      InsertNotificationArgument(RejectAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');

      OnRequestCanceledEventID := InsertEventStep(Workflow,RecCanceledEventCode,SendApprovalRequestResponseID);
      CancelAllApprovalsResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.CancelAllApprovalRequestsCode,
          OnRequestCanceledEventID);
      InsertNotificationArgument(CancelAllApprovalsResponseID,'',WorkflowStepArgument."Link Target Page",'');
      AllowRecordUsageResponseID :=
        InsertResponseStep(Workflow,WorkflowResponseHandling.AllowRecordUsageCode,CancelAllApprovalsResponseID);
      ShowMessageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.ShowMessageCode,AllowRecordUsageResponseID);
      InsertMessageArgument(ShowMessageResponseID,ApprovalRequestCanceledMsg);

      OnRequestDelegatedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnDelegateApprovalRequestCode,
          SendApprovalRequestResponseID);
      SentApprovalRequestResponseID3 := InsertResponseStep(Workflow,WorkflowResponseHandling.SendApprovalRequestForApprovalCode,
          OnRequestDelegatedEventID);

      SetNextStep(Workflow,SentApprovalRequestResponseID3,SendApprovalRequestResponseID);

      OnBatchIsNotBalancedEventID := InsertEventStep(Workflow,WorkflowEventHandling.RunWorkflowOnGeneralJournalBatchNotBalancedCode,
          CheckBatchBalanceResponseID);

      ShowMessageResponseID := InsertResponseStep(Workflow,WorkflowResponseHandling.ShowMessageCode,OnBatchIsNotBalancedEventID);
      InsertMessageArgument(ShowMessageResponseID,GeneralJournalBatchIsNotBalancedMsg);
    END;

    PROCEDURE InsertPurchaseDocumentApprovalWorkflow@69(VAR Workflow@1001 : Record 1501;DocumentType@1002 : Option;ApproverType@1004 : Option;LimitType@1005 : Option;WorkflowUserGroupCode@1006 : Code[20];DueDateFormula@1003 : DateFormula);
    VAR
      PurchaseHeader@1000 : Record 38;
      WorkflowStepArgument@1007 : Record 1523;
    BEGIN
      CASE DocumentType OF
        PurchaseHeader."Document Type"::Order:
          InsertWorkflow(Workflow,GetWorkflowCode(PurchOrderApprWorkflowCodeTxt),PurchOrderApprWorkflowDescTxt,PurchDocCategoryTxt);
        PurchaseHeader."Document Type"::Invoice:
          InsertWorkflow(
            Workflow,GetWorkflowCode(PurchInvoiceApprWorkflowCodeTxt),PurchInvoiceApprWorkflowDescTxt,PurchDocCategoryTxt);
        PurchaseHeader."Document Type"::"Return Order":
          InsertWorkflow(Workflow,GetWorkflowCode(PurchReturnOrderApprWorkflowCodeTxt),
            PurchReturnOrderApprWorkflowDescTxt,PurchDocCategoryTxt);
        PurchaseHeader."Document Type"::"Credit Memo":
          InsertWorkflow(Workflow,GetWorkflowCode(PurchCreditMemoApprWorkflowCodeTxt),
            PurchCreditMemoApprWorkflowDescTxt,PurchDocCategoryTxt);
        PurchaseHeader."Document Type"::Quote:
          InsertWorkflow(Workflow,GetWorkflowCode(PurchQuoteApprWorkflowCodeTxt),PurchQuoteApprWorkflowDescTxt,PurchDocCategoryTxt);
        PurchaseHeader."Document Type"::"Blanket Order":
          InsertWorkflow(Workflow,GetWorkflowCode(PurchBlanketOrderApprWorkflowCodeTxt),
            PurchBlanketOrderApprWorkflowDescTxt,PurchDocCategoryTxt);
      END;

      PopulateWorkflowStepArgument(WorkflowStepArgument,ApproverType,LimitType,0,
        WorkflowUserGroupCode,DueDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,BuildPurchHeaderTypeConditions(DocumentType,PurchaseHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendPurchaseDocForApprovalCode,
        BuildPurchHeaderTypeConditions(DocumentType,PurchaseHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelPurchaseApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    PROCEDURE InsertSalesDocumentApprovalWorkflow@57(VAR Workflow@1001 : Record 1501;DocumentType@1002 : Option;ApproverType@1004 : Option;LimitType@1005 : Option;WorkflowUserGroupCode@1006 : Code[20];DueDateFormula@1003 : DateFormula);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1007 : Record 1523;
    BEGIN
      CASE DocumentType OF
        SalesHeader."Document Type"::Order:
          InsertWorkflow(Workflow,GetWorkflowCode(SalesOrderApprWorkflowCodeTxt),SalesOrderApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::Invoice:
          InsertWorkflow(Workflow,GetWorkflowCode(SalesInvoiceApprWorkflowCodeTxt),
            SalesInvoiceApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::"Return Order":
          InsertWorkflow(Workflow,GetWorkflowCode(SalesReturnOrderApprWorkflowCodeTxt),
            SalesReturnOrderApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::"Credit Memo":
          InsertWorkflow(Workflow,GetWorkflowCode(SalesCreditMemoApprWorkflowCodeTxt),
            SalesCreditMemoApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::Quote:
          InsertWorkflow(Workflow,GetWorkflowCode(SalesQuoteApprWorkflowCodeTxt),SalesQuoteApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::"Blanket Order":
          InsertWorkflow(Workflow,GetWorkflowCode(SalesBlanketOrderApprWorkflowCodeTxt),
            SalesBlanketOrderApprWorkflowDescTxt,SalesDocCategoryTxt);
      END;

      PopulateWorkflowStepArgument(WorkflowStepArgument,ApproverType,LimitType,0,
        WorkflowUserGroupCode,DueDateFormula,TRUE);

      InsertDocApprovalWorkflowSteps(Workflow,BuildSalesHeaderTypeConditions(DocumentType,SalesHeader.Status::Open),
        WorkflowEventHandling.RunWorkflowOnSendSalesDocForApprovalCode,
        BuildSalesHeaderTypeConditions(DocumentType,SalesHeader.Status::"Pending Approval"),
        WorkflowEventHandling.RunWorkflowOnCancelSalesApprovalRequestCode,
        WorkflowStepArgument,TRUE);
    END;

    PROCEDURE InsertSalesDocumentCreditLimitApprovalWorkflow@53(VAR Workflow@1001 : Record 1501;DocumentType@1002 : Option;ApproverType@1004 : Option;LimitType@1005 : Option;WorkflowUserGroupCode@1006 : Code[20];DueDateFormula@1003 : DateFormula);
    VAR
      SalesHeader@1000 : Record 36;
      WorkflowStepArgument@1007 : Record 1523;
    BEGIN
      CASE DocumentType OF
        SalesHeader."Document Type"::Order:
          InsertWorkflow(Workflow,GetWorkflowCode(SalesOrderCreditLimitApprWorkflowCodeTxt),
            SalesOrderCreditLimitApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::Invoice:
          InsertWorkflow(Workflow,GetWorkflowCode(SalesInvoiceCreditLimitApprWorkflowCodeTxt),
            SalesInvoiceCreditLimitApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::"Return Order":
          InsertWorkflow(Workflow,GetWorkflowCode(SalesRetOrderCrLimitApprWorkflowCodeTxt),
            SalesRetOrderCrLimitApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::"Credit Memo":
          InsertWorkflow(Workflow,GetWorkflowCode(SalesCrMemoCrLimitApprWorkflowCodeTxt),
            SalesCrMemoCrLimitApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::Quote:
          InsertWorkflow(Workflow,GetWorkflowCode(SalesQuoteCrLimitApprWorkflowCodeTxt),
            SalesQuoteCrLimitApprWorkflowDescTxt,SalesDocCategoryTxt);
        SalesHeader."Document Type"::"Blanket Order":
          InsertWorkflow(Workflow,GetWorkflowCode(SalesBlanketOrderCrLimitApprWorkflowCodeTxt),
            SalesBlanketOrderCrLimitApprWorkflowDescTxt,SalesDocCategoryTxt);
      END;

      PopulateWorkflowStepArgument(WorkflowStepArgument,ApproverType,LimitType,0,
        WorkflowUserGroupCode,DueDateFormula,TRUE);

      InsertSalesDocWithCreditLimitApprovalWorkflowSteps(Workflow,
        BuildSalesHeaderTypeConditions(DocumentType,SalesHeader.Status::Open),
        BuildSalesHeaderTypeConditions(DocumentType,SalesHeader.Status::"Pending Approval"),WorkflowStepArgument,TRUE);
    END;

    LOCAL PROCEDURE InsertEntryPointEventStep@51(Workflow@1000 : Record 1501;FunctionName@1001 : Code[128]) : Integer;
    VAR
      WorkflowStep@1003 : Record 1502;
    BEGIN
      InsertStep(WorkflowStep,Workflow.Code,WorkflowStep.Type::"Event",FunctionName);
      WorkflowStep.VALIDATE("Entry Point",TRUE);
      WorkflowStep.MODIFY(TRUE);
      EXIT(WorkflowStep.ID);
    END;

    LOCAL PROCEDURE InsertEventStep@12(Workflow@1000 : Record 1501;FunctionName@1001 : Code[128];PreviousStepID@1002 : Integer) : Integer;
    VAR
      WorkflowStep@1003 : Record 1502;
    BEGIN
      InsertStep(WorkflowStep,Workflow.Code,WorkflowStep.Type::"Event",FunctionName);
      WorkflowStep."Sequence No." := GetSequenceNumber(Workflow,PreviousStepID);
      WorkflowStep.VALIDATE("Previous Workflow Step ID",PreviousStepID);
      WorkflowStep.MODIFY(TRUE);
      EXIT(WorkflowStep.ID);
    END;

    LOCAL PROCEDURE InsertResponseStep@13(Workflow@1001 : Record 1501;FunctionName@1000 : Code[128];PreviousStepID@1002 : Integer) : Integer;
    VAR
      WorkflowStep@1003 : Record 1502;
    BEGIN
      InsertStep(WorkflowStep,Workflow.Code,WorkflowStep.Type::Response,FunctionName);
      WorkflowStep."Sequence No." := GetSequenceNumber(Workflow,PreviousStepID);
      WorkflowStep.VALIDATE("Previous Workflow Step ID",PreviousStepID);
      WorkflowStep.MODIFY(TRUE);
      EXIT(WorkflowStep.ID);
    END;

    LOCAL PROCEDURE InsertStep@30(VAR WorkflowStep@1000 : Record 1502;WorkflowCode@1001 : Code[20];StepType@1003 : Option;FunctionName@1002 : Code[128]);
    BEGIN
      WITH WorkflowStep DO BEGIN
        VALIDATE("Workflow Code",WorkflowCode);
        VALIDATE(Type,StepType);
        VALIDATE("Function Name",FunctionName);
        INSERT(TRUE);
      END;
    END;

    LOCAL PROCEDURE MarkWorkflowAsTemplate@74(VAR Workflow@1000 : Record 1501);
    BEGIN
      Workflow.VALIDATE(Template,TRUE);
      Workflow.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE GetSequenceNumber@22(Workflow@1001 : Record 1501;PreviousStepID@1002 : Integer) : Integer;
    VAR
      WorkflowStep@1000 : Record 1502;
    BEGIN
      WorkflowStep.SETRANGE("Workflow Code",Workflow.Code);
      WorkflowStep.SETRANGE("Previous Workflow Step ID",PreviousStepID);
      IF WorkflowStep.FINDLAST THEN
        EXIT(WorkflowStep."Sequence No." + 1);
    END;

    LOCAL PROCEDURE SetNextStep@34(Workflow@1003 : Record 1501;WorkflowStepID@1001 : Integer;NextStepID@1000 : Integer);
    VAR
      WorkflowStep@1002 : Record 1502;
    BEGIN
      WorkflowStep.GET(Workflow.Code,WorkflowStepID);
      WorkflowStep.VALIDATE("Next Workflow Step ID",NextStepID);
      WorkflowStep.MODIFY(TRUE);
    END;

    PROCEDURE InsertTableRelation@1(TableId@1000 : Integer;FieldId@1001 : Integer;RelatedTableId@1002 : Integer;RelatedFieldId@1003 : Integer);
    VAR
      WorkflowTableRelation@1004 : Record 1505;
    BEGIN
      WorkflowTableRelation.INIT;
      WorkflowTableRelation."Table ID" := TableId;
      WorkflowTableRelation."Field ID" := FieldId;
      WorkflowTableRelation."Related Table ID" := RelatedTableId;
      WorkflowTableRelation."Related Field ID" := RelatedFieldId;
      IF WorkflowTableRelation.INSERT THEN;
    END;

    LOCAL PROCEDURE InsertWorkflowCategory@118(Code@1000 : Code[20];Description@1001 : Text[100]);
    VAR
      WorkflowCategory@1002 : Record 1508;
    BEGIN
      WorkflowCategory.INIT;
      WorkflowCategory.Code := Code;
      WorkflowCategory.Description := Description;
      IF WorkflowCategory.INSERT THEN;
    END;

    LOCAL PROCEDURE InsertEventArgument@41(WorkflowStepID@1000 : Integer;EventConditions@1008 : Text);
    VAR
      WorkflowStep@1001 : Record 1502;
      WorkflowStepArgument@1002 : Record 1523;
    BEGIN
      IF EventConditions = '' THEN
        ERROR(InvalidEventCondErr);

      WorkflowStepArgument.Type := WorkflowStepArgument.Type::"Event";
      WorkflowStepArgument.INSERT(TRUE);
      WorkflowStepArgument.SetEventFilters(EventConditions);

      WorkflowStep.SETRANGE(ID,WorkflowStepID);
      WorkflowStep.FINDFIRST;
      WorkflowStep.Argument := WorkflowStepArgument.ID;
      WorkflowStep.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE InsertEventRule@124(WorkflowStepID@1000 : Integer;FieldNo@1003 : Integer;Operator@1008 : Option);
    VAR
      WorkflowStep@1004 : Record 1502;
      WorkflowRule@1002 : Record 1524;
      WorkflowEvent@1001 : Record 1520;
    BEGIN
      WorkflowStep.SETRANGE(ID,WorkflowStepID);
      WorkflowStep.FINDFIRST;

      WorkflowRule.INIT;
      WorkflowRule."Workflow Code" := WorkflowStep."Workflow Code";
      WorkflowRule."Workflow Step ID" := WorkflowStep.ID;
      WorkflowRule.Operator := Operator;

      IF WorkflowEvent.GET(WorkflowStep."Function Name") THEN
        WorkflowRule."Table ID" := WorkflowEvent."Table ID";
      WorkflowRule."Field No." := FieldNo;
      WorkflowRule.INSERT(TRUE);
    END;

    LOCAL PROCEDURE InsertNotificationArgument@42(WorkflowStepID@1000 : Integer;NotifUserID@1004 : Code[50];LinkTargetPage@1007 : Integer;CustomLink@1003 : Text[250]);
    VAR
      WorkflowStepArgument@1001 : Record 1523;
    BEGIN
      InsertStepArgument(WorkflowStepArgument,WorkflowStepID);

      WorkflowStepArgument."Notification User ID" := NotifUserID;
      WorkflowStepArgument."Link Target Page" := LinkTargetPage;
      WorkflowStepArgument."Custom Link" := CustomLink;
      WorkflowStepArgument.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE InsertPmtLineCreationArgument@43(WorkflowStepID@1004 : Integer;GenJnlTemplateName@1002 : Code[10];GenJnlBatchName@1003 : Code[10]);
    VAR
      WorkflowStepArgument@1000 : Record 1523;
    BEGIN
      InsertStepArgument(WorkflowStepArgument,WorkflowStepID);

      WorkflowStepArgument."General Journal Template Name" := GenJnlTemplateName;
      WorkflowStepArgument."General Journal Batch Name" := GenJnlBatchName;
      WorkflowStepArgument.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE InsertApprovalArgument@44(WorkflowStepID@1000 : Integer;ApproverType@1009 : Option;ApproverLimitType@1010 : Option;WorkflowUserGroupCode@1002 : Code[20];DueDateFormula@1003 : DateFormula;ShowConfirmationMessage@1004 : Boolean);
    VAR
      WorkflowStepArgument@1001 : Record 1523;
    BEGIN
      InsertStepArgument(WorkflowStepArgument,WorkflowStepID);

      WorkflowStepArgument."Approver Type" := ApproverType;
      WorkflowStepArgument."Approver Limit Type" := ApproverLimitType;
      WorkflowStepArgument."Workflow User Group Code" := WorkflowUserGroupCode;
      WorkflowStepArgument."Due Date Formula" := DueDateFormula;
      WorkflowStepArgument."Show Confirmation Message" := ShowConfirmationMessage;
      WorkflowStepArgument.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE InsertMessageArgument@14(WorkflowStepID@1000 : Integer;Message@1002 : Text[250]);
    VAR
      WorkflowStepArgument@1001 : Record 1523;
    BEGIN
      InsertStepArgument(WorkflowStepArgument,WorkflowStepID);

      WorkflowStepArgument.Message := Message;
      WorkflowStepArgument.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE InsertChangeRecValueArgument@130(WorkflowStepID@1000 : Integer;TableNo@1002 : Integer;FieldNo@1003 : Integer);
    VAR
      WorkflowStepArgument@1001 : Record 1523;
    BEGIN
      InsertStepArgument(WorkflowStepArgument,WorkflowStepID);

      WorkflowStepArgument."Table No." := TableNo;
      WorkflowStepArgument."Field No." := FieldNo;
      WorkflowStepArgument.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE InsertStepArgument@19(VAR WorkflowStepArgument@1003 : Record 1523;WorkflowStepID@1000 : Integer);
    VAR
      WorkflowStep@1002 : Record 1502;
    BEGIN
      WorkflowStep.SETRANGE(ID,WorkflowStepID);
      WorkflowStep.FINDFIRST;

      IF WorkflowStepArgument.GET(WorkflowStep.Argument) THEN
        EXIT;

      WorkflowStepArgument.Type := WorkflowStepArgument.Type::Response;
      WorkflowStepArgument.VALIDATE("Response Function Name",WorkflowStep."Function Name");
      WorkflowStepArgument.INSERT(TRUE);

      WorkflowStep.Argument := WorkflowStepArgument.ID;
      WorkflowStep.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE GetWorkflowCode@55(WorkflowCode@1000 : Text) : Code[20];
    VAR
      Workflow@1001 : Record 1501;
    BEGIN
      EXIT(COPYSTR(FORMAT(Workflow.COUNT + 1) + '-' + WorkflowCode,1,MAXSTRLEN(Workflow.Code)));
    END;

    PROCEDURE GetWorkflowTemplateCode@84(WorkflowCode@1000 : Code[17]) : Code[20];
    BEGIN
      EXIT(MsTemplateTok + WorkflowCode);
    END;

    PROCEDURE GetWorkflowTemplateToken@89() : Code[3];
    BEGIN
      EXIT(MsTemplateTok);
    END;

    PROCEDURE SetTemplateForWorkflowStep@70(Workflow@1000 : Record 1501;FunctionName@1005 : Code[128]);
    VAR
      WorkflowStepArgument@1001 : Record 1523;
      WorkflowStep@1002 : Record 1502;
    BEGIN
      WorkflowStep.SETRANGE("Workflow Code",Workflow.Code);
      WorkflowStep.SETRANGE("Function Name",FunctionName);
      IF WorkflowStep.FINDSET THEN
        REPEAT
          IF NOT WorkflowStepArgument.GET(WorkflowStep.Argument) THEN
            InsertNotificationArgument(WorkflowStep.ID,'',0,'');
        UNTIL WorkflowStep.NEXT = 0;
    END;

    LOCAL PROCEDURE PopulateWorkflowStepArgument@5(VAR WorkflowStepArgument@1005 : Record 1523;ApproverType@1004 : Option;ApproverLimitType@1003 : Option;ApprovalEntriesPage@1002 : Integer;WorkflowUserGroupCode@1001 : Code[20];DueDateFormula@1000 : DateFormula;ShowConfirmationMessage@1006 : Boolean);
    BEGIN
      WorkflowStepArgument.INIT;
      WorkflowStepArgument.Type := WorkflowStepArgument.Type::Response;
      WorkflowStepArgument."Approver Type" := ApproverType;
      WorkflowStepArgument."Approver Limit Type" := ApproverLimitType;
      WorkflowStepArgument."Workflow User Group Code" := WorkflowUserGroupCode;
      WorkflowStepArgument."Due Date Formula" := DueDateFormula;
      WorkflowStepArgument."Link Target Page" := ApprovalEntriesPage;
      WorkflowStepArgument."Show Confirmation Message" := ShowConfirmationMessage;
    END;

    LOCAL PROCEDURE BuildNoPendingApprovalsConditions@56() : Text;
    VAR
      ApprovalEntry@1000 : Record 454;
    BEGIN
      ApprovalEntry.SETRANGE("Pending Approvals",0);
      EXIT(STRSUBSTNO(PendingApprovalsCondnTxt,Encode(ApprovalEntry.GETVIEW(FALSE))));
    END;

    LOCAL PROCEDURE BuildPendingApprovalsConditions@61() : Text;
    VAR
      ApprovalEntry@1000 : Record 454;
    BEGIN
      ApprovalEntry.SETFILTER("Pending Approvals",'>%1',0);
      EXIT(STRSUBSTNO(PendingApprovalsCondnTxt,Encode(ApprovalEntry.GETVIEW(FALSE))));
    END;

    PROCEDURE BuildIncomingDocumentTypeConditions@182(Status@1002 : Option) : Text;
    VAR
      IncomingDocument@1000 : Record 130;
      IncomingDocumentAttachment@1001 : Record 133;
    BEGIN
      IncomingDocument.SETRANGE(Status,Status);
      EXIT(
        STRSUBSTNO(
          IncomingDocumentTypeCondnTxt,Encode(IncomingDocument.GETVIEW(FALSE)),Encode(IncomingDocumentAttachment.GETVIEW(FALSE))));
    END;

    PROCEDURE BuildIncomingDocumentOCRTypeConditions@128(OCRStatus@1003 : Option) : Text;
    VAR
      IncomingDocument@1000 : Record 130;
      IncomingDocumentAttachment@1001 : Record 133;
    BEGIN
      IncomingDocument.SETRANGE("OCR Status",OCRStatus);
      EXIT(
        STRSUBSTNO(
          IncomingDocumentTypeCondnTxt,Encode(IncomingDocument.GETVIEW(FALSE)),Encode(IncomingDocumentAttachment.GETVIEW(FALSE))));
    END;

    PROCEDURE BuildPurchHeaderTypeConditions@64(DocumentType@1002 : Option;Status@1003 : Option) : Text;
    VAR
      PurchaseHeader@1000 : Record 38;
      PurchaseLine@1001 : Record 39;
    BEGIN
      PurchaseHeader.SETRANGE("Document Type",DocumentType);
      PurchaseHeader.SETRANGE(Status,Status);
      EXIT(STRSUBSTNO(PurchHeaderTypeCondnTxt,Encode(PurchaseHeader.GETVIEW(FALSE)),Encode(PurchaseLine.GETVIEW(FALSE))));
    END;

    PROCEDURE BuildSalesHeaderTypeConditions@67(DocumentType@1002 : Option;Status@1003 : Option) : Text;
    VAR
      SalesHeader@1000 : Record 36;
      SalesLine@1001 : Record 37;
    BEGIN
      SalesHeader.SETRANGE("Document Type",DocumentType);
      SalesHeader.SETRANGE(Status,Status);
      EXIT(STRSUBSTNO(SalesHeaderTypeCondnTxt,Encode(SalesHeader.GETVIEW(FALSE)),Encode(SalesLine.GETVIEW(FALSE))));
    END;

    LOCAL PROCEDURE BuildCustomerTypeConditions@160() : Text;
    VAR
      Customer@1000 : Record 18;
    BEGIN
      EXIT(STRSUBSTNO(CustomerTypeCondnTxt,Encode(Customer.GETVIEW(FALSE))));
    END;

    LOCAL PROCEDURE BuildGeneralJournalBatchTypeConditions@16() : Text;
    VAR
      GenJournalBatch@1000 : Record 232;
    BEGIN
      EXIT(STRSUBSTNO(GeneralJournalBatchTypeCondnTxt,Encode(GenJournalBatch.GETVIEW(FALSE))));
    END;

    PROCEDURE BuildGeneralJournalLineTypeConditions@33(VAR GenJournalLine@1000 : Record 81) : Text;
    BEGIN
      EXIT(STRSUBSTNO(GeneralJournalLineTypeCondnTxt,Encode(GenJournalLine.GETVIEW(FALSE))));
    END;

    LOCAL PROCEDURE InsertJobQueueData@63();
    VAR
      JobQueueStartedByNas@1000 : Boolean;
    BEGIN
      CreateMailNotificationJobQueueCategory;
      CreateJobQueueEntryForMail;

      CreateDelegationNotificationJobQueueCategory;
      CreateJobQueueEntryForDelegation;

      IF NOT CheckGenericJobQueueExists THEN BEGIN
        JobQueueStartedByNas := IsJobQueueStartedByNAS;
        CreateJobQueueForMailNotification(JobQueueStartedByNas);
        CreateJobQueueForDelegation(JobQueueStartedByNas);
      END;
    END;

    LOCAL PROCEDURE CreateMailNotificationJobQueueCategory@66();
    VAR
      JobQueueCategory@1000 : Record 471;
    BEGIN
      IF NOT JobQueueCategory.GET(MailNotifyJobQueueCategoryCodeTxt) THEN BEGIN
        JobQueueCategory.INIT;
        JobQueueCategory.Code := MailNotifyJobQueueCategoryCodeTxt;
        JobQueueCategory.Description := MailNotifyJobQueueCategoryDescTxt;
        JobQueueCategory.INSERT(TRUE);
      END;
    END;

    LOCAL PROCEDURE CreateJobQueueEntryForMail@68();
    VAR
      JobQueueEntry@1000 : Record 472;
    BEGIN
      JobQueueEntry.SETRANGE("Job Queue Category Code",MailNotifyJobQueueCategoryCodeTxt);
      IF NOT JobQueueEntry.FINDFIRST THEN
        WITH JobQueueEntry DO BEGIN
          INIT;
          "Earliest Start Date/Time" := CREATEDATETIME(TODAY,TIME);
          "Object Type to Run" := "Object Type to Run"::Codeunit;
          "Object ID to Run" := CODEUNIT::"Notification Entry Dispatcher";
          "Recurring Job" := TRUE;
          "Run on Mondays" := TRUE;
          "Run on Tuesdays" := TRUE;
          "Run on Wednesdays" := TRUE;
          "Run on Thursdays" := TRUE;
          "Run on Fridays" := TRUE;
          "Run on Saturdays" := TRUE;
          "Run on Sundays" := TRUE;
          "No. of Minutes between Runs" := 1;
          "Job Queue Category Code" := MailNotifyJobQueueCategoryCodeTxt;
          "Maximum No. of Attempts to Run" := 3;
          IF INSERT(TRUE) THEN;
        END;
    END;

    LOCAL PROCEDURE CreateDelegationNotificationJobQueueCategory@17();
    VAR
      JobQueueCategory@1000 : Record 471;
    BEGIN
      IF NOT JobQueueCategory.GET(DelegateJobQueueCategoryCodeTxt) THEN BEGIN
        JobQueueCategory.INIT;
        JobQueueCategory.Code := DelegateJobQueueCategoryCodeTxt;
        JobQueueCategory.Description := DelegateJobQueueCategoryDescTxt;
        JobQueueCategory.INSERT(TRUE);
      END;
    END;

    LOCAL PROCEDURE CreateJobQueueEntryForDelegation@10();
    VAR
      JobQueueEntry@1000 : Record 472;
    BEGIN
      JobQueueEntry.SETRANGE("Job Queue Category Code",DelegateJobQueueCategoryCodeTxt);
      IF NOT JobQueueEntry.FINDFIRST THEN BEGIN
        JobQueueEntry.INIT;
        JobQueueEntry."Earliest Start Date/Time" := CREATEDATETIME(TODAY,TIME);
        JobQueueEntry."Object Type to Run" := JobQueueEntry."Object Type to Run"::Report;
        JobQueueEntry."Object ID to Run" := REPORT::"Delegate Approval Requests";
        JobQueueEntry."Recurring Job" := TRUE;
        JobQueueEntry."Run on Mondays" := TRUE;
        JobQueueEntry."Run on Tuesdays" := TRUE;
        JobQueueEntry."Run on Wednesdays" := TRUE;
        JobQueueEntry."Run on Thursdays" := TRUE;
        JobQueueEntry."Run on Fridays" := TRUE;
        JobQueueEntry."Run on Saturdays" := TRUE;
        JobQueueEntry."Run on Sundays" := TRUE;
        JobQueueEntry."No. of Minutes between Runs" := 1440;
        JobQueueEntry."Job Queue Category Code" := DelegateJobQueueCategoryCodeTxt;
        JobQueueEntry."Report Output Type" := JobQueueEntry."Report Output Type"::"None (Processing only)";
        JobQueueEntry."Maximum No. of Attempts to Run" := 3;
        IF JobQueueEntry.INSERT(TRUE) THEN;
      END;
    END;

    LOCAL PROCEDURE IsJobQueueStartedByNAS@71() : Boolean;
    VAR
      JobQueue@1000 : Record 470;
    BEGIN
      IF JobQueue.ISEMPTY THEN
        EXIT(TRUE);

      JobQueue.SETRANGE("Start Automatically From NAS",TRUE);
      EXIT(NOT JobQueue.ISEMPTY);
    END;

    LOCAL PROCEDURE CheckGenericJobQueueExists@73() : Boolean;
    VAR
      JobQueue@1000 : Record 470;
    BEGIN
      JobQueue.SETFILTER("Job Queue Category Filter",'%1|%2|%3','',MailNotifyJobQueueCategoryCodeTxt,DelegateJobQueueCategoryCodeTxt);
      EXIT(NOT JobQueue.ISEMPTY);
    END;

    LOCAL PROCEDURE CreateJobQueueForMailNotification@72(StartFromNAS@1000 : Boolean);
    VAR
      JobQueue@1001 : Record 470;
    BEGIN
      JobQueue.INIT;
      JobQueue.Code := NotifyJobQueueCodeTxt;
      JobQueue.Description := NotifyJobQueueDescTxt;
      JobQueue.VALIDATE("Job Queue Category Filter",MailNotifyJobQueueCategoryCodeTxt);
      JobQueue."Start Automatically From NAS" := StartFromNAS;
      JobQueue.INSERT(TRUE);
    END;

    LOCAL PROCEDURE CreateJobQueueForDelegation@97(StartFromNAS@1000 : Boolean);
    VAR
      JobQueue@1001 : Record 470;
    BEGIN
      JobQueue.INIT;
      JobQueue.Code := DelegateJobQueueCodeTxt;
      JobQueue.Description := DelegateJobQueueDescTxt;
      JobQueue.VALIDATE("Job Queue Category Filter",DelegateJobQueueCategoryCodeTxt);
      JobQueue."Start Automatically From NAS" := StartFromNAS;
      JobQueue.INSERT(TRUE);
    END;

    PROCEDURE GetMailNotifyJobQueueCategoryCode@58() : Code[10];
    BEGIN
      EXIT(MailNotifyJobQueueCategoryCodeTxt);
    END;

    PROCEDURE GetMailNotifyJobQueueCategoryDesc@59() : Text[30];
    BEGIN
      EXIT(MailNotifyJobQueueCategoryDescTxt);
    END;

    PROCEDURE GetNotifyJobQueueCode@60() : Code[10];
    BEGIN
      EXIT(NotifyJobQueueCodeTxt);
    END;

    PROCEDURE GetNotifyJobQueueDesc@62() : Text[30];
    BEGIN
      EXIT(NotifyJobQueueDescTxt);
    END;

    PROCEDURE GetDelegateJobQueueCategoryCode@37() : Code[10];
    BEGIN
      EXIT(DelegateJobQueueCategoryCodeTxt);
    END;

    PROCEDURE GetDelegateJobQueueCategoryDesc@36() : Text[30];
    BEGIN
      EXIT(DelegateJobQueueCategoryDescTxt);
    END;

    PROCEDURE GetDelegateJobQueueCode@35() : Code[10];
    BEGIN
      EXIT(DelegateJobQueueCodeTxt);
    END;

    PROCEDURE GetDelegateJobQueueDesc@21() : Text[30];
    BEGIN
      EXIT(DelegateJobQueueDescTxt);
    END;

    LOCAL PROCEDURE Encode@93(Text@1001 : Text) : Text;
    VAR
      XMLDOMManagement@1000 : Codeunit 6224;
    BEGIN
      EXIT(XMLDOMManagement.XMLEscape(Text));
    END;

    BEGIN
    END.
  }
}

