OBJECT Table 9021618 Label
{
  OBJECT-PROPERTIES
  {
    Date=13/07/16;
    Time=[ 1:50:01 PM];
    Version List=EC2016.6;
  }
  PROPERTIES
  {
    DataPerCompany=No;
    DataCaptionFields=Code,Description;
    OnInsert=BEGIN
               "Used-in Company" := COMPANYNAME;
               IF NOT Dimension.GET('LABEL') THEN BEGIN
                 Dimension.INIT;
                 Dimension.Code := 'LABEL';
                 Dimension.Name := 'Label';
                 Dimension."Code Caption" := 'Label Code';
                 Dimension."Filter Caption" := 'Label Filter';
                 Dimension.INSERT;
               END;
               IF NOT DimensionValue.GET('LABEL',Code) THEN BEGIN
                 DimensionValue.INIT;
                 DimensionValue."Dimension Code" := 'LABEL';
                 DimensionValue.Code := Code;
                 DimensionValue.Name := FORMAT(Code) + ' Label';
                 DimensionValue.INSERT;
               END;

               CompanyInfo.GET;
               CompanyInfo.TESTFIELD("Country/Region Code");
               "Default User Country Code" := CompanyInfo."Country/Region Code";

               IF InternetSetup.GET THEN BEGIN
                 InternetSetup.TESTFIELD("Unique Customer Identifier");
                 "Unique Customer Identifier" := InternetSetup."Unique Customer Identifier";
               END ELSE
                 MESSAGE(Text022);
             END;

    OnModify=BEGIN
               IF "Bypass Company Name check" THEN BEGIN
                 IF xRec."Bypass Company Name check" THEN
                   "Bypass Company Name check" := FALSE
               END ELSE BEGIN
                 IF NOT xRec."Bypass Company Name check" THEN
                   CheckCompany();
               END;
             END;

    OnDelete=BEGIN
               IF "Used-in Company" <> COMPANYNAME THEN
                 ERROR(Text005,"Used-in Company");
               ePageRec.RESET;
               ePageRec.SETRANGE("Label Code",Code);
               IF ePageRec.FINDFIRST THEN
                 ERROR(Text000);
                 //You do not need a password, you just need to make sure that the Label has no categories
                 //however because deleting an active label would be so disasterous we have put in this
                 //erroneous message.

               IF CONFIRM(Text001,FALSE,Description) THEN BEGIN
                 PageItemRec.RESET;
                 PageItemRec.SETRANGE("Label Code",Code);
                 PageItemRec.DELETEALL;
                 //deleted this table...
                 //SyncProfile.RESET;
                 //SyncProfile.SETRANGE("Entry No",Code);
                 //SyncProfile.DELETEALL;
                 LabelAttribute.RESET;
                 LabelAttribute.SETRANGE("Label Code",Code);
                 LabelAttribute.DELETEALL;
                 LabelAttributeValue.RESET;
                 LabelAttributeValue.SETRANGE("Label Code",Code);
                 LabelAttributeValue.DELETEALL;
                 Subscription.RESET;
                 Subscription.SETRANGE("Label Code",Code);
                 Subscription.DELETEALL;
                 LabelWebsiteRec.RESET;
                 LabelWebsiteRec.SETRANGE("Label Code",Code);
                 LabelWebsiteRec.DELETEALL;
                 LabelWebConfigRec.RESET;
                 LabelWebConfigRec.SETRANGE("Label Code",Code);
                 LabelWebConfigRec.DELETEALL;
                 CustSubscriptionRec.RESET;
                 CustSubscriptionRec.SETRANGE("Label Code",Code);
                 CustSubscriptionRec.DELETEALL;
                 PageItemContentType.SETRANGE("Label Code",Code);
                 PageItemContentType.DELETEALL;
                 PageItemContent.SETRANGE("Label Code",Code);
                 PageItemContent.DELETEALL;
                 WebLocation.RESET;
                 WebLocation.SETRANGE("Label Code",Code);
                 WebLocation.DELETEALL;
                 WebLocationPC.RESET;
                 WebLocationPC.SETRANGE("Label Code",Code);
                 WebLocationPC.DELETEALL;
                 WebLocationInvalidPC.RESET;
                 WebLocationInvalidPC.SETRANGE("Label Code",Code);
                 WebLocationInvalidPC.DELETEALL;
                 WebLocationDelDay.RESET;
                 WebLocationDelDay.SETRANGE("Label Code",Code);
                 WebLocationDelDay.DELETEALL;
                 WebLocationDelMatrix.RESET;
                 WebLocationDelMatrix.SETRANGE("Label Code",Code);
                 WebLocationDelMatrix.DELETEALL;
                 WebLocationDelType.RESET;
                 WebLocationDelType.SETRANGE("Label Code",Code);
                 WebLocationDelType.DELETEALL;
                 WebLocOS.RESET;
                 //WebLocOS.SETCURRENTKEY("Label Code");
                 WebLocOS.SETRANGE("Label Code",Code);
                 WebLocOS.DELETEALL;
                 WebLocCS.RESET;
                 //WebLocCS.SETCURRENTKEY("Label Code");
                 WebLocCS.SETRANGE("Label Code",Code);
                 WebLocCS.DELETEALL;
                 WebAttrib.RESET;
                 WebAttrib.SETRANGE("Label Code",Code);
                 WebAttrib.DELETEALL;
                 WebAttribValue.RESET;
                 WebAttribValue.SETRANGE("Label Code",Code);
                 WebAttribValue.DELETEALL;
                 WebAttribGlobal.RESET;
                 WebAttribGlobal.SETRANGE("Label Code",Code);
                 WebAttribGlobal.DELETEALL;
                 WebAssembly.RESET;
                 WebAssembly.SETRANGE("Label Code",Code);
                 WebAssembly.DELETEALL;
                 WebAssemblyCpt.RESET;
                 WebAssemblyCpt.SETRANGE("Label Code",Code);
                 WebAssemblyCpt.DELETEALL;
               END ELSE
                 ERROR(Text002);
             END;

    OnRename=BEGIN
               //You should never be able to rename a Label code because once it is set
               //the web site uses these as labels
               ERROR(Text003);
             END;

    CaptionML=[ENU=Label;
               ENG=Label];
    LookupPageID=Page9021623;
    DrillDownPageID=Page9021623;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              ENG=Code];
                                                   NotBlank=Yes }
    { 3   ;   ;Active              ;Boolean       ;CaptionML=[ENU=Active;
                                                              ENG=Active] }
    { 10  ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              ENG=Description] }
    { 18  ;   ;Default Label in Company;Boolean   ;OnValidate=BEGIN
                                                                CheckCompany;
                                                                LabelRec.RESET;
                                                                LabelRec.SETRANGE("Used-in Company",COMPANYNAME);
                                                                LabelRec.SETFILTER(Code,'<>%1',Code);
                                                                LabelRec.SETRANGE("Default Label in Company",TRUE);
                                                                IF LabelRec.FINDFIRST THEN
                                                                  ERROR(Text007);
                                                              END;

                                                   CaptionML=[ENU=Default Label in Company;
                                                              ENG=Default Label in Company] }
    { 20  ;   ;Remote Shop URL     ;Text100       ;CaptionML=[ENU=Remote Shop URL;
                                                              ENG=Remote Shop URL] }
    { 21  ;   ;Staging Site URL    ;Text100       ;CaptionML=[ENU=Staging Site URL;
                                                              ENG=Staging Site URL] }
    { 22  ;   ;Trading Name        ;Text50        ;CaptionML=[ENU=Trading Name;
                                                              ENG=Trading Name] }
    { 24  ;   ;Trading Address     ;Text50        ;CaptionML=[ENU=Trading Address;
                                                              ENG=Trading Address] }
    { 25  ;   ;Trading Address 2   ;Text50        ;CaptionML=[ENU=Trading Address 2;
                                                              ENG=Trading Address 2] }
    { 26  ;   ;Trading City        ;Text30        ;CaptionML=[ENU=Trading City;
                                                              ENG=Trading City] }
    { 27  ;   ;Trading Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Trading Country/Region Code;
                                                              ENG=Trading Country/Region Code] }
    { 28  ;   ;Trading County      ;Text30        ;CaptionML=[ENU=Trading County;
                                                              ENG=Trading County] }
    { 29  ;   ;Trading Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                IF PostCode.GET("Trading Post Code") THEN
                                                                  "Trading City" := PostCode.City;
                                                              END;

                                                   CaptionML=[ENU=Trading Post Code;
                                                              ENG=Trading Post Code] }
    { 32  ;   ;Trading Phone No.   ;Text30        ;CaptionML=[ENU=Trading Phone No.;
                                                              ENG=Trading Phone No.] }
    { 33  ;   ;Trading Fax No.     ;Text30        ;CaptionML=[ENU=Trading Fax No.;
                                                              ENG=Trading Fax No.] }
    { 38  ;   ;Contact E-mail      ;Text80        ;CaptionML=[ENU=Contact E-mail;
                                                              ENG=Contact E-mail] }
    { 39  ;   ;Order Conf. E-mail  ;Text80        ;CaptionML=[ENU=Order Conf. E-mail;
                                                              ENG=Order Conf. E-mail] }
    { 40  ;   ;Cust. Ledger Request E-mail;Text80 ;CaptionML=[ENU=Cust. Ledger Request E-mail;
                                                              ENG=Cust. Ledger Request E-mail] }
    { 42  ;   ;Home Page URL       ;Text100       ;CaptionML=[ENU=Home Page URL;
                                                              ENG=Home Page URL] }
    { 43  ;   ;XML File Subfolder  ;Text30        ;CaptionML=[ENU=XML File Subfolder;
                                                              ENG=XML File Subfolder] }
    { 44  ;   ;Product Image Subfolder;Text100    ;CaptionML=[ENU=Product Image Subfolder;
                                                              ENG=Product Image Subfolder] }
    { 46  ;   ;Page Image Subfolder;Text100       ;CaptionML=[ENU=Page Image Subfolder;
                                                              ENG=Page Image Subfolder] }
    { 47  ;   ;File Attachment Subfolder;Text100  ;CaptionML=[ENU=File Attachment Subfolder;
                                                              ENG=File Attachment Subfolder] }
    { 48  ;   ;Web Content Folder  ;Text150       ;CaptionML=[ENU=Web Content Folder;
                                                              ENG=Web Content Folder] }
    { 50  ;   ;Used-in Company     ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Used-in Company;
                                                              ENG=Used-in Company] }
    { 53  ;   ;Website Page Address;Text80        ;CaptionML=[ENU=Website Page Address;
                                                              ENG=Website Page Address] }
    { 56  ;   ;Master ePage GuID for Items;Integer;TableRelation=ePage."Page GUID" WHERE (Label Code=FIELD(Code));
                                                   CaptionML=[ENU=Master ePage GuID for Items;
                                                              ENG=Master ePage GuID for Items] }
    { 57  ;   ;Show Advanced Page Content;Boolean ;CaptionML=[ENU=Show Advanced Page Content;
                                                              ENG=Show Advanced Page Content] }
    { 60  ;   ;Default Customer    ;Code20        ;TableRelation=Customer WHERE (Label Code=FIELD(Code));
                                                   OnValidate=BEGIN
                                                                //MQ 25/05/2011 - GW110525 -
                                                                IF "Default Customer" <> '' THEN BEGIN
                                                                  CustomerRec1.GET("Default Customer");
                                                                  IF CustomerRec1."User GUID" = '' THEN BEGIN
                                                                    CustomerRec1."User GUID" := '{99999999-9999-9999-9999-999999999999}';
                                                                    CustomerRec1.MODIFY;
                                                                  END;
                                                                END;
                                                                //MQ 25/05/2011 - GW110525 +
                                                              END;

                                                   CaptionML=[ENU=Default Customer;
                                                              ENG=Default Customer] }
    { 61  ;   ;Default Internet Customer GUID;Text38;
                                                   CaptionML=[ENU=Default Internet Customer GUID;
                                                              ENG=Default Internet Customer GUID] }
    { 62  ;   ;Custs have Same No. as Contact;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=[ENU=Custs have Same No. as Contact;
                                                              ENG=Custs have Same No. as Contact];
                                                   Description=Initial Value Yes }
    { 64  ;   ;Max. Sales Creation VAT Diff.;Decimal;
                                                   OnValidate=BEGIN
                                                                IF "Max. Sales Creation VAT Diff." > 0.05 THEN
                                                                  MESSAGE(Text020);
                                                              END;

                                                   CaptionML=[ENU=Max. Sales Creation VAT Diff.;
                                                              ENG=Max. Sales Creation VAT Diff.] }
    { 66  ;   ;Resource for Promo Discounts;Code20;TableRelation=Resource;
                                                   CaptionML=[ENU=Resource for Promo Discounts;
                                                              ENG=Resource for Promo Discounts] }
    { 70  ;   ;Edit Mode           ;Boolean       ;CaptionML=[ENU=Edit Mode;
                                                              ENG=Edit Mode] }
    { 74  ;   ;Default User Country Code;Code10   ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Default User Country Code;
                                                              ENG=Default User Country Code];
                                                   Description=Company used for anonymous users and B2C users with no address info }
    { 75  ;   ;Default User Customer Template;Code10;
                                                   TableRelation="Customer Template";
                                                   CaptionML=[ENU=Default User Customer Template;
                                                              ENG=Default User Customer Template];
                                                   Description=Customer Template used for anonymous users and B2C users with no associated Customer record }
    { 80  ;   ;Default B2B Payment Method;Code10  ;CaptionML=[ENU=Default B2B Payment Method;
                                                              ENG=Default B2B Payment Method];
                                                   Description=The Payment Method Code assigned to customers selecting the "pay on account" option online }
    { 81  ;   ;Use B2B Cust Payment Method;Boolean;CaptionML=[ENU=Use B2B Cust Payment Method;
                                                              ENG=Use B2B Cust Payment Method];
                                                   Description=Determines whether the Payment Method Code is taken from the Customer Card for B2B customers.  If 'No' then the Default B2B Cust Paymt Method Code is used. }
    { 82  ;   ;Post Credit on Order Creation;Boolean;
                                                   OnValidate=BEGIN
                                                                //DOC EC2013.3.40
                                                                IF (COPYSTR(Code,1,4) = 'DERM') AND
                                                                  ("Post Credit on Order Creation" = FALSE) THEN
                                                                  ERROR('Post Credit on Order Creation must be TRUE for DERM');
                                                                //DOC EC2013.3.80 -
                                                                IF "Post Credit on Order Creation" = FALSE THEN BEGIN
                                                                  InternetSetup.GET;
                                                                  IF InternetSetup."Use PCI Charge" THEN
                                                                    ERROR(Text030);
                                                                END;
                                                                //DOC EC2013.3.80 +
                                                              END;

                                                   CaptionML=[ENU=Post Credit on Order Creation;
                                                              ENG=Post Credit on Order Creation];
                                                   Description=GW add 120319 }
    { 83  ;   ;Allocate Payments to Oldest;Boolean;CaptionML=[ENU=Allocate Payments to Oldest;
                                                              ENG=Allocate Payments to Oldest];
                                                   Description=GW add 120319 }
    { 84  ;   ;Multi-Language Mode ;Boolean       ;OnValidate=BEGIN
                                                                MultiLangFunct.UpdateInMultiLangMode("Multi-Language Mode");
                                                              END;

                                                   CaptionML=[ENU=Multi-Language Mode;
                                                              ENG=Multi-Language Mode];
                                                   Description=GW add 120510 }
    { 99  ;   ;Bypass Company Name check;Boolean  ;CaptionML=[ENU=Bypass Company Name check;
                                                              ENG=Bypass Company Name check] }
    { 100 ;   ;Configuration OK    ;Boolean       ;CaptionML=[ENU=Configuration OK;
                                                              ENG=Configuration OK];
                                                   Description=Reflects the current validity of the labels configured categories;
                                                   Editable=No }
    { 101 ;   ;Assembly Configuration OK;Boolean  ;CaptionML=[ENU=Assembly Configuration OK;
                                                              ENG=Assembly Configuration OK];
                                                   Editable=No }
    { 102 ;   ;Sum Component Prices to Res.;Boolean;
                                                   OnValidate=BEGIN
                                                                ERROR('This has not yet been developed.');
                                                              END;

                                                   CaptionML=[ENU=Sum Component Prices to Res.;
                                                              ENG=Sum Component Prices to Res.] }
    { 104 ;   ;Auto Populate Promo Segments;Boolean;
                                                   CaptionML=[ENU=Auto Populate Promo Segments;
                                                              ENG=Auto Populate Promo Segments] }
    { 110 ;   ;Page Address for HTML Editor;Text80;CaptionML=[ENU=Page Address for HTML Editor;
                                                              ENG=Page Address for HTML Editor];
                                                   Description=GW 141009 was 100 }
    { 111 ;   ;Terms and Conditions URL;Text80    ;CaptionML=[ENU=Terms and Conditions URL;
                                                              ENG=Terms and Conditions URL];
                                                   Description=GW 141009 was 100 }
    { 112 ;   ;DateTime Terms Last Modified;DateTime;
                                                   CaptionML=[ENU=DateTime Terms Last Modified;
                                                              ENG=DateTime Terms Last Modified] }
    { 120 ;   ;Default Web Location;Code10        ;TableRelation="Web Location"."Label Code" WHERE (Label Code=FIELD(Code));
                                                   CaptionML=[ENU=Default Web Location;
                                                              ENG=Default Web Location] }
    { 121 ;   ;Delivery Days Calendar;Code10      ;TableRelation="Base Calendar";
                                                   CaptionML=[ENU=Delivery Days Calendar;
                                                              ENG=Delivery Days Calendar] }
    { 126 ;   ;Main Image Prefix   ;Text10        ;CaptionML=[ENU=Main Image Prefix;
                                                              ENG=Main Image Prefix];
                                                   Description=GW add 110606, GW 141009 was 20 }
    { 127 ;   ;Main Image Postfix  ;Text10        ;CaptionML=[ENU=Main Image Postfix;
                                                              ENG=Main Image Postfix];
                                                   Description=GW add 110606, GW 141009 was 20 }
    { 128 ;   ;Thumbnail Image Prefix;Text10      ;CaptionML=[ENU=Thumbnail Image Prefix;
                                                              ENG=Thumbnail Image Prefix];
                                                   Description=GW add 110606, GW 141009 was 20 }
    { 129 ;   ;Thumbnail Image Postfix;Text10     ;CaptionML=[ENU=Thumbnail Image Postfix;
                                                              ENG=Thumbnail Image Postfix];
                                                   Description=GW add 110606, GW 141009 was 20 }
    { 130 ;   ;Large Image Prefix  ;Text10        ;CaptionML=[ENU=Large Image Prefix;
                                                              ENG=Large Image Prefix];
                                                   Description=GW add 110606, GW 141009 was 20 }
    { 131 ;   ;Large Image Postfix ;Text10        ;CaptionML=[ENU=Large Image Postfix;
                                                              ENG=Large Image Postfix];
                                                   Description=GW add 110606, GW 141009 was 20 }
    { 132 ;   ;Other Image Prefix  ;Text10        ;CaptionML=[ENU=Other Image Prefix;
                                                              ENG=Other Image Prefix];
                                                   Description=GW add 110606, GW 141009 was 20 }
    { 133 ;   ;Other Image Postfix ;Text10        ;CaptionML=[ENU=Other Image Postfix;
                                                              ENG=Other Image Postfix];
                                                   Description=GW add 110606, GW 141009 was 20 }
    { 136 ;   ;Use Item No. in Image Path;Boolean ;CaptionML=[ENU=Use Item No. in Image Path;
                                                              ENG=Use Item No. in Image Path];
                                                   Description=GW add 110606 }
    { 137 ;   ;Main Image File Ending;Text4       ;InitValue=.jpg;
                                                   OnValidate=BEGIN
                                                                IF STRLEN("Main Image File Ending") <> 0 THEN BEGIN
                                                                  IF STRLEN("Main Image File Ending") <> 4 THEN
                                                                    ERROR(Text024);
                                                                  IF STRPOS("Main Image File Ending",'.') <> 1 THEN
                                                                    ERROR(Text025);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Main Image File Ending;
                                                              ENG=Main Image File Ending];
                                                   Description=GW add 110606 }
    { 138 ;   ;Thumbnail Image File Ending;Text4  ;InitValue=.jpg;
                                                   OnValidate=BEGIN
                                                                IF STRLEN("Thumbnail Image File Ending") <> 0 THEN BEGIN
                                                                  IF STRLEN("Thumbnail Image File Ending") <> 4 THEN
                                                                    ERROR(Text024);
                                                                  IF STRPOS("Thumbnail Image File Ending",'.') <> 1 THEN
                                                                    ERROR(Text025);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Thumbnail Image File Ending;
                                                              ENG=Thumbnail Image File Ending];
                                                   Description=GW add 110606 }
    { 139 ;   ;Large Image File Ending;Text4      ;InitValue=.jpg;
                                                   OnValidate=BEGIN
                                                                IF STRLEN("Large Image File Ending") <> 0 THEN BEGIN
                                                                  IF STRLEN("Large Image File Ending") <> 4 THEN
                                                                    ERROR(Text024);
                                                                  IF STRPOS("Large Image File Ending",'.') <> 1 THEN
                                                                    ERROR(Text025);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Large Image File Ending;
                                                              ENG=Large Image File Ending];
                                                   Description=GW add 110606 }
    { 140 ;   ;Other Image File Ending;Text4      ;InitValue=.jpg;
                                                   OnValidate=BEGIN
                                                                IF STRLEN("Other Image File Ending") <> 0 THEN BEGIN
                                                                  IF STRLEN("Other Image File Ending") <> 4 THEN
                                                                    ERROR(Text024);
                                                                  IF STRPOS("Other Image File Ending",'.') <> 1 THEN
                                                                    ERROR(Text025);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Other Image File Ending;
                                                              ENG=Other Image File Ending];
                                                   Description=GW add 110606 }
    { 200 ;   ;Last Blob Entry No. ;Integer       ;CaptionML=[ENU=Last Blob Entry No.;
                                                              ENG=Last Blob Entry No.] }
    { 203 ;   ;Last Assembly Entry ID;Integer     ;CaptionML=[ENU=Last Assembly Entry ID;
                                                              ENG=Last Assembly Entry ID] }
    { 204 ;   ;Last ePage Entry GroupGuid;Integer ;CaptionML=[ENU=Last ePage Entry GroupGuid;
                                                              ENG=Last ePage Entry GroupGuid] }
    { 205 ;   ;DateTime Pages Last Modified;DateTime;
                                                   CaptionML=[ENU=DateTime Pages Last Modified;
                                                              ENG=DateTime Pages Last Modified];
                                                   Description=The datetime of the last change affecting a page;
                                                   Editable=No }
    { 209 ;   ;Web Application Folder Share;Text100;
                                                   CaptionML=[ENU=Web Application Folder Share;
                                                              ENG=Web Application Folder Share];
                                                   Description=E.g. \\stagingserver\websiteroot\, GW 141009 was 150 }
    { 212 ;   ;Update Cust From Template;Boolean  ;CaptionML=[ENU=Update Cust From Template;
                                                              ENG=Update Cust From Template];
                                                   Description=GW 101112 if country changes on Internet Cust, update Cust details }
    { 214 ;   ;Manual Run ePage ParentBlocked;Boolean;
                                                   CaptionML=[ENU=Manual Run ePage ParentBlocked;
                                                              ENG=Manual Run ePage ParentBlocked];
                                                   Description=MQ 09/11/2011 - GW111109 }
    { 215 ;   ;Reorder Required    ;Boolean       ;CaptionML=[ENU=Reorder Required;
                                                              ENG=Reorder Required] }
    { 220 ;   ;Day of Month to Run Web Stats;Integer;
                                                   CaptionML=[ENU=Day of Month to Run Web Stats;
                                                              ENG=Day of Month to Run Web Stats] }
    { 221 ;   ;Next Month to Run Web Stats;Integer;CaptionML=[ENU=Next Month to Run Web Stats;
                                                              ENG=Next Month to Run Web Stats];
                                                   MaxValue=12 }
    { 222 ;   ;Sales Account Start ;Code20        ;TableRelation="G/L Account";
                                                   CaptionML=[ENU=Sales Account Start;
                                                              ENG=Sales Account Start] }
    { 224 ;   ;Sales Account End   ;Code20        ;TableRelation="G/L Account";
                                                   CaptionML=[ENU=Sales Account End;
                                                              ENG=Sales Account End] }
    { 226 ;   ;Allow Multi Account Logins;Boolean ;OnValidate=BEGIN
                                                                IF "Allow Multi Account Logins" THEN BEGIN
                                                                  IF NOT CONFIRM(Text028) THEN
                                                                    ERROR(Text027);
                                                                END ELSE BEGIN
                                                                  InternetB2BCustomer.RESET;
                                                                  InternetB2BCustomer.SETRANGE("Multi Account Login",TRUE);
                                                                  IF InternetB2BCustomer.FINDFIRST THEN
                                                                    ERROR(Text029);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Allow Multi Account Logins;
                                                              ENG=Allow Multi Account Logins] }
    { 230 ;   ;Default Sort Lowest First;Boolean  ;CaptionML=[ENU=Default Sort Lowest First;
                                                              ENG=Default Sort Lowest First] }
    { 232 ;   ;Default Sort Put Promos At Top;Boolean;
                                                   CaptionML=[ENU=Default Sort Put Promos At Top;
                                                              ENG=Default Sort Put Promos At Top] }
    { 240 ;   ;Default B2B Buy Button State;Option;CaptionML=[ENU=Default B2B Buy Button State;
                                                              ENG=Default B2B Buy Button State];
                                                   OptionCaptionML=[ENU=Do Not Auto Add,View and Buy,View Only,View and Link to 3rd party,Pop Up;
                                                                    ENG=Do Not Auto Add,View and Buy,View Only,View and Link to 3rd party,Pop Up];
                                                   OptionString=Do Not Auto Add,View and Buy,View Only,View and Link to 3rd party,Pop Up }
    { 242 ;   ;Default B2C Buy Button State;Option;CaptionML=[ENU=Default B2C Buy Button State;
                                                              ENG=Default B2C Buy Button State];
                                                   OptionCaptionML=[ENU=Do Not Auto Add,View and Buy,View Only,View and Link to 3rd party,Pop Up;
                                                                    ENG=Do Not Auto Add,View and Buy,View Only,View and Link to 3rd party,Pop Up];
                                                   OptionString=Do Not Auto Add,View and Buy,View Only,View and Link to 3rd party,Pop Up }
    { 245 ;   ;Login Inherits Cust. User Role;Boolean;
                                                   CaptionML=[ENU=Login Inherits Cust. User Role;
                                                              ENG=Login Inherits Cust. User Role] }
    { 246 ;   ;AutoPop PageItems to Cat. Page;Boolean;
                                                   CaptionML=[ENU=AutoPop PageItems to Cat. Page;
                                                              ENG=AutoPop PageItems to Cat. Page] }
    { 250 ;   ;Page Item Links To Parent Page;Boolean;
                                                   OnValidate=BEGIN
                                                                IF "Page Item Links To Parent Page" THEN BEGIN
                                                                  //DOC EC2009.2.70 Add confirm message
                                                                  IF NOT CONFIRM(Text026) THEN
                                                                    ERROR(Text027);
                                                                  "Page Item Link Guid (Item)":=0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Page Item Links To Parent Page;
                                                              ENG=Page Item Links To Parent Page] }
    { 251 ;   ;Page Item Link Guid (Item);Integer ;TableRelation=ePage."Page GUID" WHERE (Label Code=FIELD(Code));
                                                   OnValidate=BEGIN
                                                                IF "Page Item Link Guid (Item)" <> 0 THEN
                                                                  "Page Item Links To Parent Page":=FALSE;
                                                              END;

                                                   CaptionML=[ENU=Page Item Link Guid (Item);
                                                              ENG=Page Item Link Guid (Item)] }
    { 260 ;   ;Add Meta on Item Desc Validate;Boolean;
                                                   CaptionML=[ENU=Add Meta on Item Desc Validate;
                                                              ENG=Add Meta on Item Desc Validate] }
    { 261 ;   ;Catalogue Page Guid ;Integer       ;TableRelation=ePage."Page GUID" WHERE (Label Code=FIELD(Code));
                                                   CaptionML=[ENU=Catalogue Page Guid;
                                                              ENG=Catalogue Page Guid] }
    { 265 ;   ;ePage Menu Name Max Length;Integer ;InitValue=30;
                                                   CaptionML=[ENU=ePage Menu Name Max Length;
                                                              ENG=ePage Menu Name Max Length];
                                                   MaxValue=50 }
    { 275 ;   ;FTP Doc Download Servername;Text40 ;CaptionML=[ENU=FTP Doc Download Servername;
                                                              ENG=FTP Doc Download Servername] }
    { 276 ;   ;FTP Doc Download Username;Text30   ;CaptionML=[ENU=FTP Doc Download Username;
                                                              ENG=FTP Doc Download Username] }
    { 277 ;   ;FTP Doc Download Password;Text30   ;CaptionML=[ENU=FTP Doc Download Password;
                                                              ENG=FTP Doc Download Password] }
    { 278 ;   ;FTP Doc Download Folder Path;Text100;
                                                   CaptionML=[ENU=FTP Doc Download Folder Path;
                                                              ENG=FTP Doc Download Folder Path] }
    { 280 ;   ;FTP UNC Folder Path ;Text100       ;CaptionML=[ENU=FTP UNC Folder Path;
                                                              ENG=FTP UNC Folder Path] }
    { 999 ;   ;Unique Customer Identifier;Code10  ;CaptionML=[ENU=Unique Customer Identifier;
                                                              ENG=Unique Customer Identifier];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ePageRec@1000000000 : Record 9021628;
      Text000@1040013 : TextConst 'ENU=You need a password to delete this label. Please contact Brand Villages. (0);ENG=You need a password to delete this label. Please contact Brand Villages. (0)';
      Text001@1000000001 : TextConst 'ENU=Are you sure you wish to delete this Label as deleting it will delete all associated entries? (1);ENG=Are you sure you wish to delete this Label as deleting it will delete all associated entries? (1)';
      Text002@1000000002 : TextConst 'ENU=Delete Abandoned. (2);ENG=Delete Abandoned. (2)';
      ePageRec1@1000000006 : Record 9021628;
      PageItemRec@1000000003 : Record 9021629;
      Text003@1000000004 : TextConst 'ENU=You cannot rename a Label. (3);ENG=You cannot rename a Label. (3)';
      Text004@1000000005 : TextConst 'ENU=The "Used in Company" cannot be changed. (4);ENG=The "Used in Company" cannot be changed. (4)';
      Text005@1000000022 : TextConst 'ENU=You cannot delete this Label unless you are in %1 company. (5);ENG=You cannot delete this Label unless you are in %1 company. (5)';
      Text006@1040001 : TextConst 'ENU=You cannot make changes to this Label unless you are in %1 company. (6);ENG=You cannot make changes to this Label unless you are in %1 company. (6)';
      LabelRec@1040000 : Record 9021618;
      Text007@1040002 : TextConst 'ENU=You cannot have more than one default Label in a company. (7);ENG=You cannot have more than one default Label in a company. (7)';
      Dimension@1040003 : Record 348;
      DimensionValue@1040004 : Record 349;
      PostCode@1040005 : Record 225;
      LabelAttribute@1040010 : Record 9021623;
      LabelAttribute1@1000000007 : Record 9021623;
      LabelAttributeValue@1040011 : Record 9021624;
      PageItemContentType@1000000021 : Record 9021632;
      PageItemContent@1000000023 : Record 9021636;
      WebLocation@1000000024 : Record 9021692;
      WebLocationPC@1000000029 : Record 9021696;
      WebLocationInvalidPC@1000000030 : Record 9021697;
      WebLocationDelMatrix@1000000031 : Record 9021703;
      WebLocationDelType@1000000032 : Record 9021700;
      WebLocationDelDay@1000000025 : Record 9021699;
      WebLocOS@1000000026 : Record 9021693;
      WebLocCS@1000000027 : Record 9021694;
      WebAttrib@1000000033 : Record 9021701;
      WebAttribValue@1000000028 : Record 9021702;
      WebAttribGlobal@1000000034 : Record 9021695;
      WebAssembly@1000000035 : Record 9021687;
      WebAssemblyCpt@1000000036 : Record 9021688;
      Subscription@1040007 : Record 9021653;
      Text008@1040014 : TextConst 'ENU="You should only change the configuration of a Label''s Company if you are certain of the repercussions.  \\Do you definitely want to go ahead?  \\(If so, remember to uncheck the ""Disable Company Check in Label"" setup after making the required changes.) ";ENG="You should only change the configuration of a Label''s Company if you are certain of the repercussions.  \\Do you definitely want to go ahead?  \\(If so, remember to uncheck the ""Disable Company Check in Label"" setup after making the required changes.) "';
      Text009@1040015 : TextConst 'ENU=No change was made. (9);ENG=No change was made. (9)';
      Text010@1040018 : TextConst 'ENU=A customer with User Guid %1 as specified in the Web Shop Setup already exists.  Please change the Default Internet Customer Guid in the Web Shop setup to proceed. (10);ENG=A customer with User Guid %1 as specified in the Web Shop Setup already exists.  Please change the Default Internet Customer Guid in the Web Shop setup to proceed. (10)';
      CustomerRec1@1040019 : Record 18;
      CustomerRec2@1040020 : Record 18;
      Text011@1040021 : TextConst 'ENU=Something does not add up. The Internet Customer No. %1, as specified in the Web Shop Setup, already exists and yet the Default Internet Customer has a blank User Guid. (11);ENG=Something does not add up. The Internet Customer No. %1, as specified in the Web Shop Setup, already exists and yet the Default Internet Customer has a blank User Guid. (11)';
      ContactRec1@1040022 : Record 5050;
      ContBusRel@1040023 : Record 5054;
      Text012@1040025 : TextConst 'ENU=The Internet Customer No. %1 already exists. You don''t need to create another one. (12);ENG=The Internet Customer No. %1 already exists. You don''t need to create another one. (12)';
      RelMarkSetup@1040028 : Record 5079;
      CustSubscriptionRec@1000000011 : Record 9021654;
      LabelWebsiteRec@1000000012 : Record 9021619;
      LabelWebConfigRec@1000000013 : Record 9021620;
      Text013@1040026 : TextConst 'ENU=Internet Customer No. %1 created and Contact No. %2 created. (13);ENG=Internet Customer No. %1 created and Contact No. %2 created. (13)';
      Text014@1040027 : TextConst 'ENU=Internet Customer No. %1 created and linked to Contact No. %2. (14);ENG=Internet Customer No. %1 created and linked to Contact No. %2. (14)';
      Text015@1000000008 : TextConst 'ENU=Can not find language. (15);ENG=Can not find language. (15)';
      Text016@1000000009 : TextConst 'ENU=This line is not an HTML line. (16);ENG=This line is not an HTML line. (16)';
      Text017@1000000010 : TextConst 'ENU=This HTML is shared.  Changing it will change it for all entries.\\Are you sure you want to continue? (17);ENG=This HTML is shared.  Changing it will change it for all entries.\\Are you sure you want to continue? (17)';
      Text018@1000000015 : TextConst 'ENU=No Sync Collection records were found.  To run a sync manually, Sync Collection Modules must be configured for selection. (18);ENG=No Sync Collection records were found.  To run a sync manually, Sync Collection Modules must be configured for selection. (18)';
      Text019@1000000014 : TextConst 'ENU=Do you want to run the sync for all Labels?\\(If you click ''No'' the sync will be run for ''%1'' only.);ENG=Do you want to run the sync for all Labels?\\(If you click ''No'' the sync will be run for ''%1'' only.)';
      Text020@1000000016 : TextConst 'ENU=Warning....this figure seems very high. (20);ENG=Warning....this figure seems very high. (20)';
      CompanyInfo@1000000017 : Record 79;
      Text021@1000000018 : TextConst 'ENU="""Page Item Links to Parent Page"" is ''No'', but ""Page Item Link Guid (Item)"" is not specified.  No ''TEMPLATE'' attribute can be created. (21)";ENG="""Page Item Links to Parent Page"" is ''No'', but ""Page Item Link Guid (Item)"" is not specified.  No ''TEMPLATE'' attribute can be created. (21)"';
      InternetSetup@1000000019 : Record 9021609;
      InternetB2BCustomer@1190000010 : Record 9021643;
      ContactNo@1000000020 : Code[20];
      Text022@1000000037 : TextConst 'ENU=Internet Setup does not exist.  You will need to manually populate the Unique Customer Identifier on the Label. (22);ENG=Internet Setup does not exist.  You will need to manually populate the Unique Customer Identifier on the Label. (22)';
      Text023@1000000038 : TextConst 'ENU=No Active Label could be found.  Sync aborted! (23);ENG=No Active Label could be found.  Sync aborted! (23)';
      Text024@1190000005 : TextConst 'ENU=This field must either be blank or have 4 characters. (24);ENG=This field must either be blank or have 4 characters. (24)';
      Text025@1190000006 : TextConst 'ENU=The first character must be a ''.'' (25);ENG=The first character must be a ''.'' (25)';
      Text026@1190000007 : TextConst 'ENU=This only works if an item is only on one ePage.\\Are you sure this will work for you?'' (26);ENG=This only works if an item is only on one ePage.\\Are you sure this will work for you?'' (26)';
      Text027@1190000008 : TextConst 'ENU=Abandoned.;ENG=Abandoned.';
      Text028@1190000009 : TextConst 'ENU=Website must be set up to allow this.\\Are you sure? (28);ENG=Website must be set up to allow this.\\Are you sure? (28)';
      Text029@1190000011 : TextConst 'ENU=You cannot untick this while some Internet B2B Customers have Multi Account Logins ticked. (29);ENG=You cannot untick this while some Internet B2B Customers have Multi Account Logins ticked. (29)';
      MultiLangFunct@1190000012 : Codeunit 9021603;
      mqGLobals@1000000039 : Codeunit 9021624;
      Text030@1000000040 : TextConst 'ENU=You cannot untick this if Use PCI in the Internet Setup is ticked. (30);ENG=You cannot untick this if Use PCI in the Internet Setup is ticked. (30)';

    PROCEDURE CheckCompany@1040000();
    VAR
      CompanyIsChanged@1040001 : Boolean;
    BEGIN
      //check we're in the company this label belongs to...
      IF (xRec."Used-in Company" <> COMPANYNAME) THEN
        ERROR(Text006,xRec."Used-in Company");

      //check whether the company has been changed...
      CompanyIsChanged := NOT("Used-in Company"=xRec."Used-in Company");
      IF CompanyIsChanged THEN BEGIN
        IF "Bypass Company Name check" THEN BEGIN
          IF NOT CONFIRM(Text008) THEN
            ERROR(Text009);
        END ELSE
          ERROR(Text004);
      END;
    END;

    PROCEDURE CreateDefaultInternetCustomer@1040001();
    BEGIN

      ERROR('Please uncomment this code when other object dependencies are imported - labelrec.createdefaultinternetcustomer');
      {
      IF "Used in which Company" <> COMPANYNAME THEN
        ERROR(Text006,"Used in which Company");
      TESTFIELD("Default Customer");
      CustomerRec1.GET("Default Customer");
      CustomerRec1.TESTFIELD("Label Code",Code);
      IF CustomerRec1."User GuID" = '' THEN BEGIN
        WebShopSetup.GET;
        WebShopSetup.TESTFIELD("Default Internet Customer Guid");
        CustomerRec2.RESET;
        CustomerRec2.SETRANGE("User GuID",WebShopSetup."Default Internet Customer Guid");
        IF CustomerRec2.FINDFIRST THEN
          ERROR(Text010);
        IF InternetCustRec.GET(WebShopSetup."Default Internet Customer Guid") THEN
          ERROR(Text011,WebShopSetup."Default Internet Customer Guid");
        CustomerRec1."User GuID" := WebShopSetup."Default Internet Customer Guid";
        CustomerRec1."Is An Internet Customer" := TRUE;
        CustomerRec1.MODIFY;
      END ELSE BEGIN
        IF InternetCustRec.GET(CustomerRec1."User GuID") THEN
          ERROR(Text012,CustomerRec1."User GuID");
      END;

      //Check if contact exists, if not create.
      ContactNo := '';
      ContBusRel.RESET;
      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("No.",CustomerRec1."No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      IF ContBusRel.FINDFIRST THEN BEGIN
        ContactRec1.GET(ContBusRel."Contact No.");
        IF ContactRec1."Label Code" = '' THEN BEGIN
          ContactRec1."Label Code" := Code;
        END ELSE BEGIN
          ContactRec1.TESTFIELD("Label Code",Code);
        END;
        IF ContactRec1."User GuID" = '' THEN BEGIN
          ContactRec1."User GuID" := CustomerRec1."User GuID";
        END ELSE BEGIN
          ContactRec1.TESTFIELD("User GuID",CustomerRec1."User GuID");
        END;
        ContactRec1."Is An Internet Customer" := TRUE;
        ContactRec1.MODIFY;
        ContactNo := ContactRec1."No.";
      END;

      //Create Internet Customer.
      InternetCustRec.INIT;
      InternetCustRec."No." := CustomerRec1."User GuID";
      InternetCustRec."Customer No." := CustomerRec1."No.";
      InternetCustRec.Name := 'Default Internet Customer for Label ' + FORMAT(Code);
      InternetCustRec.Contact :=InternetCustRec.Name;
      InternetCustRec."Label Code" := Code;
      IF ContactNo <> '' THEN
        InternetCustRec."Contact No." := ContactNo;
      InternetCustRec.INSERT;
      IF ContactNo = '' THEN BEGIN
        InternetCustRec.CreateContact2;
        InternetCustRec.MODIFY;
        ContBusRel.INIT;
        ContBusRel."No." := CustomerRec1."No.";
        ContBusRel."Link to Table" := ContBusRel."Link to Table"::Customer;
        ContBusRel."Contact No." := InternetCustRec."Contact No.";
        RelMarkSetup.GET;
        ContBusRel."Business Relation Code" := RelMarkSetup."Bus. Rel. Code for Customers";
        ContBusRel.INSERT;
        MESSAGE(Text013,CustomerRec1."User GuID",InternetCustRec."Contact No.");
      END ELSE
        MESSAGE(Text014,CustomerRec1."User GuID",InternetCustRec."Contact No.");
      }
    END;

    PROCEDURE EditHtmlEntry@1000000000(HtmlAllowed@1000000000 : Boolean;VAR HtmlEntryNo@1000000002 : Integer;LabelCode@1000000003 : Text[10];SharedHtml@1000000001 : Boolean;OwnerTypeCode@1190000005 : Code[10];OwnerId@1190000006 : Code[100];PropertyCode@1190000008 : Code[100];LanguageCode@1190000007 : Code[5]);
    BEGIN
      IF NOT HtmlAllowed THEN
        ERROR(Text016);
      IF SharedHtml THEN
        IF NOT CONFIRM(Text017,FALSE) THEN
          EXIT;
      IF  HtmlEntryNo = 0 THEN BEGIN
        LOCKTABLE;
        GET(LabelCode);
        HtmlEntryNo := "Last Blob Entry No." +1;
        MODIFY;
        "Last Blob Entry No." := HtmlEntryNo;
        MODIFY;
      END;
      GET(LabelCode);
      TESTFIELD("Page Address for HTML Editor");
      HYPERLINK ("Staging Site URL" +
                 "Page Address for HTML Editor" + '?' +
                 'LabelCode=' +Rec.Code+ '&' +
                 'ContentFragmentId=' + FORMAT(HtmlEntryNo) + '&' +
                 'OwnerTypeCode=' +OwnerTypeCode+ '&' +
                 'OwnerId=' +OwnerId+ '&' +
                 'PropertyCode=' +PropertyCode+ '&' +
                 'LanguageCode=' +LanguageCode
                 );
    END;

    PROCEDURE ResetPageDataWithLocalLang@1000000001();
    VAR
      LangRec@1000000000 : Record 8;
    BEGIN
      ERROR('labelrec.resetpagedatawithlocallang - code needs fixing.');

      //Want to update the categories and the "A Value" in the Label Attribute table.
      LabelAttribute.RESET;
      LabelAttribute.SETCURRENTKEY("Label Code","Attribute Type","Attribute Owner Reference"); //DOC EC2013.3.00
      LabelAttribute.SETRANGE("Label Code",Code);
      LabelAttribute.SETRANGE("Attribute Type",'PAGE');
      LangRec.RESET;
      LangRec.SETRANGE("Windows Language ID",GLOBALLANGUAGE);
      LangRec.SETFILTER(Code,'<>%1','CPL');
      IF NOT LangRec.FINDFIRST THEN
        ERROR(Text015);

      ePageRec.RESET;
      ePageRec.SETRANGE("Label Code",Code);
      IF ePageRec.FIND('-') THEN
      REPEAT
        ePageRec1 := ePageRec;
        LabelAttribute.SETRANGE("Attribute Owner Reference",FORMAT(ePageRec."Page GUID"));



        {
        LabelAttribute.SETRANGE("attribute Type",'PAGE');
        IF LabelAttribute.FINDFIRST THEN BEGIN
          IF LabelAttributeValue.GET(Code,LabelAttribute."Entry No.",LangRec.Code) THEN BEGIN
            LabelAttribute1 := LabelAttribute;
            IF LabelAttributeValue.Value <> '' THEN BEGIN
              LabelAttribute1."A value" := LabelAttributeValue.Value;
              LabelAttribute1.MODIFY;
            END;
            PageRec1."Main Image" := LabelAttributeValue.Value;
          END ELSE
            PageRec1."Main Image" := '';
        END;

        LabelAttribute.SETRANGE(Type,LabelAttribute.Type::"1");
        IF LabelAttribute.FINDFIRST THEN BEGIN
          IF LabelAttributeValue.GET(Code,LabelAttribute."Entry No.",LangRec.Code) THEN BEGIN
            LabelAttribute1 := LabelAttribute;
            IF LabelAttributeValue.Value <> '' THEN BEGIN
              LabelAttribute1."A value" := LabelAttributeValue.Value;
              LabelAttribute1.MODIFY;
            END;
            PageRec1."Thumbnail Image" := LabelAttributeValue.Value;
          END ELSE
            PageRec1."Thumbnail Image" := '';
        END;

        LabelAttribute.SETRANGE(Type,LabelAttribute.Type::"3");
        IF LabelAttribute.FINDFIRST THEN BEGIN
          IF LabelAttributeValue.GET(Code,LabelAttribute."Entry No.",LangRec.Code) THEN BEGIN
            LabelAttribute1 := LabelAttribute;
            IF LabelAttributeValue.Value <> '' THEN BEGIN
              LabelAttribute1."A value" := LabelAttributeValue.Value;
              LabelAttribute1.MODIFY;
            END;
            PageRec1."Menu Name" := LabelAttributeValue.Value;
          END ELSE
            PageRec1."Menu Name" := '';
        END;

        LabelAttribute.SETRANGE(Type,LabelAttribute.Type::"4");
        IF LabelAttribute.FINDFIRST THEN BEGIN
          IF LabelAttributeValue.GET(Code,LabelAttribute."Entry No.",LangRec.Code) THEN BEGIN
            LabelAttribute1 := LabelAttribute;
            IF LabelAttributeValue.Value <> '' THEN BEGIN
              LabelAttribute1."A value" := LabelAttributeValue.Value;
              LabelAttribute1.MODIFY;
            END;
            PageRec1.Description := LabelAttributeValue.Value;
          END ELSE
            PageRec1.Description := '';
        END;

        LabelAttribute.SETRANGE(Type,LabelAttribute.Type::"6");
        IF LabelAttribute.FINDFIRST THEN BEGIN
          IF LabelAttributeValue.GET(Code,LabelAttribute."Entry No.",LangRec.Code) THEN BEGIN
            LabelAttribute1 := LabelAttribute;
            IF LabelAttributeValue.Value <> '' THEN BEGIN
              LabelAttribute1."A value" := LabelAttributeValue.Value;
              LabelAttribute1.MODIFY;
            END;
            PageRec1."Icon Image" := LabelAttributeValue.Value;
          END ELSE
            PageRec1."Icon Image" := '';
        END;

        LabelAttribute.SETRANGE(Type,LabelAttribute.Type::"8");
        IF LabelAttribute.FINDFIRST THEN BEGIN
          IF LabelAttributeValue.GET(Code,LabelAttribute."Entry No.",LangRec.Code) THEN BEGIN
            LabelAttribute1 := LabelAttribute;
            IF LabelAttributeValue.Value <> '' THEN BEGIN
              LabelAttribute1."A value" := LabelAttributeValue.Value;
              LabelAttribute1.MODIFY;
            END;
            PageRec1."Link File" := LabelAttributeValue.Value;
          END ELSE
            PageRec1."Link File" := '';
        END;

        LabelAttribute.SETRANGE(Type,LabelAttribute.Type::"9");
        IF LabelAttribute.FINDFIRST THEN BEGIN
          IF LabelAttributeValue.GET(Code,LabelAttribute."Entry No.",LangRec.Code) THEN BEGIN
            LabelAttribute1 := LabelAttribute;
            IF LabelAttributeValue.Value <> '' THEN BEGIN
              LabelAttribute1."A value" := LabelAttributeValue.Value;
              LabelAttribute1.MODIFY;
            END;
            PageRec1."Style Suffix" := LabelAttributeValue.Value;
          END ELSE
            PageRec1."Style Suffix" := '';
        END;
        }
        ePageRec1.MODIFY;
      UNTIL ePageRec.NEXT = 0;
    END;

    PROCEDURE RunSync@1000000002();
    VAR
      LabelForSyncRec@1000000002 : Record 9021618;
      SyncCollection@1000000001 : Record 9021612;
      SyncSingleLabel@1000000003 : Boolean;
      TriggerSync@1000000000 : Codeunit 9021618;
      VersionCalls@1000000004 : Codeunit 9021662;
    BEGIN
      //<MA100416> type field no longer exists...
      //SyncCollection.SETRANGE("Collection Type",SyncCollection."Collection Type"::"1");
      //</MA100416>

      //<EC2013.3.30>
      //IF (NOT mqGLobals.ValidateEnvironment(Code)) THEN
        //this error will never be called as the ValidateEnvironment method always errors if it doesn't return TRUE
      //  ERROR('Error from ValidateEnvironment in RunSync - this should not error here.');
      //</EC2013.3.30>

      IF NOT SyncCollection.FINDFIRST THEN
        ERROR(Text018);
      //DOC EC2013.4.00
      IF VersionCalls.ShowSyncCollection(SyncCollection) THEN BEGIN  //DOC EC2013.4.00
      //IF FORM.RUNMODAL(9021611,SyncCollection,SyncCollection."Include Module in Next Sync")=ACTION::LookupOK THEN BEGIN
        //check whether to include all other Labels...
        IF GUIALLOWED THEN BEGIN
          IF CONFIRM(Text019,TRUE,Code) THEN BEGIN
            //DOC EC2015.5.03 LabelForSyncRec.SETFILTER(Active,'Yes');
            LabelForSyncRec.SETRANGE(Active,TRUE); //DOC EC2015.5.03
          //<MA100416>
          END ELSE BEGIN
            //set to current record only...
            LabelForSyncRec.GET(Code);
            LabelForSyncRec.SETRECFILTER;
            SyncSingleLabel:=TRUE;
            //<MA100416>
          END;
        END;
        IF NOT LabelForSyncRec.FINDFIRST THEN
          IF GUIALLOWED THEN ERROR(Text023) ELSE EXIT;
        TriggerSync.TriggerSync(LabelForSyncRec,SyncSingleLabel);
      END;
    END;

    PROCEDURE SetTemplateAttrOnPageItems@1000000003();
    VAR
      LabelAttValueRec@1000000003 : Record 9021624;
      PageLink@1000000002 : Text[100];
      PageLinkGroupGuid@1000000001 : Integer;
      PageItemRec@1000000000 : Record 9021629;
    BEGIN
      //error if there's neither a template page specified, nor the flag to say use the parent page...
      IF NOT "Page Item Links To Parent Page" THEN BEGIN
        PageLinkGroupGuid:="Page Item Link Guid (Item)";
        IF PageLinkGroupGuid=0 THEN BEGIN
            ERROR(Text021);
          EXIT;
        END;
      END;

      PageItemRec.SETRANGE("Label Code", Code);
      //only process Items, not Content Items...
      //DOC EC2013.3.00 -
      //PageItemRec.SETRANGE(Type, PageItemRec.Type::Item);
      PageItemRec.SETFILTER(Type,'<>%1',PageItemRec.Type::Content);
      //DOC EC2013.3.00 +
      IF PageItemRec.FIND('-') THEN
        REPEAT
          IF "Page Item Links To Parent Page" THEN PageLinkGroupGuid:=PageItemRec."Page GroupGuid";
          PageLink := "Website Page Address" + '?GroupGuid=' + FORMAT(PageLinkGroupGuid);
          LabelAttValueRec.CreateAttributesIfNotExist('TEMPLATE',PageLink,PageItemRec."No.",Code,
                                                      'PRODUCT'); //DOC EC2013.3.00 add ,'PRODUCT'
        UNTIL PageItemRec.NEXT=0;
    END;

    PROCEDURE PopulatePageItemImages@1190000005();
    VAR
      Window@1190000005 : Dialog;
      Total@1190000006 : Integer;
      CountOfLines@1190000007 : Integer;
      Percent@1190000008 : Decimal;
      CommitCount@1190000009 : Integer;
    BEGIN
      PageItemRec.RESET;
      PageItemRec.SETRANGE("Label Code",Code);
      PageItemRec.SETFILTER(Type,'<>%1',PageItemRec.Type::Content);
      CommitCount := 0;
      IF GUIALLOWED THEN BEGIN
        Total := PageItemRec.COUNT;
        CountOfLines := 0;
        Window.OPEN('Populating Images @1@@@@@@@@@@@@@ #2############# #3#############');
        Window.UPDATE(3,Total);
      END;
      IF PageItemRec.FIND('-') THEN
      REPEAT
        IF GUIALLOWED THEN BEGIN
          CountOfLines := CountOfLines + 1;
          Percent := ROUND(CountOfLines / Total * 10000,1);
          Window.UPDATE(1,Percent);
          Window.UPDATE(2,CountOfLines);
        END;
        CommitCount := CommitCount + 1;
        IF CommitCount = 500 THEN BEGIN
          COMMIT;
          CommitCount := 0;
        END;
        PageItemRec.FindImages;
      UNTIL PageItemRec.NEXT = 0;
      IF GUIALLOWED THEN
        Window.CLOSE;
    END;

    BEGIN
    {
      //DOC EC2009.2.72 MA 27/01/2012 - MA120127 Add field 265 ePage Menu Name Max Length - used to allow longer Menu Name at DA but keep shorter elsewhere
      //DOC EC2009.2.72 MQ 19/03/2012 - GW120319 Add field 82 and 83
      //DOC EC2013.3.00 MQ 10/05/2012 - GW120510 Add field 84 and remove reference to Page Item. Page Item Type Code
      //DOC EC2013.3.30 MA 04/12/2012 - MA121204 Add call to ValidateEnvironment in RunSync Function
      //DOC EC2013.3.30 MQ 18/12/2012 - GW121218 Commented this out cos causing problems at DERM.
      //DOC EC2013.3.40 MQ 01/02/2013 - GW130201 Error for DERM on Post Credit on Order Creation
      //DOC EC2013.3.60 MQ 24/04/2013 - GW130424 remove field 55 Page Content Shares Content - only used by Page Item and field removed there
      //DOC EC2013.3.80 MQ 12/08/2013 - GW130812 add field 400 Configured Gateway for PCI and code in Post Credit on Order Creation
      //DOC EC2013.4.00 MQ 04/11/2013 - GW131104 RTC
      //DOC EC2013.4.00 MQ 28/11/2013 - GW131128 Add fields 240 and 242 (for M&C, used in Page Item OnInsert) & ELL
      //DOC EC2013.4.60 MQ 17/04/2014 - GW140417 Add options to field 240 and 242
      //DOC EC2013.4.62 MQ 23/04/2014 - GW140423 Removed field Configured Gateway
      //DOC EC2013.4.63 SB 08/05/2014 - SB140508 Added field 245 (used by LM) to denote that security roles assigned at customer level are inherited by the logins.
      //DOC EC2013.4.63 SB 09/05/2014 - SB150509 Added field 246 (used in LM) when checked every online item will be shown in the "Catalogue Page Guid" page
      //DOC EC2013.4.63 MQ 27/05/2014 - GW140527 Changed field 246 name to AutoPop PageItems to Cat. Page
      //DOC EC2013.4.67 MQ 09/10/2014 - GW141009 Reduced field lengths because table size was approaching limit and add field 280
      //DOC EC2015.5.03 MQ 13/05/2015 - GW150513 Correct problem with Finbrands Germany
      //DOC EC2016.6    JH 05/10/2016 - ECom 2016
    }
    END.
  }
}

