OBJECT Table 9021666 Internet Order Header
{
  OBJECT-PROPERTIES
  {
    Date=24/07/18;
    Time=[ 7:52:39 PM];
    Modified=Yes;
    Version List=EC2016.6,OP9031,OP10987,OP11536;
  }
  PROPERTIES
  {
    OnDelete=VAR
               SalesPayments@1000000000 : Record 50008;
             BEGIN
               //DOC EC2013.3.80 IF "Encrypted Card No." <> '' THEN
               //DOC EC2013.3.80   ERROR(Text008);
               //IF NOT CONFIRM(Text009,FALSE) THEN
               //  ERROR(Text010);

               InternetOrderLine.SETRANGE("Order Guid","Order Guid");
               InternetOrderLine.DELETEALL;
               //DOC OP9031 RK 20/10/16 -
               SalesPayments.SETRANGE("Order Guid","Order Guid");
               SalesPayments.DELETEALL;
               //DOC OP9031 RK 20/10/16 +
               //DOC EC2013.3.60 -
               LinkedAtValWeb.RESET;
               LinkedAtValWeb.SETCURRENTKEY("Label Code","Table Name","Key Field String 1");
               LinkedAtValWeb.SETRANGE("Label Code","Label Code");
               LinkedAtValWeb.SETRANGE("Table Name",'ShopSalesHeader');
               LinkedAtValWeb.SETRANGE("Key Field String 1","Order Guid");
               LinkedAtValWeb.DELETEALL(TRUE);
               //DOC EC2013.3.60 +
             END;

    CaptionML=[ENU=Internet Order;
               ENG=Internet Order];
    LookupPageID=Page9021729;
    DrillDownPageID=Page9021729;
  }
  FIELDS
  {
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                CALCFIELDS(
                                                                  "Sell-to Customer Name",
                                                                  "Sell-to Address",
                                                                  "Sell-to Address 2",
                                                                  "Sell-to Post Code",
                                                                  "Sell-to City",
                                                                  "Sell-to Contact");
                                                              END;

                                                   CaptionML=[DAN=Kundenr.;
                                                              DEU=Verkauf an Kunde Nr.;
                                                              ENU=Sell-to Customer No.;
                                                              ESP=Venta a-Nß cliente;
                                                              SVE=Fîrs.kundnr;
                                                              ENG=Sell-to Customer No.] }
    { 5   ;   ;Bill-to Name        ;Text50        ;CaptionML=[DAN=Navn;
                                                              DEU=Rechnung an Name;
                                                              ENU=Bill-to Name;
                                                              ESP=Fact. a-Nombre;
                                                              SVE=Faktureras namn;
                                                              ENG=Bill-to Name] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[ENU=Bill-to Name 2;
                                                              ENG=Bill-to Name 2] }
    { 7   ;   ;Bill-to Address     ;Text50        ;CaptionML=[DAN=Adresse;
                                                              DEU=Rechnung an Adresse;
                                                              ENU=Bill-to Address;
                                                              ESP=Fact. a-Direcci¢n;
                                                              SVE=Faktureras adress;
                                                              ENG=Bill-to Address] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;CaptionML=[DAN=Adresse 2;
                                                              DEU=Rechnung an Adresse 2;
                                                              ENU=Bill-to Address 2;
                                                              ESP=Fact. a-Direcci¢n 2;
                                                              SVE=Faktureras adress 2;
                                                              ENG=Bill-to Address 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;CaptionML=[DAN=By;
                                                              DEU=Rechnung an Stadt;
                                                              ENU=Bill-to City;
                                                              ESP=Fact. a-Poblaci¢n;
                                                              SVE=Faktureras ort;
                                                              ENG=Bill-to City] }
    { 10  ;   ;Bill-to Contact     ;Text50        ;CaptionML=[DAN=Attention;
                                                              DEU=Rechnung an Kontakt;
                                                              ENU=Bill-to Contact;
                                                              ESP=Fact. a-Atenci¢n;
                                                              SVE=Faktureras kontaktperson;
                                                              ENG=Bill-to Contact] }
    { 13  ;   ;Ship-to Name        ;Text50        ;CaptionML=[DAN=Leveringsnavn;
                                                              DEU=Lieferung an Name;
                                                              ENU=Ship-to Name;
                                                              ESP=Env°o a-Nombre;
                                                              SVE=Leveransnamn;
                                                              ENG=Ship-to Name] }
    { 15  ;   ;Ship-to Address     ;Text50        ;CaptionML=[DAN=Leveringsadresse;
                                                              DEU=Lieferung an Adresse;
                                                              ENU=Ship-to Address;
                                                              ESP=Env°o a-Direcci¢n;
                                                              SVE=Leveransadress;
                                                              ENG=Ship-to Address] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[DAN=Leveringsadresse 2;
                                                              DEU=Lieferung an Adresse 2;
                                                              ENU=Ship-to Address 2;
                                                              ESP=Env°o a-Direcci¢n 2;
                                                              SVE=Leveransadress 2;
                                                              ENG=Ship-to Address 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;CaptionML=[DAN=Leveringsby;
                                                              DEU=Lieferung an Stadt;
                                                              ENU=Ship-to City;
                                                              ESP=Env°o a-Poblaci¢n;
                                                              SVE=Leveransort;
                                                              ENG=Ship-to City] }
    { 18  ;   ;Ship-to Contact     ;Text50        ;CaptionML=[DAN=Leveres attention;
                                                              DEU=Lieferung an Kontakt;
                                                              ENU=Ship-to Contact;
                                                              ESP=Env°o a-Atenci¢n;
                                                              SVE=Leveranskontaktperson;
                                                              ENG=Ship-to Contact] }
    { 19  ;   ;Order Date          ;Date          ;CaptionML=[DAN=Ordredato;
                                                              DEU=Bestelldatum;
                                                              ENU=Order Date;
                                                              ESP=Fecha pedido;
                                                              SVE=Orderdatum;
                                                              ENG=Order Date] }
    { 21  ;   ;Shipment Date       ;Date          ;CaptionML=[DAN=Leveringsdato;
                                                              DEU=Lieferdatum;
                                                              ENU=Shipment Date;
                                                              ESP=Fecha env°o;
                                                              SVE=Utleveransdatum;
                                                              ENG=Shipment Date] }
    { 32  ;   ;Currency Code       ;Code10        ;CaptionML=[DAN=Valutakode;
                                                              DEU=WÑhrungscode;
                                                              ENU=Currency Code;
                                                              ESP=C¢d. divisa;
                                                              SVE=Valutakod;
                                                              ENG=Currency Code] }
    { 35  ;   ;Prices Including VAT;Boolean       ;CaptionML=[ENU=Prices Including VAT;
                                                              ENG=Prices Including VAT] }
    { 43  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[DAN=Sëlgerkode;
                                                              DEU=VerkÑufercode;
                                                              ENU=Salesperson Code;
                                                              ESP=C¢d. vendedor;
                                                              SVE=SÑljarkod;
                                                              ENG=Salesperson Code] }
    { 60  ;   ;Amount              ;Decimal       ;CaptionML=[DAN=Belõb;
                                                              DEU=Betrag;
                                                              ENU=Amount;
                                                              ESP=Importe;
                                                              SVE=Belopp;
                                                              ENG=Amount];
                                                   BlankZero=Yes }
    { 61  ;   ;Amount Including Tax;Decimal       ;CaptionML=[DAN=Belõb Inkl. Moms;
                                                              DEU=Betrag inkl. MWSt.;
                                                              ENU=Amount Including Tax;
                                                              ESP=Importe IVA incl.;
                                                              SVE=Belopp inklusive moms;
                                                              ENG=Amount Including Tax] }
    { 79  ;   ;Sell-to Customer Name;Text50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   CaptionML=[DAN=Kundenavn;
                                                              DEU=Verkauf an Kundenname;
                                                              ENU=Sell-to Customer Name;
                                                              ESP=Venta a-Nombre;
                                                              SVE=Kundnamn;
                                                              ENG=Sell-to Customer Name];
                                                   Editable=No }
    { 81  ;   ;Sell-to Address     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Address WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   CaptionML=[DAN=Kundeadresse;
                                                              DEU=Verkauf an Adresse;
                                                              ENU=Sell-to Address;
                                                              ESP=Venta a-Direcci¢n;
                                                              SVE=Kundadress;
                                                              ENG=Sell-to Address];
                                                   Editable=No }
    { 82  ;   ;Sell-to Address 2   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Address 2" WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   CaptionML=[DAN=Kundeadresse 2;
                                                              DEU=Verkauf an Adresse 2;
                                                              ENU=Sell-to Address 2;
                                                              ESP=Venta a-Direcci¢n 2;
                                                              SVE=Kundadress 2;
                                                              ENG=Sell-to Address 2];
                                                   Editable=No }
    { 83  ;   ;Sell-to City        ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.City WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   CaptionML=[DAN=Kundeby;
                                                              DEU=Verkauf an Stadt;
                                                              ENU=Sell-to City;
                                                              ESP=Venta a-Poblaci¢n;
                                                              SVE=Kundort;
                                                              ENG=Sell-to City];
                                                   Editable=No }
    { 84  ;   ;Sell-to Contact     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Contact WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   CaptionML=[DAN=Kundeattention;
                                                              DEU=Verkauf an Kontakt;
                                                              ENU=Sell-to Contact;
                                                              ESP=Venta a-Atenci¢n;
                                                              SVE=Kundkontaktperson;
                                                              ENG=Sell-to Contact];
                                                   Editable=No }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   CaptionML=[DAN=Postnr.;
                                                              DEU=Verkauf an PLZ;
                                                              ENU=Bill-to Post Code;
                                                              ESP=Fact. a-C.P.;
                                                              SVE=Faktureras postnr;
                                                              ENG=Bill-to Post Code] }
    { 86  ;   ;Bill-to State       ;Text30        ;CaptionML=[DAN=Stat;
                                                              DEU=Verkauf an Staat;
                                                              ENU=Bill-to County;
                                                              ESP=Fact. a-Provincia;
                                                              SVE=Faktureras land;
                                                              ENG=Bill-to County] }
    { 88  ;   ;Sell-to Post Code   ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Post Code" WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[DAN=Kundepostnr.;
                                                              DEU=Verkauf an PLZ;
                                                              ENU=Sell-to Post Code;
                                                              ESP=Venta a-C.P.;
                                                              SVE=Kundpostnrkod;
                                                              ENG=Sell-to Post Code];
                                                   Editable=No }
    { 89  ;   ;Sell-to State       ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.County WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   CaptionML=[DAN=Kundestat;
                                                              DEU=Verkauf an Staat;
                                                              ENU=Sell-to County;
                                                              ESP=Venta a-Provincia;
                                                              SVE=SÑljarens stat;
                                                              ENG=Sell-to County] }
    { 90  ;   ;Bill-to Country Code;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Kundelandekode;
                                                              DEU=Rechnung an LÑndercode;
                                                              ENU=Bill-to Country Code;
                                                              ESP=Fact. a-C¢d. pa°s;
                                                              SVE=Faktureras land;
                                                              ENG=Bill-to Country Code] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   CaptionML=[DAN=Leveringspostnr.;
                                                              DEU=Lieferung an PLZ;
                                                              ENU=Ship-to Post Code;
                                                              ESP=Env°o a-C.P.;
                                                              SVE=Leveranspostnrkod;
                                                              ENG=Ship-to Post Code] }
    { 92  ;   ;Ship-to State       ;Text30        ;CaptionML=[DAN=Leveringsstat;
                                                              DEU=Lieferung an Staat;
                                                              ENU=Ship-To County;
                                                              ESP=Env°o a-Provincia;
                                                              SVE=Leverans stat;
                                                              ENG=Ship-To County] }
    { 93  ;   ;Ship-to Country Code;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Leveringslandekode;
                                                              DEU=Lieferung an LÑndercode;
                                                              ENU=Ship-to Country Code;
                                                              ESP=Env°o a-C¢d. pa°s;
                                                              SVE=Leveranslandkod;
                                                              ENG=Ship-to Country Code] }
    { 200 ;   ;User GUID           ;Text38        ;CaptionML=[ENU=User GUID;
                                                              ENG=User GUID];
                                                   Description=GW add 130404 }
    { 201 ;   ;Internet Customer Contact Name;Text50;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Internet Customers".Contact WHERE (No.=FIELD(User GUID)));
                                                   CaptionML=[ENU=Internet Customer Contact Name;
                                                              ENG=Internet Customer Contact Name];
                                                   Description=MA add 130412;
                                                   Editable=No }
    { 204 ;   ;Split Orders        ;Boolean       ;CaptionML=[ENU=Split Orders;
                                                              ENG=Split Orders];
                                                   Description=GW add 130416 }
    { 206 ;   ;Order Type          ;Option        ;CaptionML=[ENU=Order Type;
                                                              ENG=Order Type];
                                                   OptionCaptionML=[ENU=" ,Return";
                                                                    ENG=" ,Return"];
                                                   OptionString=[ ,Return];
                                                   Description=GW add 131016 }
    { 38700;  ;Internet Order Reference;Code20    ;CaptionML=[DAN=Kunde reference nr.;
                                                              DEU=Kundenreferenznummer;
                                                              ENU=Internet Order Reference;
                                                              ESP=Nß Referencia cliente;
                                                              SVE=Kundreferensnr;
                                                              ENG=Internet Order Reference] }
    { 38701;  ;Bill-to Net Customer No.;Text38    ;OnLookup=BEGIN
                                                              IF IsB2BCustomer THEN BEGIN
                                                                //FORM.RUNMODAL(22,Customer);
                                                                VersionCalls.ShowCust(Customer); //DOC EC2013.4.00
                                                              END ELSE BEGIN
                                                                InternetCustomer.RESET;
                                                                InternetCustomer.GET("Bill-to Net Customer No.");
                                                                //FORM.RUNMODAL(9021719,InternetCustomer);
                                                                VersionCalls.ShowIntCust(InternetCustomer); //DOC EC2013.4.00
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Internet-kundenr.;
                                                              DEU=Rechnung an Net Kundennummer;
                                                              ENU=Bill-to Net Customer No.;
                                                              ESP=Fact. a-Nß Cliente Internet;
                                                              SVE=Faktureras nÑt kundnr;
                                                              ENG=Bill-to Net Customer No.];
                                                   Editable=No }
    { 38702;  ;Status              ;Option        ;OnValidate=BEGIN
                                                                //DOC EC2013.3.20 -
                                                                IF Status = Status::Rejected THEN BEGIN
                                                                  //DOC EC2013.3.50 -
                                                                  StockUsed.INIT;
                                                                  StockUsed."Order Header GuID" := "Order Guid";
                                                                  StockUsed."Label Code"  := "Label Code";
                                                                  StockUsed.DateTimeCreated := CURRENTDATETIME;
                                                                  IF StockUsed.INSERT THEN; //if previously Rejected there will already be an entry.
                                                                  //DOC EC2013.3.50 +
                                                                  //DOC EC2013.3.60 - Code from Reject Order on Card
                                                                  //DOC EC2013.3.8 "Encrypted Card No." := '';
                                                                  //DOC EC2013.3.8 "Encrypted Security Code" := '';
                                                                  InternetOrderLine.RESET;
                                                                  InternetOrderLine.SETRANGE("Order Guid","Order Guid");
                                                                  InternetOrderLine.MODIFYALL(Status,InternetOrderLine.Status::Rejected);
                                                                  //DOC EC2013.3.60 +
                                                                END;
                                                                //DOC EC2013.3.20 +

                                                                //IF Status IN [Status::Rejected,Status::Invalid] THEN
                                                                //  WFlowIn.Simple('INTERNET_ORDER_FAULT',Rec.GETPOSITION);
                                                              END;

                                                   CaptionML=[DAN=Status;
                                                              DEU=Status;
                                                              ENU=Status;
                                                              ESP=Estado;
                                                              SVE=Status;
                                                              ENG=Status];
                                                   OptionCaptionML=[DAN=Ny,Overfõrt,Afvist,Invalid,Multiple;
                                                                    DEU=Neu,öbernommen,Abgelehnt,Invalid,Multiple;
                                                                    ENU=New,Converted,Rejected,Invalid,Multiple;
                                                                    ESP=Nuevo, convertido, rechazado,invalid,multiple;
                                                                    SVE=Ny,GodkÑnd,Avbruten,Invalid,Multiple;
                                                                    ENG=New,Converted,Rejected,Invalid,Multiple];
                                                   OptionString=New,Converted,Rejected,Invalid,Multiple;
                                                   Description=MQ 21/01/2013 - GW130121 add Option Multiple }
    { 38703;  ;Converted-To Document No.;Code20   ;TableRelation="Sales Header".No.;
                                                   OnLookup=BEGIN
                                                              IF "Converted-To Document No." <> '' THEN BEGIN
                                                                IF SalesHeader.GET("Converted-To Document Type","Converted-To Document No.") THEN
                                                                  CASE "Converted-To Document Type" OF
                                                                    "Converted-To Document Type"::Quote:
                                                                      //FORM.RUN(FORM::"Sales Quote",SalesHeader);
                                                                      //DOC EC2015.5.04 ERROR('Not supported');
                                                                      VersionCalls.ShowSalesQuote(SalesHeader); //DOC EC2015.5.04
                                                                    "Converted-To Document Type"::Order:
                                                                      //FORM.RUN(FORM::"Sales Order",SalesHeader);
                                                                      VersionCalls.ShowSalesOrder(SalesHeader); //DOC EC2013.4.00
                                                                    "Converted-To Document Type"::Invoice:
                                                                      //FORM.RUN(FORM::"Sales Invoice",SalesHeader);
                                                                      ERROR(TxtNotSupported);
                                                                  END
                                                                ELSE
                                                                  MESSAGE(
                                                                    Text000,
                                                                    "Converted-To Document Type","Converted-To Document No.");
                                                              END;
                                                            END;

                                                   CaptionML=[DAN=Konveret til Bilagsnr.;
                                                              DEU=öbernommen fÅr Dokument Nr.;
                                                              ENU=Converted-To Document No.;
                                                              ESP=Convertido a Nß Documento;
                                                              SVE=Utbytt till dokumentnr;
                                                              ENG=Converted-To Document No.] }
    { 38704;  ;Converted-To Document Type;Option  ;CaptionML=[DAN=Konveret til Bilagstype;
                                                              DEU=öbernommen fÅr Dokumenttyp;
                                                              ENU=Converted-To Document Type;
                                                              ESP=Convertido a Tipo Documento;
                                                              SVE=Utbytt till dokumenttyp;
                                                              ENG=Converted-To Document Type];
                                                   OptionCaptionML=[DAN=Tilbud,Ordre,Faktura,blank,Multiple,Return;
                                                                    DEU=Anfrage,Bestellung,Rechnung,blank,Multiple,Return;
                                                                    ENU=Quote,Order,Invoice,blank,Multiple,Return;
                                                                    ESP=Oferta,Pedido,Factura,blank,Multiple,Return;
                                                                    SVE=Offert,Order,Faktura,blank,Multiple,Return;
                                                                    ENG=Quote,Order,Invoice,blank,Multiple,Return];
                                                   OptionString=Quote,Order,Invoice,blank,Multiple,Return;
                                                   Description=MQ 21/12/2013 - GW131221 add blank and Multiple }
    { 38705;  ;Bill-to E-Mail      ;Text80        ;CaptionML=[DAN=e-mail;
                                                              DEU=Rechnung an e-mail;
                                                              ENU=Bill-to E-Mail;
                                                              ESP=Fact. a-E-Mail;
                                                              SVE=Faktureras E-post;
                                                              ENG=Bill-to E-Mail] }
    { 38706;  ;Payment Method Code ;Text30        ;TableRelation="Payment Method";
                                                   CaptionML=[DAN=Betalingstype;
                                                              DEU=Zahlungstyp;
                                                              ENU=Payment Method Code;
                                                              ESP=TÇrminos pago;
                                                              SVE=Betalningstyp;
                                                              ENG=Payment Method Code];
                                                   Description=MQ 05/05/2011 - GW110505 renamed Payment Method Code from Payment Type - should be C20 }
    { 38711;  ;Invoice Discount    ;Decimal       ;CaptionML=[DAN=Faktura rabat;
                                                              DEU=Rechnungsrabatt;
                                                              ENU=Invoice Discount;
                                                              ESP=Descuento Fact.;
                                                              SVE=Fakturarabatt;
                                                              ENG=Invoice Discount] }
    { 38712;  ;Service Charge      ;Decimal       ;CaptionML=[DAN=Servicegebyr;
                                                              DEU=Servicekosten;
                                                              ENU=Service Charge;
                                                              ESP=Cargo Servicio;
                                                              SVE=Faktureringsavgift;
                                                              ENG=Service Charge] }
    { 38713;  ;Comment             ;Text80        ;CaptionML=[DAN=Kommentar;
                                                              DEU=Bemerkung;
                                                              ENU=Comment;
                                                              ESP=Comentario;
                                                              SVE=Kommentar;
                                                              ENG=Comment] }
    { 38714;  ;Your Reference      ;Text30        ;CaptionML=[DAN=Kunde indkõbsnummer;
                                                              DEU=Kunden P.O. Nr.;
                                                              ENU=Your Reference;
                                                              ESP=Nß Ref. Cliente;
                                                              SVE=Inkîpsordernr;
                                                              ENG=Your Reference] }
    { 38715;  ;Order Guid          ;Text38        ;CaptionML=[DAN=Ordre Guid;
                                                              DEU=Bestellhinweis;
                                                              ENU=Order Guid;
                                                              ESP=Nß Pedido;
                                                              SVE=Orderstyrning;
                                                              ENG=Order Guid] }
    { 38716;  ;Ship-to E-Mail      ;Text80        ;CaptionML=[DAN=Levering E-mail;
                                                              DEU=Lieferung an e-mail;
                                                              ENU=Ship-to E-Mail;
                                                              ESP=Env°o a-E-Mail;
                                                              SVE=Leverans till E-post;
                                                              ENG=Ship-to E-Mail] }
    { 38717;  ;Bill-to County      ;Text30        ;CaptionML=[DAN=Amt;
                                                              DEU=Rechnung an Bezirk;
                                                              ENU=Bill-to County;
                                                              ESP=Fact. a-Provincia;
                                                              SVE=Faktureras delstat;
                                                              ENG=Bill-to County] }
    { 38718;  ;Ship-to County      ;Text30        ;CaptionML=[DAN=Leveringsamt;
                                                              DEU=Lieferung an Bezirk;
                                                              ENU=Ship-to County;
                                                              ESP=Env°o a-Provincia;
                                                              SVE=Leveransdelstat;
                                                              ENG=Ship-to County] }
    { 38719;  ;Document Type       ;Text30        ;CaptionML=[DAN=Dokumenttype;
                                                              DEU=Dokumenttyp;
                                                              ENU=Document Type;
                                                              ESP=Tipo documento;
                                                              SVE=Dokumenttyp;
                                                              ENG=Document Type] }
    { 38720;  ;Shipping Agent Code ;Text38        ;TableRelation="Shipping Agent";
                                                   CaptionML=[DAN=Speditõrkode;
                                                              DEU=Versand Agentencode;
                                                              ENU=Shipping Agent Code;
                                                              ESP=C¢d. transportista;
                                                              SVE=Speditîrkod;
                                                              ENG=Shipping Agent Code];
                                                   Description=EC2016.1.1 table rel. from '' to Shipping Agent }
    { 38721;  ;Shipping Amount     ;Decimal       ;CaptionML=[DAN=Leveringsgebyr;
                                                              DEU=Versandwert;
                                                              ENU=Shipping Amount;
                                                              ESP=Importe;
                                                              SVE=Leveransbelopp;
                                                              ENG=Shipping Amount] }
    { 38722;  ;Handling Amount     ;Decimal       ;CaptionML=[DAN=Ekspeditionsgebyr 2;
                                                              DEU=Bearbeitungswert;
                                                              ENU=Handling Amount;
                                                              ESP=Importe pendiente;
                                                              SVE=Hanteringsbelopp;
                                                              ENG=Handling Amount] }
    { 38723;  ;Payment Fee Amount  ;Decimal       ;CaptionML=[DAN=Betalingsgebyr;
                                                              DEU=ZahlungsgebÅhr Betrag;
                                                              ENU=Payment Fee Amount;
                                                              ESP=Payment Fee Amount;
                                                              SVE=Betalningsavgift;
                                                              ENG=Payment Fee Amount] }
    { 38725;  ;Inventory Location  ;Code10        ;TableRelation=Location;
                                                   CaptionML=[DAN=Lokationskode;
                                                              DEU=Inventur Lokation;
                                                              ENU=Inventory Location;
                                                              ESP=Localizaci¢n de Inventario;
                                                              SVE=Lagerplats;
                                                              ENG=Inventory Location] }
    { 38726;  ;Handling Amount Including Tax;Decimal;
                                                   CaptionML=[ENU=Handling Amount Including Tax;
                                                              ENG=Handling Amount Including Tax];
                                                   Description=MQ 11/10/2011 - GW111011 }
    { 38727;  ;Payment Fee Amount Incl. Tax;Decimal;
                                                   CaptionML=[ENU=Payment Fee Amount Incl. Tax;
                                                              ENG=Payment Fee Amount Incl. Tax];
                                                   Description=MQ 11/10/2011 - GW111011 }
    { 50000;  ;Ship-to Phone No.   ;Text30        ;Description=OP9031 }
    { 50005;  ;Shipment ID         ;Code30        ;Description=OP9031 }
    { 50006;  ;Gift                ;Boolean       ;Description=M0063 DD 27/10/16 }
    { 50007;  ;Gift Message        ;Text250       ;Description=M0063 DD 27/10/16 }
    { 50008;  ;File Name           ;Text150       ;Description=OP9031 }
    { 50010;  ;Validation Error    ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Integration Error Log" WHERE (Source Type=CONST(9021667),
                                                                                                    Document No.=FIELD(Internet Order Reference)));
                                                   Description=OP9031;
                                                   Editable=No }
    { 50011;  ;Bill-to Address 3   ;Text50        ;Description=OP9031 }
    { 50012;  ;Ship-to Address 3   ;Text50        ;Description=OP9031 }
    { 50013;  ;Marketing ID        ;Text150       ;Description=OP9031 }
    { 50014;  ;Ship-to Name 2      ;Text50        ;Description=OP9031 }
    { 50016;  ;Total Tax Amount    ;Decimal       ;CaptionML=[ENU=Total Tax Amount;
                                                              ENG=Total Tax Amount];
                                                   Description=OP9031 }
    { 50020;  ;Shipment Method     ;Code20        ;Description=OP9031 }
    { 50025;  ;Package Type        ;Code20        ;Description=OP11536 }
    { 50030;  ;Customer Locale     ;Text3         ;Description=OP10987 }
    { 50040;  ;Original Order No.  ;Code20         }
    { 50041;  ;Original Order GUID ;Text38         }
    { 50042;  ;Farfetch Order      ;Boolean        }
    { 73506;  ;Enterprise Instance ;Code20        ;CaptionML=[ENU=Enterprise Instance;
                                                              ENG=Enterprise Instance];
                                                   Description=GW add 140613 PCI compatibility }
    { 75000;  ;Label Code          ;Code10        ;TableRelation=Label;
                                                   CaptionML=[ENU=Label Code;
                                                              ENG=Label Code];
                                                   Description=EC2016.1.1 }
    { 75002;  ;Recurring Order Counter;Integer    ;CaptionML=[ENU=Recurring Order Counter;
                                                              ENG=Recurring Order Counter];
                                                   Description=GW add 130920 for PCI compatibility }
    { 75017;  ;Internet Source Code;Code20        ;TableRelation="Marketing Source Code";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Internet Source Code;
                                                              ENG=Internet Source Code];
                                                   Description=EC2016.1.1 }
    { 75035;  ;Shipping Amount Incl. Tax;Decimal  ;CaptionML=[ENU=Shipping Amount Incl. Tax;
                                                              ENG=Shipping Amount Incl. Tax];
                                                   Description=EC2016.1.1 }
    { 75058;  ;Salesperson Discount %;Decimal     ;CaptionML=[ENU=Salesperson Discount %;
                                                              ENG=Salesperson Discount %];
                                                   Description=EC2016.1.1 }
    { 75062;  ;Invoice Discount Incl. VAT;Decimal ;CaptionML=[ENU=Invoice Discount Incl. VAT;
                                                              ENG=Invoice Discount Incl. VAT];
                                                   Description=EC2016.1.1 }
    { 75063;  ;Invoice Discount %  ;Decimal       ;CaptionML=[ENU=Invoice Discount %;
                                                              ENG=Invoice Discount %];
                                                   Description=EC2009.2.03 }
    { 75066;  ;Posted Document No. ;Code20        ;CaptionML=[ENU=Posted Document No.;
                                                              ENG=Posted Document No.];
                                                   Description=EC2016.1.1 }
    { 75067;  ;Posted Posting Date ;Date          ;CaptionML=[ENU=Posted Posting Date;
                                                              ENG=Posted Posting Date];
                                                   Description=EC2016.1.1 }
    { 75068;  ;Ship-to Address Code;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   CaptionML=[ENU=Ship-to Address Code;
                                                              ENG=Ship-to Address Code];
                                                   Description=EC2016.1.1 }
    { 75069;  ;DateTime Created    ;DateTime      ;CaptionML=[ENU=DateTime Created;
                                                              ENG=DateTime Created];
                                                   Description=EC2016.1.1 }
    { 75071;  ;Promo Discount %    ;Decimal       ;CaptionML=[ENU=Promo Discount %;
                                                              ENG=Promo Discount %];
                                                   Description=EC2009.2.03 }
    { 75072;  ;Promo Discount Amt  ;Decimal       ;CaptionML=[ENU=Promo Discount Amt;
                                                              ENG=Promo Discount Amt];
                                                   Description=EC2016.1.1 }
    { 75073;  ;Promo Discount Amt Incl Tax;Decimal;CaptionML=[ENU=Promo Discount Amt Incl Tax;
                                                              ENG=Promo Discount Amt Incl Tax];
                                                   Description=EC2016.1.1 }
    { 75074;  ;Internet Customer Phone No.;Text80 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Internet Customers"."Phone No." WHERE (No.=FIELD(Bill-to Net Customer No.)));
                                                   CaptionML=[ENU=Internet Customer Phone No.;
                                                              ENG=Internet Customer Phone No.];
                                                   Description=flowfield;
                                                   Editable=No }
    { 75075;  ;Total Discount %    ;Decimal       ;CaptionML=[ENU=Total Discount %;
                                                              ENG=Total Discount %] }
    { 75076;  ;Total Discount Amt  ;Decimal       ;CaptionML=[ENU=Total Discount Amt;
                                                              ENG=Total Discount Amt] }
    { 75077;  ;Total Discount Amt Incl Tax;Decimal;CaptionML=[ENU=Total Discount Amt Incl Tax;
                                                              ENG=Total Discount Amt Incl Tax] }
    { 75078;  ;No. Of Internet Order Lines;Integer;CaptionML=[ENU=No. Of Internet Order Lines;
                                                              ENG=No. Of Internet Order Lines];
                                                   Description=GW add 101124 }
    { 75079;  ;No. Of Payment Entries;Integer     ;CaptionML=[ENU=No. Of Payment Entries;
                                                              ENG=No. Of Payment Entries];
                                                   Description=GW add 110427 }
    { 75082;  ;Last Errored Convert-To Doc No;Code20;
                                                   TableRelation="Sales Header".No.;
                                                   OnLookup=BEGIN
                                                              IF "Converted-To Document No." <> '' THEN BEGIN
                                                                IF SalesHeader.GET("Converted-To Document Type","Converted-To Document No.") THEN
                                                                  CASE "Converted-To Document Type" OF
                                                                    "Converted-To Document Type"::Quote:
                                                                      //FORM.RUN(FORM::"Sales Quote",SalesHeader);
                                                                      ERROR(TxtNotSupported);
                                                                    "Converted-To Document Type"::Order:
                                                                      //FORM.RUN(FORM::"Sales Order",SalesHeader);
                                                                      VersionCalls.ShowSalesOrder(SalesHeader); //DOC EC2013.4.00
                                                                    "Converted-To Document Type"::Invoice:
                                                                      //FORM.RUN(FORM::"Sales Invoice",SalesHeader);
                                                                      ERROR(TxtNotSupported);
                                                                  END
                                                                ELSE
                                                                  MESSAGE(
                                                                    Text000,
                                                                    "Converted-To Document Type","Converted-To Document No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Last Errored Convert-To Doc No;
                                                              ENG=Last Errored Convert-To Doc No];
                                                   Description=GW add 110509 }
    { 75083;  ;No. Of Promotion Entry Lines;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Promotion Ledger Entry" WHERE (Order GuID=FIELD(Order Guid)));
                                                   CaptionML=[ENU=No. Of Promotion Entry Lines;
                                                              ENG=No. Of Promotion Entry Lines];
                                                   Description=GW 120511 now flowfield }
    { 75084;  ;Processing In Progress;Boolean     ;CaptionML=[ENU=Processing In Progress;
                                                              ENG=Processing In Progress];
                                                   Description=GW add 110518 }
    { 75086;  ;Phone No.           ;Text80        ;CaptionML=[ENU=Phone No.;
                                                              ENG=Phone No.];
                                                   Description=GW add 110608 }
    { 75088;  ;Shipping Agent Service Code;Code10 ;CaptionML=[ENU=Shipping Agent Service Code;
                                                              ENG=Shipping Agent Service Code];
                                                   Description=GW 111011 }
    { 75090;  ;Customer Is B2B     ;Boolean       ;CaptionML=[ENU=Customer Is B2B;
                                                              ENG=Customer Is B2B];
                                                   Description=GW add 111027 }
    { 75092;  ;No. of Web Attributes;Integer      ;CaptionML=[ENU=No. of Web Attributes;
                                                              ENG=No. of Web Attributes];
                                                   Description=EC2013.3.30 GW add 121109 was flowfield, EC2013.3.40 changed to Normal 130123 }
    { 75094;  ;Comment Exists      ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Web Comment Line" WHERE (Label Code=FIELD(Label Code),
                                                                                               Header Guid=FIELD(Order Guid)));
                                                   CaptionML=[ENU=Comment Exists;
                                                              ENG=Comment Exists];
                                                   Description=EC2013.3.30 GW add 121115 }
    { 75095;  ;Field Update Exists ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Field Update from Web" WHERE (Label Code=FIELD(Label Code),
                                                                                                    Table Name=CONST(ShopSalesHeader),
                                                                                                    Table Primary Key=FIELD(Order Guid)));
                                                   CaptionML=[ENU=Field Update Exists;
                                                              ENG=Field Update Exists];
                                                   Description=EC2013.3.30 GW add 121115 }
    { 75096;  ;Mail Sent           ;Boolean       ;CaptionML=[ENU=Mail Sent;
                                                              ENG=Mail Sent];
                                                   Description=EC2013.3.30 GW add 121212 }
    { 75097;  ;VAT Adjusted        ;Boolean       ;CaptionML=[ENU=VAT Adjusted;
                                                              ENG=VAT Adjusted];
                                                   Description=EC2013.3.60 GW add 130522 }
    { 75098;  ;Create IPI          ;Boolean       ;CaptionML=[ENU=Create IPI;
                                                              ENG=Create IPI];
                                                   Description=EC2013.3.60 GW add 130610 }
  }
  KEYS
  {
    {    ;Order Guid                              ;Clustered=Yes }
    {    ;Internet Order Reference                 }
    {    ;Bill-to Net Customer No.,Order Date      }
    {    ;Sell-to Customer No.                     }
    {    ;Converted-To Document No.                }
    {    ;Order Date                               }
    {    ;DateTime Created                         }
    {    ;Status                                   }
    {    ;Salesperson Code                         }
    {    ;File Name                                }
    {    ;Status,Order Type                        }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Customer@1000000008 : Record 18;
      InternetShopSetup@1000000000 : Record 9021609;
      InternetCustomer@1000000001 : Record 9021642;
      InternetOrderHeader@1000000002 : Record 9021666;
      InternetOrderLine@1000000003 : Record 9021667;
      SalesHeader@1000000004 : Record 36;
      LinkedAtValWeb@1000000014 : Record 9021683;
      Text000@1000000006 : TextConst 'DAN=%1 %2 eksisterer ikke lëngere. Den kan vëre overfõrt til en ordre eller bogfõrt.;DEU=%1 %2 existiert nicht lÑnger. Es kînnte in einer Verkaufsbestellung oder versendet sein.;ENU=%1 %2 no longer exists. It could have been converted to a sales order or posted.;ESP=%1 %2 ya no existe. Podr°a haber sido convertido a un pedido o enviado.;SVE=%1 %2 finns inte. Den kan ha îverfîrts till sÑljorder eller blivit bokfîrd.;ENG=%1 %2 no longer exists. It could have been converted to a sales order or posted.';
      Text001@1000000007 : TextConst 'DAN=Vil du ëndre status pÜ %1 %2 til ''''Ny''''?;DEU=WÅnschen Sie den Status von %1 %2 auf ''''new'''' zu verÑndern?;ENU=Do you want to change status on %1 %2 to ''''new''''?\\If you do another sales order will be created even if one has already been created.;ESP=Desea cambiar el estado a %1 %2 o ''''nuevo''''?;SVE=Vill du Ñndra status pÜ %1 %2 till ''''ny'''';ENG=Do you want to change status on %1 %2 to ''''new''''?\\If you do another sales order will be created even if one has already been created.';
      LabelRec@1040001 : Record 9021618;
      Text002@1000000010 : TextConst 'ENU=You cannot set the Status to Rejected as some Payment Entries have been Processed.;ENG=You cannot set the Status to Rejected as some Payment Entries have been Processed.';
      Text003@1040002 : TextConst 'ENU=You cannot change the status of a converted order.;ENG=You cannot change the status of a converted order.';
      Text004@1000000015 : TextConst 'ENU=This will allow you to set the Status to New on this order.\\Only proceed if you are certain you understand the consequences.\\Are you sure?;ENG=This will allow you to set the Status to New on this order.\\Only proceed if you are certain you understand the consequences.\\Are you sure?';
      Text005@1000000016 : TextConst 'ENU=Change Abandonned.;ENG=Change Abandonned.';
      Text006@1000000011 : TextConst 'ENU=The Converted-to Document No. is not blank.  Are you sure you have first deleted the Sales %1 %2?;ENG=The Converted-to Document No. is not blank.  Are you sure you have first deleted the Sales %1 %2?';
      Text007@1000000017 : TextConst 'ENU=&Do NOT change the status of a converted order,&Continue to reset Status.  Do NOT use unless you want to create duplicates.;ENG=&Do NOT change the status of a converted order,&Continue to reset Status.  Do NOT use unless you want to create duplicates.';
      Text008@1040003 : TextConst 'ENU=.;ENG=.';
      Text009@1040004 : TextConst 'ENU=Are you really sure you what to delete this internet order?;ENG=Are you really sure you what to delete this internet order?';
      Text010@1040005 : TextConst 'ENU=Delete Abandonned.;ENG=Delete Abandonned.';
      Text011@1040006 : TextConst 'ENU=You cannot navigate on an order  that has not been converted. (4);ENG=You cannot navigate on an order  that has not been converted. (4)';
      Text012@1040007 : TextConst 'ENU="Something is wrong as there should be a ""Sell-to Customer No."". (5) ";ENG="Something is wrong as there should be a ""Sell-to Customer No."". (5) "';
      Text013@1040008 : TextConst 'ENU=Sorry, cannot automatically find a posted document. (6);ENG=Sorry, cannot automatically find a posted document. (6)';
      Text014@1000000009 : TextConst 'ENU=No %1 or %2 record could be found matching the %3. (7);ENG=No %1 or %2 record could be found matching the %3. (7)';
      LedEntPay@1190000008 : Record 9021681;
      StockUsed@1000000012 : Record 9021684;
      Text015@1000000013 : TextConst 'ENU=This %1 is linked to multiple orders. You will be directed to the first one found. (15);ENG=This %1 is linked to multiple orders. You will be directed to the first one found. (15)';
      InternetShopMgt@1000000005 : Codeunit 9021610;
      CreateIPI@1000000018 : Codeunit 9021601;
      Text016@1000000019 : TextConst 'ENU=Converted Order reset to Status New by %1 on %2 - previous Convert Doc No. %3.;ENG=Converted Order reset to Status New by %1 on %2 - previous Convert Doc No. %3.';
      VersionCalls@1000000020 : Codeunit 9021662;
      TxtNotSupported@1000000021 : TextConst 'ENU=Not supported;ENG=Not supported';
      WFlowIn@1000000022 : Codeunit 9062262;

    PROCEDURE ChangeToNew@1();
    VAR
      Selection@1000000000 : Integer;
      TextMsg@1000000001 : Text[200];
    BEGIN
      //You must not take this code out as the Convert to Order process takes the credit card details
      //and puts them into Card Payment Entries and then blanks these values on the Internet Orders SOOO
      //you cannot reconvert an Internet Order.
      //DOC EC2013.3.60 -
      IF Status = Status::New THEN EXIT;

      Selection := 0;
      IF Status IN [Status::Converted,Status::Multiple] THEN BEGIN
        IF Status = Status::Converted THEN
          Selection := STRMENU(Text007,1)
        ELSE
          ERROR(Text003);
          //Selection := STRMENU(Text003,1);
        IF Selection = 2 THEN BEGIN
          IF CONFIRM(Text004,FALSE) THEN BEGIN
            TextMsg := STRSUBSTNO(Text016,USERID,TODAY,"Converted-To Document No.");
            CreateIPI.CreateIPI(0,"Order Guid",'','CONVERSION',"Bill-to Net Customer No.",TextMsg,
                    FALSE,FALSE,SalesHeader."Sell-to Customer No.",TRUE)
          END ELSE
            ERROR(Text005);
        END ELSE
          ERROR('');
      END;
      //DOC EC2013.3.60 +

      IF CONFIRM(Text001, TRUE, TABLECAPTION, "Internet Order Reference") THEN BEGIN
        IF "Converted-To Document No." <> '' THEN
          IF NOT CONFIRM(Text006,FALSE,"Converted-To Document Type","Converted-To Document No.") THEN
            ERROR(Text005);

        "Last Errored Convert-To Doc No" := "Converted-To Document No.";
        "Converted-To Document No." := '';
        "Converted-To Document Type" := "Converted-To Document Type"::Quote;

        //DOC EC2013.3.60 -
        LinkedAtValWeb.RESET;
        LinkedAtValWeb.SETCURRENTKEY("Label Code","Table Name","Key Field String 1");
        LinkedAtValWeb.SETRANGE("Label Code","Label Code");
        LinkedAtValWeb.SETRANGE("Table Name",'ShopSalesHeader');
        LinkedAtValWeb.SETRANGE("Key Field String 1","Order Guid");
        LinkedAtValWeb.MODIFYALL("NAV Processing Status",LinkedAtValWeb."NAV Processing Status"::" ");;
        //DOC EC2013.3.60 +

        Status := Status::New;
        "Processing In Progress" := FALSE;  //DOC EC2013.3.30
        "VAT Adjusted" := FALSE;  //DOC EC2013.3.60
        MODIFY;
      END;
    END;

    PROCEDURE MQFunctions@1190000005();
    BEGIN
    END;

    PROCEDURE IsB2BCustomer@1000000000() IsB2B : Boolean;
    BEGIN
      InternetCustomer.RESET;
      IF InternetCustomer.GET("Bill-to Net Customer No.") THEN
        EXIT(FALSE)
      ELSE BEGIN
        //no internet customer record; check for existing customer...
        Customer.RESET;
        //DOC EC2009.2.70 Customer.SETFILTER("User GUID","Bill-to Net Customer No.");
        Customer.SETRANGE("User GUID","Bill-to Net Customer No.");  //DOC EC2009.2.70
        IF Customer.FINDFIRST THEN
          EXIT(Customer."Is a B2B Internet Customer")
        ELSE
          ERROR(Text014,InternetCustomer.TABLECAPTION,Customer.TABLECAPTION,FIELDCAPTION("Bill-to Net Customer No."));
      END;
    END;

    PROCEDURE FindPostedDetails@1040001(LocalRec@1040000 : Record 9021666);
    VAR
      LocalCustRec@1040001 : Record 18;
      LocalCustLedgEntryRec@1040002 : Record 21;
      LocalSalesInvoice@1000000000 : Record 112;
      CustBillToNo@1040003 : Code[20];
      LocalSalesHeadRec@1040005 : Record 36;
      RunForm@1040007 : Boolean;
      TxtMultiple@1000000001 : TextConst 'ENU=MULTIPLE;ENG=MULTIPLE';
    BEGIN
      IF LocalRec."Converted-To Document No." = '' THEN
        ERROR(Text011);
      IF LocalRec."Sell-to Customer No." = '' THEN
        ERROR(Text012);
      RunForm := FALSE;
      IF LocalRec."Posted Document No." = '' THEN BEGIN
        IF LocalSalesHeadRec.GET(LocalRec."Converted-To Document Type",
           LocalRec."Converted-To Document No.") THEN BEGIN
          //LocalSalesOrderForm.SETRECORD(LocalSalesHeadRec);
          //LocalSalesOrderForm.RUN;
          VersionCalls.ShowSalesOrder(LocalSalesHeadRec); //DOC EC2013.4.00
        END ELSE BEGIN
          LocalCustRec.GET(LocalRec."Sell-to Customer No.");
          IF LocalCustRec."Bill-to Customer No." = '' THEN
            CustBillToNo := LocalRec."Sell-to Customer No."
          ELSE
            CustBillToNo :=  LocalCustRec."Bill-to Customer No.";
          LocalCustLedgEntryRec.RESET;
          LocalCustLedgEntryRec.SETRANGE("Customer No.",CustBillToNo);
          LocalCustLedgEntryRec.SETRANGE("External Document No.",LocalRec."Internet Order Reference");
          LocalCustLedgEntryRec.SETRANGE("Document Type",LocalCustLedgEntryRec."Document Type"::Invoice);
          LocalCustLedgEntryRec.SETCURRENTKEY("External Document No.");
          IF LocalCustLedgEntryRec.FINDFIRST THEN BEGIN
            IF LocalCustLedgEntryRec.COUNT = 1 THEN BEGIN
              LocalRec."Posted Document No." := LocalCustLedgEntryRec."Document No.";
              LocalRec."Posted Posting Date" := LocalCustLedgEntryRec."Posting Date";
            END ELSE BEGIN
              LocalRec."Posted Document No." := TxtMultiple;
            END;
            LocalRec.MODIFY;
            RunForm := TRUE;
          END ELSE BEGIN
            //DOC EC2013.3.60 -
            LocalSalesInvoice.RESET;
            LocalSalesInvoice.SETCURRENTKEY("Order No.");
            LocalSalesInvoice.SETRANGE("Order No.",LocalRec."Converted-To Document No.");
            LocalSalesInvoice.SETRANGE("Bill-to Customer No.",CustBillToNo);
            IF LocalSalesInvoice.COUNT > 1 THEN
              MESSAGE(Text015,TABLECAPTION);
            IF LocalSalesInvoice.FINDFIRST THEN BEGIN
              LocalRec."Posted Document No." := LocalSalesInvoice."No.";
              LocalRec."Posted Posting Date" := LocalSalesInvoice."Posting Date";
              LocalRec.MODIFY;
              RunForm := TRUE;
            END ELSE
            //DOC EC2013.3.60 +
            ERROR(Text013);
          END;
        END;
      END ELSE
        RunForm := TRUE;

      IF RunForm THEN BEGIN
        IF LocalRec."Posted Document No." = TxtMultiple THEN BEGIN
          LocalCustRec.GET(LocalRec."Sell-to Customer No.");
          IF LocalCustRec."Bill-to Customer No." = '' THEN
            CustBillToNo := LocalRec."Sell-to Customer No."
          ELSE
            CustBillToNo :=  LocalCustRec."Bill-to Customer No.";
          LocalCustLedgEntryRec.RESET;
          LocalCustLedgEntryRec.SETRANGE("Customer No.",CustBillToNo);
          LocalCustLedgEntryRec.SETRANGE("External Document No.",LocalRec."Internet Order Reference");
          LocalCustLedgEntryRec.SETRANGE("Document Type",LocalCustLedgEntryRec."Document Type"::Invoice);
          LocalCustLedgEntryRec.SETCURRENTKEY("External Document No.");
          //LocalCustLedEntForm.SETTABLEVIEW(LocalCustLedgEntryRec);
          //LocalCustLedEntForm.RUN;
          VersionCalls.ShowCustLedgEntries(LocalCustLedgEntryRec);  //DOC EC2013.4.00
        END ELSE BEGIN
          //Navigate.SetDoc(LocalRec."Posted Posting Date",LocalRec."Posted Document No.");
          //Navigate.RUN;
          VersionCalls.RunNavigate(LocalRec."Posted Document No.",LocalRec."Posted Posting Date"); //DOC EC2013.4.00
        END;
      END;
    END;

    BEGIN
    {
      //DOC EC2013.3.20 MQ 16/10/2012 - GW121016 Code change in Status and ChangeToNew
      //DOC EC2013.3.30 MQ 09/11/2012 - GW121109 Add field 75092
      //DOC EC2013.3.30 MQ 15/11/2012 - GW121115 Add fields 75094 and 75095
      //DOC EC2013.3.30 MQ 10/12/2012 - GW121210 Add line in ChangeToNew
      //DOC EC2013.3.30 MQ 12/12/2012 - GW121212 Add field 75096
      //DOC EC2013.3.40 MQ 23/01/2013 - GW130123 add Option Multiple to Status and Option to Converted to Document Type and change in ChangeToNew
      //DOC EC2013.3.40 MQ 23/01/2013 - field 75092 No. of Web Attributes was flowfield, changed to Normal 130123
      //DOC EC2013.3.50 MQ 22/02/2013 - GW130222 Make entry in Stock Used if order is rejected.
      //DOC EC2013.3.60 MQ 04/04/2013 - GW130404 Add field 200: User GUID
      //DOC EC2013.3.70 MA 12/04/2013 - Add field 201: Internet Customer Contact Name
      //DOC EC2013.3.70 MQ 22/04/2013 - GW130422 Code in ChangeNew and field 204: Split Orders
      //DOC EC2013.3.70 MQ 13/05/2013 - GW130513 Enhanced code in Status::Rejected - code was on Card
      //DOC EC2013.3.70 MQ 17/05/2013 - GW130517 Add key Salesperson Code for TD.
      //DOC EC2013.3.70 MQ 21/05/2013 - GW130521 Enhance FindPostedDetails
      //DOC EC2013.3.70 MQ 22/05/2013 - GW130522 Add field 75097
      //DOC EC2013.3.70 MQ 12/06/2013 - GW130612 Add field 75098
      //DOC EC2013.3.70 MQ 02/07/2013 - GW130702 Create IPI in ChangeToNew
      //DOC EC2013.3.80 MQ 16/08/2013 - GW130816 Deletion of Credit Card fields and e-payment fields
      //DOC EC2013.3.80 MQ 20/09/2013 - GW130920 Add field 75002 for PCI compatibility
      //DOC EC2013.4.00 MQ 13/11/2013 - GW131113 RTC compatibility; Add field 206 Order Type to deal with Return Orders and Convert. to Doc Type
      //DOC EC2013.4.64 MQ 13/06/2014 - GW140613 Add field 73506, used by PCI but not injected at moment
      //DOC EC2015.5.04 MQ 17/07/2015 - GW150717 Enhanced to handle Sales Quotes
      //DOC EC2016.6    JH 05/10/2016 - ECom 2016
      //DOC OP9031 RK 20/10/16 - New fields added: 'Ship-to Phone'.
      //DOC OP9031 RK 20/10/16 - Delete Sales Payments on deleting of internet order.
      //DOC OP9031 RK 09/02/17 - New field 'Marketing ID'.
      //DOC OP9031 RK 20/02/17 - Ship-to name 2 added.
      //DOC OP9031 LF 08/03/2017 - changed length of field "Gift Message" to 250
      //DOC OP9031 RK 16/03/17 - Marketing ID length increased to 150.
      //DOC OP10987 TM 16/06/17 - Add "Customer Locale"Text3
      //DOC OP11536 RK 30/08/17 - New field to store package type.
    }
    END.
  }
}

