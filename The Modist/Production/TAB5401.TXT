OBJECT Table 5401 Item Variant
{
  OBJECT-PROPERTIES
  {
    Date=07/11/18;
    Time=11:56:07 AM;
    Modified=Yes;
    Version List=NAVW17.00,NS2016.16,OP9031;
  }
  PROPERTIES
  {
    DataCaptionFields=Item No.,Code,Description;
    OnDelete=VAR
               ItemTranslation@1000 : Record 30;
               SKU@1001 : Record 5700;
               ItemIdent@1002 : Record 7704;
               ItemCrossReference@1003 : Record 5717;
               SalesPrice@1004 : Record 7002;
               SalesLineDiscount@1005 : Record 7004;
               PurchasePrice@1006 : Record 7012;
               PurchaseLineDiscount@1007 : Record 7014;
               BOMComp@1008 : Record 90;
               ItemJnlLine@1009 : Record 83;
               RequisitionLine@1010 : Record 246;
               PurchOrderLine@1011 : Record 39;
               SalesOrderLine@1012 : Record 37;
               ProdOrderComp@1013 : Record 5407;
               TransLine@1014 : Record 5741;
               ServiceLine@1015 : Record 5902;
               ProdBOMLine@1016 : Record 99000772;
               ServiceContractLine@1017 : Record 5964;
               ServiceItem@1018 : Record 5940;
               AssemblyHeader@1019 : Record 900;
               ItemSubstitution@1020 : Record 5715;
               ItemVend@1021 : Record 99;
               PlanningAssignment@1022 : Record 99000850;
               ServiceItemComponent@1023 : Record 5941;
               BinContent@1024 : Record 7302;
               ItemLedgerEntry@1026 : Record 32;
               ValueEntry@1027 : Record 5802;
               AssemblyLine@1028 : Record 901;
             BEGIN
               BOMComp.RESET;
               BOMComp.SETCURRENTKEY(Type,"No.");
               BOMComp.SETRANGE(Type,BOMComp.Type::Item);
               BOMComp.SETRANGE("No.","Item No.");
               BOMComp.SETRANGE("Variant Code",Code);
               IF NOT BOMComp.ISEMPTY THEN
                 ERROR(Text001,Code,BOMComp.TABLECAPTION);

               ProdBOMLine.RESET;
               ProdBOMLine.SETCURRENTKEY(Type,"No.");
               ProdBOMLine.SETRANGE(Type,ProdBOMLine.Type::Item);
               ProdBOMLine.SETRANGE("No.","Item No.");
               ProdBOMLine.SETRANGE("Variant Code",Code);
               IF NOT ProdBOMLine.ISEMPTY THEN
                 ERROR(Text001,Code,ProdBOMLine.TABLECAPTION);

               ProdOrderComp.RESET;
               ProdOrderComp.SETCURRENTKEY(Status,"Item No.");
               ProdOrderComp.SETRANGE("Item No.","Item No.");
               ProdOrderComp.SETRANGE("Variant Code",Code);
               IF NOT ProdOrderComp.ISEMPTY THEN
                 ERROR(Text001,Code,ProdOrderComp.TABLECAPTION);

               IF ProdOrderExist THEN
                 ERROR(Text002,"Item No.");

               AssemblyHeader.RESET;
               AssemblyHeader.SETCURRENTKEY("Document Type","Item No.");
               AssemblyHeader.SETRANGE("Item No.","Item No.");
               AssemblyHeader.SETRANGE("Variant Code",Code);
               IF NOT AssemblyHeader.ISEMPTY THEN
                 ERROR(Text001,Code,AssemblyHeader.TABLECAPTION);

               AssemblyLine.RESET;
               AssemblyLine.SETCURRENTKEY("Document Type",Type,"No.");
               AssemblyLine.SETRANGE("No.","Item No.");
               AssemblyLine.SETRANGE("Variant Code",Code);
               IF NOT AssemblyLine.ISEMPTY THEN
                 ERROR(Text001,Code,AssemblyLine.TABLECAPTION);

               BinContent.RESET;
               BinContent.SETCURRENTKEY("Item No.");
               BinContent.SETRANGE("Item No.","Item No.");
               BinContent.SETRANGE("Variant Code",Code);
               IF NOT BinContent.ISEMPTY THEN
                 ERROR(Text001,Code,BinContent.TABLECAPTION);

               TransLine.RESET;
               TransLine.SETCURRENTKEY("Item No.");
               TransLine.SETRANGE("Item No.","Item No.");
               TransLine.SETRANGE("Variant Code",Code);
               IF NOT TransLine.ISEMPTY THEN
                 ERROR(Text001,Code,TransLine.TABLECAPTION);

               RequisitionLine.RESET;
               RequisitionLine.SETCURRENTKEY(Type,"No.");
               RequisitionLine.SETRANGE(Type,RequisitionLine.Type::Item);
               RequisitionLine.SETRANGE("No.","Item No.");
               RequisitionLine.SETRANGE("Variant Code",Code);
               IF NOT RequisitionLine.ISEMPTY THEN
                 ERROR(Text001,Code,RequisitionLine.TABLECAPTION);

               PurchOrderLine.RESET;
               PurchOrderLine.SETCURRENTKEY(Type,"No.");
               PurchOrderLine.SETRANGE(Type,PurchOrderLine.Type::Item);
               PurchOrderLine.SETRANGE("No.","Item No.");
               PurchOrderLine.SETRANGE("Variant Code",Code);
               IF NOT PurchOrderLine.ISEMPTY THEN
                 ERROR(Text001,Code,PurchOrderLine.TABLECAPTION);

               SalesOrderLine.RESET;
               SalesOrderLine.SETCURRENTKEY(Type,"No.");
               SalesOrderLine.SETRANGE(Type,SalesOrderLine.Type::Item);
               SalesOrderLine.SETRANGE("No.","Item No.");
               SalesOrderLine.SETRANGE("Variant Code",Code);
               IF NOT SalesOrderLine.ISEMPTY THEN
                 ERROR(Text001,Code,SalesOrderLine.TABLECAPTION);

               ServiceItem.RESET;
               ServiceItem.SETCURRENTKEY("Item No.","Serial No.");
               ServiceItem.SETRANGE("Item No.","Item No.");
               ServiceItem.SETRANGE("Variant Code",Code);
               IF NOT ServiceItem.ISEMPTY THEN
                 ERROR(Text001,Code,ServiceItem.TABLECAPTION);

               ServiceLine.RESET;
               ServiceLine.SETCURRENTKEY(Type,"No.");
               ServiceLine.SETRANGE(Type,ServiceLine.Type::Item);
               ServiceLine.SETRANGE("No.","Item No.");
               ServiceLine.SETRANGE("Variant Code",Code);
               IF NOT ServiceLine.ISEMPTY THEN
                 ERROR(Text001,Code,ServiceLine.TABLECAPTION);

               ServiceContractLine.RESET;
               ServiceContractLine.SETRANGE("Item No.","Item No.");
               ServiceContractLine.SETRANGE("Variant Code",Code);
               IF NOT ServiceContractLine.ISEMPTY THEN
                 ERROR(Text001,Code,ServiceContractLine.TABLECAPTION);

               ServiceItemComponent.RESET;
               ServiceItemComponent.SETRANGE(Type,ServiceItemComponent.Type::Item);
               ServiceItemComponent.SETRANGE("No.","Item No.");
               ServiceItemComponent.SETRANGE("Variant Code",Code);
               ServiceItemComponent.MODIFYALL("Variant Code",'');

               ItemJnlLine.RESET;
               ItemJnlLine.SETCURRENTKEY("Item No.");
               ItemJnlLine.SETRANGE("Item No.","Item No.");
               ItemJnlLine.SETRANGE("Variant Code",Code);
               IF NOT ItemJnlLine.ISEMPTY THEN
                 ERROR(Text001,Code,ItemJnlLine.TABLECAPTION);

               ItemLedgerEntry.RESET;
               ItemLedgerEntry.SETCURRENTKEY("Item No.");
               ItemLedgerEntry.SETRANGE("Item No.","Item No.");
               ItemLedgerEntry.SETRANGE("Variant Code",Code);
               IF NOT ItemLedgerEntry.ISEMPTY THEN
                 ERROR(Text001,Code,ItemLedgerEntry.TABLECAPTION);

               ValueEntry.RESET;
               ValueEntry.SETCURRENTKEY("Item No.");
               ValueEntry.SETRANGE("Item No.","Item No.");
               ValueEntry.SETRANGE("Variant Code",Code);
               IF NOT ValueEntry.ISEMPTY THEN
                 ERROR(Text001,Code,ValueEntry.TABLECAPTION);

               ItemTranslation.SETRANGE("Item No.","Item No.");
               ItemTranslation.SETRANGE("Variant Code",Code);
               ItemTranslation.DELETEALL;

               ItemIdent.RESET;
               ItemIdent.SETCURRENTKEY("Item No.");
               ItemIdent.SETRANGE("Item No.","Item No.");
               ItemIdent.SETRANGE("Variant Code",Code);
               ItemIdent.DELETEALL;

               ItemCrossReference.SETRANGE("Item No.","Item No.");
               ItemCrossReference.SETRANGE("Variant Code",Code);
               ItemCrossReference.DELETEALL;

               ItemSubstitution.RESET;
               ItemSubstitution.SETRANGE(Type,ItemSubstitution.Type::Item);
               ItemSubstitution.SETRANGE("No.","Item No.");
               ItemSubstitution.SETRANGE("Substitute Type",ItemSubstitution."Substitute Type"::Item);
               ItemSubstitution.SETRANGE("Variant Code",Code);
               ItemSubstitution.DELETEALL;

               ItemVend.RESET;
               ItemVend.SETCURRENTKEY("Item No.");
               ItemVend.SETRANGE("Item No.","Item No.");
               ItemVend.SETRANGE("Variant Code",Code);
               ItemVend.DELETEALL;

               SalesPrice.RESET;
               SalesPrice.SETRANGE("Item No.","Item No.");
               SalesPrice.SETRANGE("Variant Code",Code);
               SalesPrice.DELETEALL;

               SalesLineDiscount.RESET;
               SalesLineDiscount.SETRANGE(Code,"Item No.");
               SalesLineDiscount.SETRANGE("Variant Code",Code);
               SalesLineDiscount.DELETEALL;

               PurchasePrice.RESET;
               PurchasePrice.SETRANGE("Item No.","Item No.");
               PurchasePrice.SETRANGE("Variant Code",Code);
               PurchasePrice.DELETEALL;

               PurchaseLineDiscount.RESET;
               PurchaseLineDiscount.SETRANGE("Item No.","Item No.");
               PurchaseLineDiscount.SETRANGE("Variant Code",Code);
               PurchaseLineDiscount.DELETEALL;

               SKU.SETRANGE("Item No.","Item No.");
               SKU.SETRANGE("Variant Code",Code);
               SKU.DELETEALL(TRUE);

               PlanningAssignment.RESET;
               PlanningAssignment.SETRANGE("Item No.","Item No.");
               PlanningAssignment.SETRANGE("Variant Code",Code);
               PlanningAssignment.DELETEALL;
             END;

    CaptionML=[ENU=Item Variant;
               ENG=Item Variant];
    LookupPageID=Page5401;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              ENG=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Item No.;
                                                              ENG=Item No.];
                                                   NotBlank=Yes }
    { 3   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              ENG=Description] }
    { 4   ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              ENG=Description 2] }
    { 50000;  ;Persist             ;Boolean        }
    { 50200;  ;Qty. on Purch. Return;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Return Order),
                                                                                                                    Type=CONST(Item),
                                                                                                                    No.=FIELD(Item No.),
                                                                                                                    Variant Code=FIELD(Code)));
                                                   AccessByPermission=TableData 6660=R;
                                                   CaptionML=[ENU=Qty. on Purch. Return;
                                                              ENG=Qty. on Purch. Return];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 50783;  ;Qty. on Internet Order;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Internet Order Line".Quantity WHERE (No.=FIELD(Item No.),
                                                                                                         Variant Code=FIELD(Code),
                                                                                                         Status=FILTER(New)));
                                                   Description=OP9031 LF 24/02/2017 }
    { 9087000;;Style No.           ;Code20        ;TableRelation=Style;
                                                   CaptionML=[ENU=Style No.;
                                                              ENG=Style No.];
                                                   Description=NS2015.1 }
    { 9087001;;Colour Code         ;Code20        ;TableRelation=Colour;
                                                   CaptionML=[ENU=Colour Code;
                                                              ENG=Colour Code];
                                                   Description=NS2015.1 }
    { 9087002;;Size Group Code     ;Code20        ;TableRelation="Size Group";
                                                   OnValidate=BEGIN
                                                                IF (Rec."Size Group Code" <> xRec."Size Group Code") THEN
                                                                  Rec.VALIDATE("Size Code", '');
                                                              END;

                                                   CaptionML=[ENU=Size Group Code;
                                                              ENG=Size Group Code];
                                                   Description=NS2015.1 }
    { 9087003;;Size Code           ;Code20        ;TableRelation=Size.Code WHERE (Size Group Code=FIELD(Size Group Code));
                                                   CaptionML=[ENU=Size Code;
                                                              ENG=Size Code];
                                                   Description=NS2015.1 }
    { 9087004;;Brand Code          ;Code20        ;TableRelation=Brand;
                                                   CaptionML=[ENU=Brand Code;
                                                              ENG=Brand Code];
                                                   Description=NS2015.1 }
    { 9087005;;Season Code         ;Code20        ;TableRelation=Season;
                                                   OnValidate=BEGIN
                                                                IF (Rec."Season Code" <> xRec."Season Code") THEN
                                                                  Rec.VALIDATE("Sub-Season Code", '');
                                                              END;

                                                   CaptionML=[ENU=Season Code;
                                                              ENG=Season Code];
                                                   Description=NS2015.1 }
    { 9087006;;Division Code       ;Code20        ;TableRelation="Item Hierarchy"."Division Code" WHERE (Type=CONST(Division));
                                                   OnValidate=BEGIN
                                                                IF (Rec."Division Code" <> xRec."Division Code") THEN
                                                                  Rec.VALIDATE("Department Code", '');
                                                              END;

                                                   CaptionML=[ENU=Division Code;
                                                              ENG=Division Code];
                                                   Description=NS2015.1 }
    { 9087007;;Department Code     ;Code20        ;TableRelation="Item Hierarchy"."Department Code" WHERE (Type=CONST(Department),
                                                                                                           Division Code=FIELD(Division Code));
                                                   OnValidate=BEGIN
                                                                IF (Rec."Department Code" <> xRec."Department Code") THEN
                                                                  Rec.VALIDATE("Group Code", '');
                                                              END;

                                                   CaptionML=[ENU=Department Code;
                                                              ENG=Department Code];
                                                   Description=NS2015.1 }
    { 9087008;;Group Code          ;Code20        ;TableRelation="Item Hierarchy"."Group Code" WHERE (Type=CONST(Group),
                                                                                                      Division Code=FIELD(Division Code),
                                                                                                      Department Code=FIELD(Department Code));
                                                   OnValidate=BEGIN
                                                                IF (Rec."Group Code" <> xRec."Group Code") THEN
                                                                  Rec.VALIDATE("Category Code", '');
                                                              END;

                                                   CaptionML=[ENU=Group Code;
                                                              ENG=Group Code];
                                                   Description=NS2015.1 }
    { 9087009;;Category Code       ;Code20        ;TableRelation="Item Hierarchy"."Category Code" WHERE (Type=CONST(Category),
                                                                                                         Division Code=FIELD(Division Code),
                                                                                                         Department Code=FIELD(Department Code),
                                                                                                         Group Code=FIELD(Group Code));
                                                   OnValidate=BEGIN
                                                                IF (Rec."Category Code" <> xRec."Category Code") THEN
                                                                  Rec.VALIDATE("Sub-Category Code", '');
                                                              END;

                                                   CaptionML=[ENU=Category Code;
                                                              ENG=Category Code];
                                                   Description=NS2015.1 }
    { 9087010;;Sub-Category Code   ;Code20        ;TableRelation="Item Hierarchy"."Sub-Category Code" WHERE (Type=CONST(Category),
                                                                                                             Division Code=FIELD(Division Code),
                                                                                                             Department Code=FIELD(Department Code),
                                                                                                             Group Code=FIELD(Group Code),
                                                                                                             Category Code=FIELD(Category Code));
                                                   CaptionML=[ENU=Sub-Category Code;
                                                              ENG=Sub-Category Code];
                                                   Description=NS2015.1 }
    { 9087011;;Sequence            ;Integer       ;CaptionML=[ENU=Sequence;
                                                              ENG=Sequence];
                                                   Description=NS2015.1 }
    { 9087012;;Unique ID           ;Code50        ;CaptionML=[ENU=Unique ID;
                                                              ENG=Unique ID];
                                                   Description=NS2015.1 }
    { 9087013;;Item Description    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Item.Description WHERE (No.=FIELD(Item No.)));
                                                   CaptionML=[ENU=Item Description;
                                                              ENG=Item Description];
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087014;;Unavailable Stock   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Unavailable Stock".Quantity WHERE (Item No.=FIELD(Item No.),
                                                                                                       Variant Code=FIELD(Code),
                                                                                                       Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Unavailable Stock;
                                                              ENG=Unavailable Stock];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087015;;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[ENU=Location Filter;
                                                              ENG=Location Filter];
                                                   Description=NS2015.1 }
    { 9087016;;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              ENG=Date Filter];
                                                   Description=NS2015.1 }
    { 9087017;;Inventory           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry".Quantity WHERE (Item No.=FIELD(Item No.),
                                                                                                       Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                       Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                       Location Code=FIELD(Location Filter),
                                                                                                       Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                       Variant Code=FIELD(Code),
                                                                                                       Lot No.=FIELD(Lot No. Filter),
                                                                                                       Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Inventory;
                                                              ENG=Inventory];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087018;;Net Invoiced Qty.   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Item No.=FIELD(Item No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                                  Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                  Variant Code=FIELD(Code),
                                                                                                                  Lot No.=FIELD(Lot No. Filter),
                                                                                                                  Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Net Invoiced Qty.;
                                                              ENG=Net Invoiced Qty.];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087019;;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry".Quantity WHERE (Item No.=FIELD(Item No.),
                                                                                                       Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                       Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                       Location Code=FIELD(Location Filter),
                                                                                                       Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                       Variant Code=FIELD(Code),
                                                                                                       Lot No.=FIELD(Lot No. Filter),
                                                                                                       Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Net Change;
                                                              ENG=Net Change];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087020;;Purchases (Qty.)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Entry Type=CONST(Purchase),
                                                                                                                  Item No.=FIELD(Item No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                                  Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                  Variant Code=FIELD(Code),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Lot No.=FIELD(Lot No. Filter),
                                                                                                                  Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Purchases (Qty.);
                                                              ENG=Purchases (Qty.)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087021;;Sales (Qty.)        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Value Entry"."Invoiced Quantity" WHERE (Item Ledger Entry Type=CONST(Sale),
                                                                                                             Item No.=FIELD(Item No.),
                                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                             Location Code=FIELD(Location Filter),
                                                                                                             Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                             Variant Code=FIELD(Code),
                                                                                                             Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Sales (Qty.);
                                                              ENG=Sales (Qty.)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087022;;Positive Adjmt. (Qty.);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Entry Type=CONST(Positive Adjmt.),
                                                                                                                  Item No.=FIELD(Item No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                                  Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                  Variant Code=FIELD(Code),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Lot No.=FIELD(Lot No. Filter),
                                                                                                                  Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Positive Adjmt. (Qty.);
                                                              ENG=Positive Adjmt. (Qty.)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087023;;Negative Adjmt. (Qty.);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Entry Type=CONST(Negative Adjmt.),
                                                                                                                   Item No.=FIELD(Item No.),
                                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Location Code=FIELD(Location Filter),
                                                                                                                   Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                   Variant Code=FIELD(Code),
                                                                                                                   Posting Date=FIELD(Date Filter),
                                                                                                                   Lot No.=FIELD(Lot No. Filter),
                                                                                                                   Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Negative Adjmt. (Qty.);
                                                              ENG=Negative Adjmt. (Qty.)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087024;;Purchases (LCY)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Purchase Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Purchase),
                                                                                                                   Item No.=FIELD(Item No.),
                                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Location Code=FIELD(Location Filter),
                                                                                                                   Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                   Variant Code=FIELD(Code),
                                                                                                                   Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Purchases (LCY);
                                                              ENG=Purchases (LCY)];
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 9087025;;Sales (LCY)         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Sales Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Sale),
                                                                                                                Item No.=FIELD(Item No.),
                                                                                                                Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                Variant Code=FIELD(Code),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Sales (LCY);
                                                              ENG=Sales (LCY)];
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 9087026;;Positive Adjmt. (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Positive Adjmt.),
                                                                                                               Item No.=FIELD(Item No.),
                                                                                                               Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                               Variant Code=FIELD(Code),
                                                                                                               Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Positive Adjmt. (LCY);
                                                              ENG=Positive Adjmt. (LCY)];
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 9087027;;Negative Adjmt. (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Negative Adjmt.),
                                                                                                               Item No.=FIELD(Item No.),
                                                                                                               Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                               Variant Code=FIELD(Code),
                                                                                                               Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Negative Adjmt. (LCY);
                                                              ENG=Negative Adjmt. (LCY)];
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 9087028;;COGS (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Value Entry"."Cost Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Sale),
                                                                                                                Item No.=FIELD(Item No.),
                                                                                                                Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                Variant Code=FIELD(Code),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=COGS (LCY);
                                                              ENG=COGS (LCY)];
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 9087029;;Qty. on Purch. Order;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                    Type=CONST(Item),
                                                                                                                    No.=FIELD(Item No.),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Location Code=FIELD(Location Filter),
                                                                                                                    Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                    Variant Code=FIELD(Code),
                                                                                                                    Expected Receipt Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. on Purch. Order;
                                                              ENG=Qty. on Purch. Order];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087030;;Qty. on Sales Order ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                 Type=CONST(Item),
                                                                                                                 No.=FIELD(Item No.),
                                                                                                                 Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                 Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                 Variant Code=FIELD(Code),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. on Sales Order;
                                                              ENG=Qty. on Sales Order];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087031;;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              ENG=Global Dimension 1 Filter];
                                                   Description=NS2015.1;
                                                   CaptionClass='1,3,1' }
    { 9087032;;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              ENG=Global Dimension 2 Filter];
                                                   Description=NS2015.1;
                                                   CaptionClass='1,3,2' }
    { 9087033;;Drop Shipment Filter;Boolean       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Drop Shipment Filter;
                                                              ENG=Drop Shipment Filter];
                                                   Description=NS2015.1 }
    { 9087034;;Lot No. Filter      ;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Lot No. Filter;
                                                              ENG=Lot No. Filter];
                                                   Description=NS2015.1 }
    { 9087035;;Serial No. Filter   ;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Serial No. Filter;
                                                              ENG=Serial No. Filter];
                                                   Description=NS2015.1 }
    { 9087036;;Transferred (Qty.)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Entry Type=CONST(Transfer),
                                                                                                                  Item No.=FIELD(Item No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                                  Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                  Variant Code=FIELD(Code),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Lot No.=FIELD(Lot No. Filter),
                                                                                                                  Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Transferred (Qty.);
                                                              ENG=Transferred (Qty.)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087037;;Transferred (LCY)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Sales Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Transfer),
                                                                                                                Item No.=FIELD(Item No.),
                                                                                                                Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                Variant Code=FIELD(Code),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Transferred (LCY);
                                                              ENG=Transferred (LCY)];
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 9087038;;Qty. in Transit     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Transfer Line"."Qty. in Transit (Base)" WHERE (Derived From Line No.=CONST(0),
                                                                                                                   Item No.=FIELD(Item No.),
                                                                                                                   Transfer-to Code=FIELD(Location Filter),
                                                                                                                   Variant Code=FIELD(Code),
                                                                                                                   Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Receipt Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. in Transit;
                                                              ENG=Qty. in Transit];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087039;;Trans. Ord. Receipt (Qty.);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Transfer Line"."Outstanding Qty. (Base)" WHERE (Derived From Line No.=CONST(0),
                                                                                                                    Item No.=FIELD(Item No.),
                                                                                                                    Transfer-to Code=FIELD(Location Filter),
                                                                                                                    Variant Code=FIELD(Code),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Receipt Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Trans. Ord. Receipt (Qty.);
                                                              ENG=Trans. Ord. Receipt (Qty.)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087040;;Trans. Ord. Shipment (Qty.);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Transfer Line"."Outstanding Qty. (Base)" WHERE (Derived From Line No.=CONST(0),
                                                                                                                    Item No.=FIELD(Item No.),
                                                                                                                    Transfer-from Code=FIELD(Location Filter),
                                                                                                                    Variant Code=FIELD(Code),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Shipment Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Trans. Ord. Shipment (Qty.);
                                                              ENG=Trans. Ord. Shipment (Qty.)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Description=NS2015.1;
                                                   Editable=No }
    { 9087041;;Sub-Season Code     ;Code20        ;TableRelation=Sub-Season.Code WHERE (Season Code=FIELD(Season Code));
                                                   CaptionML=[ENU=Sub-Season Code;
                                                              ENG=Sub-Season Code];
                                                   Description=NS2015.1 }
    { 9087042;;Bin Filter          ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Filter));
                                                   CaptionML=[ENU=Bin Filter;
                                                              ENG=Bin Filter] }
  }
  KEYS
  {
    {    ;Item No.,Code                           ;Clustered=Yes }
    {    ;Code                                     }
    {    ;Item No.,Sequence,Code                   }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'ENU=You cannot delete item variant %1 because there is at least one %2 that includes this Variant Code.;ENG=You cannot delete item variant %1 because there is at least one %2 that includes this Variant Code.';
      Text002@1000 : TextConst 'ENU=You cannot delete item variant %1 because there are one or more outstanding production orders that include this item.;ENG=You cannot delete item variant %1 because there are one or more outstanding production orders that include this item.';

    LOCAL PROCEDURE ProdOrderExist@7() : Boolean;
    VAR
      ProdOrderLine@1040 : Record 5406;
    BEGIN
      ProdOrderLine.SETCURRENTKEY(Status,"Item No.");
      ProdOrderLine.SETRANGE("Item No.","Item No.");
      ProdOrderLine.SETRANGE("Variant Code",Code);
      IF NOT ProdOrderLine.ISEMPTY THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    BEGIN
    {
      //DOC NS2015.1 JH 14/01/2014 - nSemble fields added
      //DOC OP9031 LF 24/02/17 - Added flowfield "Qty. on Internet Order"
    }
    END.
  }
}

