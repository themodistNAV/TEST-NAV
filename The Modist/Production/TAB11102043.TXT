OBJECT Table 11102043 OM - Transport
{
  OBJECT-PROPERTIES
  {
    Date=19/11/15;
    Time=12:00:00 PM;
    Version List=OMA10.00;
  }
  PROPERTIES
  {
    DataPerCompany=No;
    DataCaptionFields=No.,Description;
    OnInsert=VAR
               Setup@1000 : Record 11102035;
               StatusHistory@1001 : Record 11102038;
               RepositoryMgt@1002 : Codeunit 11102067;
             BEGIN
               RepositoryMgt.Synchronize(FALSE, FALSE);

               Setup.CustomGet;

               IF "No." = '' THEN
                 "No." := GetNextNo(Setup."Transport Nos. Format");

               TESTFIELD("No.");

               IF Description = '' THEN
                 VALIDATE(Description, FORMAT(WORKDATE, 0, STRSUBSTNO(Setup."Transport Description", "No.")));

               IF "Transport Type Code" = '' THEN
                 VALIDATE("Transport Type Code", Setup."Default Transport Type");

               StatusHistory.UpdateDescription(1, "No.", Description);

               UpdateRepository(1);
             END;

    OnModify=VAR
               StatusHistory@1000 : Record 11102038;
               ctConfirmModify@1001 : TextConst 'DEU=This transport has already been transported.\Are you sure?;ENU=This transport has already been transported.\Are you sure?;ESP=This transport has already been transported.\Are you sure?;FRA=This transport has already been transported.\Are you sure?;NLD=Dit transport is al getransporteerd.\Weet u het zeker?;DEA=This transport has already been transported.\Are you sure?';
             BEGIN
               IF xRec.Blocked AND NOT SkipCheckBlocked THEN
                 TESTFIELD(Blocked, FALSE);

               IF Transported AND NOT SkipConfirmModify THEN
                 IF NOT CONFIRM(ctConfirmModify, TRUE) THEN
                   ERROR('');

               StatusHistory.UpdateDescription(1, "No.", Description);

               UpdateRepository(2);
             END;

    OnDelete=VAR
               ProjectObject@1000 : Record 11102037;
               StatusHistory@1001 : Record 11102038;
               Modification@1002 : Record 11102042;
               DocumentLine@1003 : Record 11102046;
               TransportProjectHistory@1004 : Record 11102066;
               Comment@1005 : Record 11102095;
               ctAssignedProjects@1006 : TextConst 'DEU=Assigned projects present.;ENU=Assigned projects present.;ESP=Assigned projects present.;FRA=Assigned projects present.;NLD=Toegewezen projecten aanwezig.;DEA=Assigned projects present.';
               ctConfirmTransported@1007 : TextConst 'DEU=This transport has already been transported.\Are you sure?;ENU=This transport has already been transported.\Are you sure?;ESP=This transport has already been transported.\Are you sure?;FRA=This transport has already been transported.\Are you sure?;NLD=Dit transport is al getransporteerd.\Weet u het zeker?;DEA=This transport has already been transported.\Are you sure?';
             BEGIN
               TESTFIELD(Blocked, FALSE);

               ProjectObject.SETCURRENTKEY("Transport No.");
               ProjectObject.SETRANGE("Transport No.", "No.");
               IF ProjectObject.FINDSET THEN BEGIN
                 IF Transported THEN
                   ERROR(ctAssignedProjects);
                 REPEAT
                   ProjectObject.VALIDATE("Transport No.", '');
                   ProjectObject.MODIFY(TRUE);
                 UNTIL ProjectObject.NEXT = 0;
               END;

               IF Transported THEN
                 IF NOT CONFIRM(ctConfirmTransported, TRUE) THEN
                   ERROR('');

               StatusHistory.SETCURRENTKEY("Table Name", "No.");
               StatusHistory.SETRANGE("Table Name", StatusHistory."Table Name"::Transport);
               StatusHistory.SETRANGE("No.", "No.");
               StatusHistory.DELETEALL(TRUE);

               Comment.SETCURRENTKEY("Table Name", "No.");
               Comment.SETRANGE("Table Name", Comment."Table Name"::Transport);
               Comment.SETRANGE("No.", "No.");
               Comment.DELETEALL(TRUE);

               DocumentLine.SETRANGE("Table Name", DocumentLine."Table Name"::Transport);
               DocumentLine.SETRANGE("No.", "No.");
               DocumentLine.DELETEALL;

               Modification.SETCURRENTKEY("Transport No.");
               Modification.SETRANGE("Transport No.", "No.");
               Modification.MODIFYALL("Transport No.", '', TRUE);

               TransportProjectHistory.SETRANGE("Transport No.", "No.");
               TransportProjectHistory.DELETEALL;

               UpdateRepository(3);
             END;

    OnRename=BEGIN
               TESTFIELD(Blocked, FALSE);

               UpdateRepository(4);
             END;

    CaptionML=[DEU=Transport;
               ENU=Transport;
               ESP=Transport;
               FRA=Transport;
               NLD=Transport;
               DEA=Transport];
    LookupPageID=Page11102055;
    DrillDownPageID=Page11102055;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Description;
                                                   CaptionML=[DEU=No.;
                                                              ENU=No.;
                                                              ESP=No.;
                                                              FRA=No.;
                                                              NLD=Nr.;
                                                              DEA=No.] }
    { 2   ;   ;Description         ;Text100       ;OnValidate=BEGIN
                                                                IF ("Search Description" = UPPERCASE(xRec.Description)) OR ("Search Description" = '') THEN
                                                                  "Search Description" := Description;
                                                              END;

                                                   CaptionML=[DEU=Description;
                                                              ENU=Description;
                                                              ESP=Description;
                                                              FRA=Description;
                                                              NLD=Omschrijving;
                                                              DEA=Description] }
    { 3   ;   ;Search Description  ;Code100       ;CaptionML=[DEU=Search Description;
                                                              ENU=Search Description;
                                                              ESP=Search Description;
                                                              FRA=Search Description;
                                                              NLD=Zoeknaam;
                                                              DEA=Search Description] }
    { 4   ;   ;No. of Comments     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("OM - Comment" WHERE (Table Name=CONST(Transport),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[DEU=No. of Comments;
                                                              ENU=No. of Comments;
                                                              ESP=No. of Comments;
                                                              FRA=No. of Comments;
                                                              NLD=Aantal opmerkingen;
                                                              DEA=No. of Comments];
                                                   Editable=No }
    { 5   ;   ;Version List Id     ;Text30        ;OnValidate=BEGIN
                                                                IF "Version List Id" <> '' THEN
                                                                  FillNewVersionNo;
                                                              END;

                                                   CaptionML=[DEU=Version List Id;
                                                              ENU=Version List Id;
                                                              ESP=Version List Id;
                                                              FRA=Version List Id;
                                                              NLD=Versielijst Id;
                                                              DEA=Version List Id] }
    { 6   ;   ;Version No.         ;Text30        ;CaptionML=[DEU=Version No.;
                                                              ENU=Version No.;
                                                              ESP=Version No.;
                                                              FRA=Version No.;
                                                              NLD=Versienr.;
                                                              DEA=Version No.] }
    { 7   ;   ;New Timestamp       ;Option        ;CaptionML=[DEU=New Timestamp;
                                                              ENU=New Timestamp;
                                                              ESP=New Timestamp;
                                                              FRA=New Timestamp;
                                                              NLD=Nieuwe datumstempel;
                                                              DEA=New Timestamp];
                                                   OptionCaptionML=[DEU=" ,Moment of Transport,Define,Date of Transport";
                                                                    ENU=" ,Moment of Transport,Define,Date of Transport";
                                                                    ESP=" ,Moment of Transport,Define,Date of Transport";
                                                                    FRA=" ,Moment of Transport,Define,Date of Transport";
                                                                    NLD=" ,Moment van transport,Defini‰ren,Datum van transport";
                                                                    DEA=" ,Moment of Transport,Define,Date of Transport"];
                                                   OptionString=[ ,Moment of Transport,Define,Date of Transport] }
    { 8   ;   ;Timestamp Date      ;Date          ;CaptionML=[DEU=Timestamp Date;
                                                              ENU=Timestamp Date;
                                                              ESP=Timestamp Date;
                                                              FRA=Timestamp Date;
                                                              NLD=Datumstempel;
                                                              DEA=Timestamp Date] }
    { 9   ;   ;Timestamp Time      ;Time          ;CaptionML=[DEU=Timestamp Time;
                                                              ENU=Timestamp Time;
                                                              ESP=Timestamp Time;
                                                              FRA=Timestamp Time;
                                                              NLD=Tijdstempel;
                                                              DEA=Timestamp Time] }
    { 11  ;   ;Transported         ;Boolean       ;OnValidate=VAR
                                                                Flow@1000 : Record 11102040;
                                                                TransportType@1001 : Record 11102098;
                                                                Mgt@1002 : Codeunit 11102035;
                                                              BEGIN
                                                                IF Transported THEN BEGIN
                                                                  "Transport Date" := TODAY;
                                                                  "Transport Time" := TIME;
                                                                  "Transport User Id" := Mgt.ShortUserId;
                                                                END;

                                                                IF Flow.GET(Flow."Table Name"::Transport, "Transport Flow Code") THEN
                                                                  IF Flow."Transport Status" <> '' THEN
                                                                    VALIDATE("Status Code", Flow."Transport Status");

                                                                IF TransportType.GET("Transport Type Code") THEN
                                                                  IF TransportType."Block Transport at Transport" THEN
                                                                    VALIDATE(Blocked, TRUE);
                                                              END;

                                                   CaptionML=[DEU=Transported;
                                                              ENU=Transported;
                                                              ESP=Transported;
                                                              FRA=Transported;
                                                              NLD=Getransporteerd;
                                                              DEA=Transported];
                                                   Editable=No }
    { 12  ;   ;Export Path         ;Text250       ;CaptionML=[DEU=Export Path;
                                                              ENU=Export Path;
                                                              ESP=Export Path;
                                                              FRA=Export Path;
                                                              NLD=Exporteermap;
                                                              DEA=Export Path] }
    { 13  ;   ;Blocked             ;Boolean       ;OnValidate=VAR
                                                                TransportType@1000 : Record 11102098;
                                                              BEGIN
                                                                IF NOT Blocked THEN
                                                                  IF Transported THEN
                                                                    IF TransportType.GET("Transport Type Code") THEN
                                                                      TransportType.TESTFIELD("Block Transport at Transport", FALSE);
                                                              END;

                                                   CaptionML=[DEU=Blocked;
                                                              ENU=Blocked;
                                                              ESP=Blocked;
                                                              FRA=Blocked;
                                                              NLD=Geblokkeerd;
                                                              DEA=Blocked] }
    { 14  ;   ;No. of Documents    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("OM - Document Line" WHERE (Table Name=CONST(Transport),
                                                                                                 No.=FIELD(No.)));
                                                   CaptionML=[DEU=No. of Documents;
                                                              ENU=No. of Documents;
                                                              ESP=No. of Documents;
                                                              FRA=No. of Documents;
                                                              NLD=Aantal documenten;
                                                              DEA=No. of Documents];
                                                   Editable=No }
    { 15  ;   ;Include Version List;Text30        ;CaptionML=[DEU=Include Version List;
                                                              ENU=Include Version List;
                                                              ESP=Include Version List;
                                                              FRA=Include Version List;
                                                              NLD=Versielijst bijsluiten;
                                                              DEA=Include Version List] }
    { 16  ;   ;Update Version List ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[DEU=Update Version List;
                                                              ENU=Update Version List;
                                                              ESP=Update Version List;
                                                              FRA=Update Version List;
                                                              NLD=Versielijst bijwerken;
                                                              DEA=Update Version List] }
    { 19  ;   ;Transport Date      ;Date          ;CaptionML=[DEU=Transport Date;
                                                              ENU=Transport Date;
                                                              ESP=Transport Date;
                                                              FRA=Transport Date;
                                                              NLD=Transportdatum;
                                                              DEA=Transport Date] }
    { 20  ;   ;Transport Time      ;Time          ;CaptionML=[DEU=Transport Time;
                                                              ENU=Transport Time;
                                                              ESP=Transport Time;
                                                              FRA=Transport Time;
                                                              NLD=Transporttijd;
                                                              DEA=Transport Time] }
    { 21  ;   ;Transport User Id   ;Code50        ;CaptionML=[DEU=Transport User Id;
                                                              ENU=Transport User Id;
                                                              ESP=Transport User Id;
                                                              FRA=Transport User Id;
                                                              NLD=Transport gebruikers-id;
                                                              DEA=Transport User Id] }
    { 23  ;   ;Transport Flow Code ;Code20        ;TableRelation="OM - Flow".Code WHERE (Table Name=CONST(Transport));
                                                   OnValidate=VAR
                                                                Flow@1000 : Record 11102040;
                                                              BEGIN
                                                                IF "Status Code" = '' THEN
                                                                  IF Flow.GET(Flow."Table Name"::Transport, "Transport Flow Code") THEN
                                                                    IF Flow.DefaultStatus <> '' THEN
                                                                      VALIDATE("Status Code", Flow.DefaultStatus);
                                                              END;

                                                   CaptionML=[DEU=Transport Flow Code;
                                                              ENU=Transport Flow Code;
                                                              ESP=Transport Flow Code;
                                                              FRA=Transport Flow Code;
                                                              NLD=Transportverloop;
                                                              DEA=Transport Flow Code] }
    { 24  ;   ;Status Code         ;Code20        ;TableRelation="OM - Status".Code WHERE (Table Name=CONST(Transport));
                                                   OnValidate=VAR
                                                                StatusHistory@1000 : Record 11102038;
                                                                Status@1001 : Record 11102039;
                                                                FlowStatus@1002 : Record 11102041;
                                                                RoleFound@1003 : Boolean;
                                                              BEGIN
                                                                FlowStatus.SETRANGE("Table Name", FlowStatus."Table Name"::Transport);
                                                                FlowStatus.SETRANGE("Flow Code", "Transport Flow Code");
                                                                FlowStatus.SETRANGE("Status Code", "Status Code");
                                                                FlowStatus.SETFILTER(Role, '<>%1', '');
                                                                IF FlowStatus.FINDFIRST THEN BEGIN
                                                                  VALIDATE("Active Role", FlowStatus.Role);
                                                                  RoleFound := TRUE;

                                                                  IF FlowStatus."Block Table" THEN
                                                                    Blocked := TRUE;

                                                                END;

                                                                IF Status.GET(Status."Table Name"::Transport, "Status Code") THEN BEGIN
                                                                  VALIDATE("Status Type", Status.Type);
                                                                  IF NOT RoleFound AND (Status."Role Code" <> '') THEN
                                                                    VALIDATE("Active Role", Status."Role Code");
                                                                END ELSE BEGIN
                                                                  VALIDATE("Status Type", "Status Type"::Ready);
                                                                  VALIDATE("Active Role", '');
                                                                END;

                                                                StatusHistory."Table Name" := StatusHistory."Table Name"::Transport;
                                                                StatusHistory."No." := "No.";
                                                                StatusHistory."Status Code" := "Status Code";
                                                                StatusHistory.INSERT(TRUE);

                                                                SendEmails;
                                                              END;

                                                   CaptionML=[DEU=Status Code;
                                                              ENU=Status Code;
                                                              ESP=Status Code;
                                                              FRA=Status Code;
                                                              NLD=Status;
                                                              DEA=Status Code] }
    { 25  ;   ;Status Type         ;Option        ;InitValue=Ready;
                                                   OnValidate=VAR
                                                                Project@1000 : Record 11102036;
                                                                ctProjectsToReady@1001 : TextConst 'DEU=%1 projects will be set to ready.\Are you sure?;ENU=%1 projects will be set to ready.\Are you sure?;ESP=%1 projects will be set to ready.\Are you sure?;FRA=%1 projects will be set to ready.\Are you sure?;NLD=%1 projecten zullen op gereed worden gezet.\Weet u het zeker?;DEA=%1 projects will be set to ready.\Are you sure?';
                                                              BEGIN
                                                                IF "Status Type" = "Status Type"::Ready THEN BEGIN
                                                                  Project.SETCURRENTKEY("Transport No.");
                                                                  Project.SETRANGE("Transport No.", "No.");
                                                                  Project.SETFILTER("Status Type", '<>%1', Project."Status Type"::Ready);
                                                                  IF NOT Project.ISEMPTY THEN BEGIN

                                                                    IF NOT CONFIRM(ctProjectsToReady, TRUE, Project.COUNT) THEN
                                                                      ERROR('');

                                                                    IF Project.FINDSET THEN
                                                                      REPEAT
                                                                        Project.SetToReady;
                                                                      UNTIL Project.NEXT = 0;

                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Status Type;
                                                              ENU=Status Type;
                                                              ESP=Status Type;
                                                              FRA=Status Type;
                                                              NLD=Statussoort;
                                                              DEA=Status Type];
                                                   OptionCaptionML=[DEU=" ,Developing,Ready";
                                                                    ENU=" ,Developing,Ready";
                                                                    ESP=" ,Developing,Ready";
                                                                    FRA=" ,Developing,Ready";
                                                                    NLD=" ,Ontwikkelen,Klaar";
                                                                    DEA=" ,Developing,Ready"];
                                                   OptionString=[ ,Developing,Ready] }
    { 26  ;   ;User Role 1         ;Code50        ;TableRelation="OM - User";
                                                   OnValidate=VAR
                                                                Setup@1000 : Record 11102035;
                                                              BEGIN
                                                                Setup.CustomGet;
                                                                IF "Active Role" = Setup."Role Shortcut 1" THEN
                                                                  VALIDATE("Active User", "User Role 1");
                                                              END;

                                                   CaptionML=[DEU=User Role 1;
                                                              ENU=User Role 1;
                                                              ESP=User Role 1;
                                                              FRA=User Role 1;
                                                              NLD=Gebruikersrol 1;
                                                              DEA=User Role 1];
                                                   CaptionClass=CaptionUserRole(1) }
    { 27  ;   ;User Role 2         ;Code50        ;TableRelation="OM - User";
                                                   OnValidate=VAR
                                                                Setup@1000 : Record 11102035;
                                                              BEGIN
                                                                Setup.CustomGet;
                                                                IF "Active Role" = Setup."Role Shortcut 2" THEN
                                                                  VALIDATE("Active User", "User Role 2");
                                                              END;

                                                   CaptionML=[DEU=User Role 2;
                                                              ENU=User Role 2;
                                                              ESP=User Role 2;
                                                              FRA=User Role 2;
                                                              NLD=Gebruikersrol 2;
                                                              DEA=User Role 2];
                                                   CaptionClass=CaptionUserRole(2) }
    { 28  ;   ;User Role 3         ;Code50        ;TableRelation="OM - User";
                                                   OnValidate=VAR
                                                                Setup@1000 : Record 11102035;
                                                              BEGIN
                                                                Setup.CustomGet;
                                                                IF "Active Role" = Setup."Role Shortcut 3" THEN
                                                                  VALIDATE("Active User", "User Role 3");
                                                              END;

                                                   CaptionML=[DEU=User Role 3;
                                                              ENU=User Role 3;
                                                              ESP=User Role 3;
                                                              FRA=User Role 3;
                                                              NLD=Gebruikersrol 3;
                                                              DEA=User Role 3];
                                                   CaptionClass=CaptionUserRole(3) }
    { 29  ;   ;User Role 4         ;Code50        ;TableRelation="OM - User";
                                                   OnValidate=VAR
                                                                Setup@1000 : Record 11102035;
                                                              BEGIN
                                                                Setup.CustomGet;
                                                                IF "Active Role" = Setup."Role Shortcut 4" THEN
                                                                  VALIDATE("Active User", "User Role 4");
                                                              END;

                                                   CaptionML=[DEU=User Role 4;
                                                              ENU=User Role 4;
                                                              ESP=User Role 4;
                                                              FRA=User Role 4;
                                                              NLD=Gebruikersrol 4;
                                                              DEA=User Role 4];
                                                   CaptionClass=CaptionUserRole(4) }
    { 30  ;   ;User Role 5         ;Code50        ;TableRelation="OM - User";
                                                   OnValidate=VAR
                                                                Setup@1000 : Record 11102035;
                                                              BEGIN
                                                                Setup.CustomGet;
                                                                IF "Active Role" = Setup."Role Shortcut 5" THEN
                                                                  VALIDATE("Active User", "User Role 5");
                                                              END;

                                                   CaptionML=[DEU=User Role 5;
                                                              ENU=User Role 5;
                                                              ESP=User Role 5;
                                                              FRA=User Role 5;
                                                              NLD=Gebruikersrol 5;
                                                              DEA=User Role 5];
                                                   CaptionClass=CaptionUserRole(5) }
    { 31  ;   ;Active User         ;Code50        ;TableRelation="OM - User";
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Active User Name");
                                                              END;

                                                   CaptionML=[DEU=Active User;
                                                              ENU=Active User;
                                                              ESP=Active User;
                                                              FRA=Active User;
                                                              NLD=Actieve gebruiker;
                                                              DEA=Active User] }
    { 32  ;   ;Active Role         ;Code20        ;TableRelation="OM - Role";
                                                   OnValidate=VAR
                                                                Setup@1000 : Record 11102035;
                                                              BEGIN
                                                                IF "Active Role" <> '' THEN BEGIN
                                                                  Setup.CustomGet;

                                                                  IF (Setup."Role Shortcut 1" = "Active Role") AND ("User Role 1" <> '') THEN
                                                                    VALIDATE("Active User", "User Role 1");

                                                                  IF (Setup."Role Shortcut 2" = "Active Role") AND ("User Role 2" <> '') THEN
                                                                    VALIDATE("Active User", "User Role 2");

                                                                  IF (Setup."Role Shortcut 3" = "Active Role") AND ("User Role 3" <> '') THEN
                                                                    VALIDATE("Active User", "User Role 3");

                                                                  IF (Setup."Role Shortcut 4" = "Active Role") AND ("User Role 4" <> '') THEN
                                                                    VALIDATE("Active User", "User Role 4");

                                                                  IF (Setup."Role Shortcut 5" = "Active Role") AND ("User Role 5" <> '') THEN
                                                                    VALIDATE("Active User", "User Role 5");
                                                                END;

                                                                CALCFIELDS("Active Role Name");
                                                              END;

                                                   CaptionML=[DEU=Active Role;
                                                              ENU=Active Role;
                                                              ESP=Active Role;
                                                              FRA=Active Role;
                                                              NLD=Actieve rol;
                                                              DEA=Active Role] }
    { 33  ;   ;Transport Type Code ;Code20        ;TableRelation="OM - Transport Type";
                                                   OnValidate=VAR
                                                                Setup@1000 : Record 11102035;
                                                                User@1001 : Record 11102056;
                                                                TransportType@1002 : Record 11102098;
                                                              BEGIN
                                                                IF TransportType.GET("Transport Type Code") THEN BEGIN

                                                                  VALIDATE("User Role 1", TransportType."User Role 1");
                                                                  VALIDATE("User Role 2", TransportType."User Role 2");
                                                                  VALIDATE("User Role 3", TransportType."User Role 3");
                                                                  VALIDATE("User Role 4", TransportType."User Role 4");
                                                                  VALIDATE("User Role 5", TransportType."User Role 5");

                                                                  Setup.CustomGet;

                                                                  IF User.GetActiveUser(FALSE) THEN
                                                                    IF User."Default Role" <> '' THEN BEGIN
                                                                      IF (User."Default Role" = Setup."Role Shortcut 1") AND ("User Role 1" = '') THEN
                                                                        VALIDATE("User Role 1", User.Code);
                                                                      IF (User."Default Role" = Setup."Role Shortcut 2") AND ("User Role 2" = '') THEN
                                                                        VALIDATE("User Role 2", User.Code);
                                                                      IF (User."Default Role" = Setup."Role Shortcut 3") AND ("User Role 3" = '') THEN
                                                                        VALIDATE("User Role 3", User.Code);
                                                                      IF (User."Default Role" = Setup."Role Shortcut 4") AND ("User Role 4" = '') THEN
                                                                        VALIDATE("User Role 4", User.Code);
                                                                      IF (User."Default Role" = Setup."Role Shortcut 5") AND ("User Role 5" = '') THEN
                                                                        VALIDATE("User Role 5", User.Code);
                                                                    END;

                                                                  VALIDATE("Update Version List", TransportType."Update Version List");
                                                                  VALIDATE("Version List Id", TransportType."Version List Id");
                                                                  VALIDATE("Transport Flow Code", TransportType."Transport Flow Code");
                                                                  VALIDATE("Deleted Field 36", TransportType."Deleted Field 31");
                                                                  VALIDATE("New Timestamp", TransportType."New Timestamp");
                                                                  VALIDATE("Object Import Mode", TransportType."Object Import Mode");

                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Transport Type Code;
                                                              ENU=Transport Type Code;
                                                              ESP=Transport Type Code;
                                                              FRA=Transport Type Code;
                                                              NLD=Transportsoort;
                                                              DEA=Transport Type Code] }
    { 34  ;   ;Check Overlap       ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[DEU=Check Overlap;
                                                              ENU=Check Overlap;
                                                              ESP=Check Overlap;
                                                              FRA=Check Overlap;
                                                              NLD=Overlapping controleren;
                                                              DEA=Check Overlap] }
    { 35  ;   ;Check Pending Modifications;Boolean;InitValue=Yes;
                                                   CaptionML=[DEU=Check Pending Modifications;
                                                              ENU=Check Pending Modifications;
                                                              ESP=Check Pending Modifications;
                                                              FRA=Check Pending Modifications;
                                                              NLD=Openst. wijzigingen controleren;
                                                              DEA=Check Pending Modifications] }
    { 36  ;   ;Deleted Field 36    ;Boolean       ;CaptionML=[DEU=Deleted Field 36;
                                                              ENU=Deleted Field 36;
                                                              ESP=Deleted Field 36;
                                                              FRA=Deleted Field 36;
                                                              NLD=Deleted Field 36;
                                                              DEA=Deleted Field 36] }
    { 37  ;   ;Main Transport No.  ;Code20        ;TableRelation="OM - Transport";
                                                   CaptionML=[DEU=Main Transport No.;
                                                              ENU=Main Transport No.;
                                                              ESP=Main Transport No.;
                                                              FRA=Main Transport No.;
                                                              NLD=Hoofdtransportnr.;
                                                              DEA=Main Transport No.] }
    { 38  ;   ;Active User Name    ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("OM - User".Name WHERE (Code=FIELD(Active User)));
                                                   CaptionML=[DEU=Active User Name;
                                                              ENU=Active User Name;
                                                              ESP=Active User Name;
                                                              FRA=Active User Name;
                                                              NLD=Actieve gebruikersnaam;
                                                              DEA=Active User Name];
                                                   Editable=No }
    { 39  ;   ;Active Role Name    ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("OM - Role".Description WHERE (Code=FIELD(Active Role)));
                                                   CaptionML=[DEU=Active Role Name;
                                                              ENU=Active Role Name;
                                                              ESP=Active Role Name;
                                                              FRA=Active Role Name;
                                                              NLD=Actieve rolnaam;
                                                              DEA=Active Role Name];
                                                   Editable=No }
    { 40  ;   ;No. of Projects     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("OM - Project" WHERE (Transport No.=FIELD(No.)));
                                                   CaptionML=[DEU=No. of Projects;
                                                              ENU=No. of Projects;
                                                              ESP=No. of Projects;
                                                              FRA=No. of Projects;
                                                              NLD=Aantal projecten;
                                                              DEA=No. of Projects];
                                                   Editable=No }
    { 41  ;   ;Check Guidelines    ;Option        ;CaptionML=[DEU=Check Guidelines;
                                                              ENU=Check Guidelines;
                                                              ESP=Check Guidelines;
                                                              FRA=Check Guidelines;
                                                              NLD=Controleer richtlijnen;
                                                              DEA=Check Guidelines];
                                                   OptionCaptionML=[DEU=" ,All Checks,Transport Checks";
                                                                    ENU=" ,All Checks,Transport Checks";
                                                                    ESP=" ,All Checks,Transport Checks";
                                                                    FRA=" ,All Checks,Transport Checks";
                                                                    NLD=" ,Alle controles,Transportcontroles";
                                                                    DEA=" ,All Checks,Transport Checks"];
                                                   OptionString=[ ,All Checks,Transport Checks] }
    { 42  ;   ;Object Import Mode  ;Option        ;CaptionML=[DEU=Object Import Mode;
                                                              ENU=Object Import Mode;
                                                              ESP=Object Import Mode;
                                                              FRA=Object Import Mode;
                                                              NLD=Objecten importeren;
                                                              DEA=Object Import Mode];
                                                   OptionCaptionML=[DEU=Compiled,Text Merge,Three Way Text Merge;
                                                                    ENU=Compiled,Text Merge,Three Way Text Merge;
                                                                    ESP=Compiled,Text Merge,Three Way Text Merge;
                                                                    FRA=Compiled,Text Merge,Three Way Text Merge;
                                                                    NLD=Gecompileerd,Tekstbestanden mergen,Drie-weg mergen;
                                                                    DEA=Compiled,Text Merge,Three Way Text Merge];
                                                   OptionString=Compiled,Text Merge,Three Way Text Merge }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Status Code                              }
    {    ;Transport Date,Transport Time            }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      SkipCheckBlocked@1000 : Boolean;
      SkipConfirmModify@1001 : Boolean;

    PROCEDURE AddProjects@1();
    VAR
      Project@1000 : Record 11102036;
      Projects@1001 : Page 11102040;
      ctConfirmTransported@1002 : TextConst 'DEU=This transport has already been transported.\Are you sure?;ENU=This transport has already been transported.\Are you sure?;ESP=This transport has already been transported.\Are you sure?;FRA=This transport has already been transported.\Are you sure?;NLD=Dit transport is al getransporteerd.\Weet u het zeker?;DEA=This transport has already been transported.\Are you sure?';
    BEGIN
      Project.FILTERGROUP(2);
      Project.SETRANGE("Transport No.", '');

      IF "Status Type" = "Status Type"::Ready THEN
        Project.SETRANGE("Status Type", Project."Status Type"::Ready);

      Project.FILTERGROUP(0);

      Projects.EDITABLE := FALSE;
      Projects.LOOKUPMODE := TRUE;
      Projects.SETTABLEVIEW(Project);

      IF Projects.RUNMODAL = ACTION::LookupOK THEN BEGIN
        Projects.GetSelectionFilter(Project);
        IF Project.FINDSET THEN BEGIN
          TESTFIELD(Blocked, FALSE);

          IF Transported THEN
            IF NOT CONFIRM(ctConfirmTransported, TRUE) THEN
              ERROR('');

          REPEAT
            Project.VALIDATE("Transport No.", "No.");
            Project.MODIFY(TRUE);
          UNTIL Project.NEXT = 0;
        END;
      END;
    END;

    PROCEDURE SetSkipConfirmModify@2(NewValue@1000 : Boolean);
    BEGIN
      SkipConfirmModify := NewValue;
    END;

    PROCEDURE SetSkipCheckBlocked@3(NewValue@1000 : Boolean);
    BEGIN
      SkipCheckBlocked := NewValue;
    END;

    LOCAL PROCEDURE GetNextNo@4(NosFormat@1000 : Code[20]) : Code[20];
    VAR
      Transport@1001 : Record 11102043;
      LastNo@1002 : Code[20];
      NewNo@1003 : Code[20];
      SearchFilter@1004 : Code[20];
      EndPos@1005 : Integer;
      i@1006 : Integer;
      StartPos@1007 : Integer;
      IsDigit@1008 : Boolean;
      NoEnded@1009 : Boolean;
    BEGIN
      WITH Transport DO
        IF NosFormat <> '' THEN BEGIN
          i := STRLEN(NosFormat);
          REPEAT
            IsDigit := NosFormat[i] IN ['0'..'9'];
            IF IsDigit AND NOT NoEnded THEN BEGIN
              SearchFilter := '?' + SearchFilter;
              IF EndPos = 0 THEN
                EndPos := i;
              IF NOT NoEnded THEN
                StartPos := i;
            END ELSE BEGIN
              SearchFilter := FORMAT(NosFormat[i]) + SearchFilter;
              IF EndPos <> 0 THEN
                NoEnded := TRUE;
            END;
            i -= 1;
          UNTIL i = 0;
          SETFILTER("No.", SearchFilter);
          IF FINDLAST THEN BEGIN
            LastNo := COPYSTR("No.", StartPos, EndPos - StartPos + 1);
            NewNo := INCSTR(LastNo);
            EXIT(DELSTR("No.", StartPos) + NewNo + COPYSTR("No.", EndPos + 1));
          END ELSE
            EXIT(NosFormat);
        END;
    END;

    PROCEDURE CheckAllCommentsPresent@5();
    VAR
      CommentType@1000 : Record 11102044;
      Comment@1001 : Record 11102095;
      cNoComment@1002 : TextConst 'DEU="There is no %1 present in %2 %3=''%4'', %5 %6=''%7''.";ENU="There is no %1 present in %2 %3=''%4'', %5 %6=''%7''.";ESP="There is no %1 present in %2 %3=''%4'', %5 %6=''%7''.";FRA="There is no %1 present in %2 %3=''%4'', %5 %6=''%7''.";NLD="Er is geen %1 aanwezig in %2 %3=''%4'', %5 %6=''%7''.";DEA="There is no %1 present in %2 %3=''%4'', %5 %6=''%7''."';
    BEGIN
      CommentType.SETCURRENTKEY("Table Name", Order);
      CommentType.SETRANGE("Table Name", CommentType."Table Name"::Transport);
      CommentType.SETRANGE(Mandatory, TRUE);
      IF CommentType.FINDSET THEN
        REPEAT
          Comment.SETCURRENTKEY("Table Name", "No.");
          Comment.SETRANGE("Table Name", Comment."Table Name"::Transport);
          Comment.SETRANGE("No.", "No.");
          Comment.SETRANGE(Type, CommentType.Code);
          IF Comment.ISEMPTY THEN
            ERROR(cNoComment,
              Comment.TABLECAPTION,
              TABLECAPTION, FIELDCAPTION("No."), "No.",
              CommentType.TABLECAPTION, CommentType.FIELDCAPTION(Code), CommentType.Code);
        UNTIL CommentType.NEXT = 0;
    END;

    PROCEDURE ShowActionsBefore@6();
    VAR
      ActionWorksheet@1000 : Page 11102060;
      BeforeAfter@1001 : ' ,Before,After';
    BEGIN
      ActionWorksheet.SetTransport(Rec, BeforeAfter::Before);
      ActionWorksheet.RUN;
    END;

    PROCEDURE ShowActionsAfter@7();
    VAR
      ActionWorksheet@1000 : Page 11102060;
      BeforeAfter@1001 : ' ,Before,After';
    BEGIN
      ActionWorksheet.SetTransport(Rec, BeforeAfter::After);
      ActionWorksheet.RUN;
    END;

    PROCEDURE ShowTests@8();
    VAR
      TestWorksheet@1000 : Page 11102125;
    BEGIN
      TestWorksheet.SetTransport(Rec);
      TestWorksheet.RUN;
    END;

    PROCEDURE MarkObjects@9();
    VAR
      Project@1000 : Record 11102036;
      ProjectObject@1001 : Record 11102037;
      Object@1002 : Record 2000000001;
      VersionControl@1003 : Codeunit 11102040;
    BEGIN
      VersionControl.CheckMarkLock;

      Project.SETCURRENTKEY("Transport No.");
      Project.SETRANGE("Transport No.", "No.");
      IF Project.FINDSET THEN
        REPEAT
          ProjectObject.SETRANGE("Project No.", Project."No.");
          IF ProjectObject.FINDSET THEN
            REPEAT
              IF Object.GET(ProjectObject."Object Type", '', ProjectObject."Object No.") THEN
                VersionControl.MarkObject(Object, TRUE);
            UNTIL ProjectObject.NEXT = 0;
        UNTIL Project.NEXT = 0;
    END;

    PROCEDURE RemoveMarks@10();
    VAR
      Project@1000 : Record 11102036;
      ProjectObject@1001 : Record 11102037;
      Object@1002 : Record 2000000001;
      VersionControl@1003 : Codeunit 11102040;
    BEGIN
      Project.SETCURRENTKEY("Transport No.");
      Project.SETRANGE("Transport No.", "No.");
      IF Project.FINDSET THEN
        REPEAT
          ProjectObject.SETRANGE("Project No.", Project."No.");
          IF ProjectObject.FINDSET THEN
            REPEAT
              IF Object.GET(ProjectObject."Object Type", '', ProjectObject."Object No.") THEN
                VersionControl.RemoveObjectMark(Object);
            UNTIL ProjectObject.NEXT = 0;
        UNTIL Project.NEXT = 0;

      VersionControl.RemoveMarkLock(TRUE);
    END;

    PROCEDURE FillNewVersionNo@11();
    VAR
      VersionControl@1000 : Codeunit 11102040;
    BEGIN
      "Version No." := INCSTR(VersionControl.GetLastTransportNumber("Version List Id"));
    END;

    PROCEDURE DeleteChildTables@12();
    VAR
      DocumentLine@1000 : Record 11102046;
      TransportProjectHistory@1001 : Record 11102066;
      Comment@1002 : Record 11102095;
    BEGIN
      Comment.SETCURRENTKEY("Table Name", "No.");
      Comment.SETRANGE("Table Name", Comment."Table Name"::Transport);
      Comment.SETRANGE("No.", "No.");
      Comment.DELETEALL(TRUE);

      DocumentLine.SETRANGE("Table Name", DocumentLine."Table Name"::Transport);
      DocumentLine.SETRANGE("No.", "No.");
      DocumentLine.DELETEALL;

      TransportProjectHistory.SETRANGE("Transport No.", "No.");
      TransportProjectHistory.DELETEALL;
    END;

    PROCEDURE UpdateRepository@13(Trigger@1000 : Integer);
    VAR
      RepositoryMgt@1001 : Codeunit 11102067;
      RecRef@1002 : RecordRef;
    BEGIN
      RecRef.GETTABLE(Rec);
      RepositoryMgt.UpdateTransport(RecRef, "No.", Trigger);
      RecRef.SETTABLE(Rec);
    END;

    LOCAL PROCEDURE CaptionUserRole@14(No@1000 : Integer) : Text;
    VAR
      Mgt@1001 : Codeunit 11102035;
      RoleDescription@1002 : Text;
      ctEmptyDescription@1003 : TextConst 'DEU=User Role %1;ENU=User Role %1;ESP=User Role %1;FRA=User Role %1;NLD=Gebruikersrol %1;DEA=User Role %1';
    BEGIN
      RoleDescription := Mgt.ShortcutCaption(No);
      IF RoleDescription = '' THEN
        RoleDescription := STRSUBSTNO(ctEmptyDescription, No);

      EXIT(RoleDescription);
    END;

    PROCEDURE LookupStatusCode@15(VAR Text@1000 : Text) : Boolean;
    VAR
      Status@1001 : Record 11102039;
      StatusList@1002 : Page 11102045;
    BEGIN
      Status.FILTERGROUP(10);
      Status.SETRANGE("Table Name", Status."Table Name"::Transport);
      Status.FILTERGROUP(0);

      IF "Transport Flow Code" <> '' THEN BEGIN
        Status.SETRANGE("Flow Code Filter", "Transport Flow Code");
        Status.SETRANGE("In Flow", TRUE);
      END;

      StatusList.SETTABLEVIEW(Status);
      IF Status.GET(Status."Table Name"::Transport, "Status Code") THEN
        StatusList.SETRECORD(Status);

      StatusList.LOOKUPMODE := TRUE;
      StatusList.EDITABLE := FALSE;
      IF StatusList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        StatusList.GETRECORD(Status);
        Text := Status.Code;
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE SendEmails@16();
    VAR
      Setup@1000 : Record 11102035;
      FlowStatus@1001 : Record 11102041;
      Role@1002 : Record 11102055;
      TmpUser@1003 : TEMPORARY Record 11102056;
      User@1004 : Record 11102056;
      Mgt@1005 : Codeunit 11102035;
      MailMgt@1006 : Codeunit 11102084;
      ApplicationSettings@1007 : Codeunit 11102101;
      CrLf@1008 : Text;
      ctBodyLine1@1009 : TextConst 'DEU=User %1 has switched transport %2: "%3" to status %4.;ENU=User %1 has switched transport %2: "%3" to status %4.;ESP=User %1 has switched transport %2: "%3" to status %4.;FRA=User %1 has switched transport %2: "%3" to status %4.;NLD=Gebruiker %1 heeft transport %2: "%3" omgezet naar status %4.;DEA=User %1 has switched transport %2: "%3" to status %4.';
      ctBodyLine2@1010 : TextConst 'DEU=Server: %1;ENU=Server: %1;ESP=Server: %1;FRA=Server: %1;NLD=Server: %1;DEA=Server: %1';
      ctBodyLine3@1011 : TextConst 'DEU=Database: %1;ENU=Database: %1;ESP=Database: %1;FRA=Database: %1;NLD=Database: %1;DEA=Database: %1';
      ctSendMail@1012 : TextConst 'DEU=Do you want to send an e-mail to %1?;ENU=Do you want to send an e-mail to %1?;ESP=Do you want to send an e-mail to %1?;FRA=Do you want to send an e-mail to %1?;NLD=Wilt u een e-mail versturen naar %1?;DEA=Do you want to send an e-mail to %1?';
      ctSendMails@1013 : TextConst 'DEU=Do you want to send e-mails?;ENU=Do you want to send e-mails?;ESP=Do you want to send e-mails?;FRA=Do you want to send e-mails?;NLD=Wilt u e-mails versturen?;DEA=Do you want to send e-mails?';
      ctSubject@1014 : TextConst 'DEU=Transport %1: "%2" has reached status %3;ENU=Transport %1: "%2" has reached status %3;ESP=Transport %1: "%2" has reached status %3;FRA=Transport %1: "%2" has reached status %3;NLD=Transport %1 - %2 heeft status %3 bereikt;DEA=Transport %1: "%2" has reached status %3';
    BEGIN
      FlowStatus.SETRANGE("Table Name", FlowStatus."Table Name"::Transport);
      FlowStatus.SETRANGE("Flow Code", "Transport Flow Code");
      FlowStatus.SETRANGE("Status Code", "Status Code");
      IF FlowStatus.FINDFIRST THEN BEGIN

        IF FlowStatus."Send E-Mail to Active User" THEN
          IF User.GET("Active User") THEN
            User.AddToTempRecord(TmpUser);

        IF FlowStatus."Send E-Mail to Roles" <> '' THEN BEGIN

          Setup.CustomGet;

          Role.SETFILTER(Code, FlowStatus."Send E-Mail to Roles");
          IF Role.FINDSET THEN
            REPEAT

              IF (Setup."Role Shortcut 1" = Role.Code) AND ("User Role 1" <> '') THEN
                IF User.GET("User Role 1") THEN
                  User.AddToTempRecord(TmpUser);

              IF (Setup."Role Shortcut 2" = Role.Code) AND ("User Role 2" <> '') THEN
                IF User.GET("User Role 2") THEN
                  User.AddToTempRecord(TmpUser);

              IF (Setup."Role Shortcut 3" = Role.Code) AND ("User Role 3" <> '') THEN
                IF User.GET("User Role 3") THEN
                  User.AddToTempRecord(TmpUser);

              IF (Setup."Role Shortcut 4" = Role.Code) AND ("User Role 4" <> '') THEN
                IF User.GET("User Role 4") THEN
                  User.AddToTempRecord(TmpUser);

              IF (Setup."Role Shortcut 5" = Role.Code) AND ("User Role 5" <> '') THEN
                IF User.GET("User Role 5") THEN
                  User.AddToTempRecord(TmpUser);

            UNTIL Role.NEXT = 0;
        END;

        TmpUser.SETFILTER("E-Mail", '<>%1', '');
        CASE TmpUser.COUNT OF
          0 : EXIT;
          1 :
            IF TmpUser.FINDFIRST THEN
              IF NOT CONFIRM(ctSendMail, TRUE, TmpUser.Name) THEN
                EXIT;
          ELSE
            IF NOT CONFIRM(ctSendMails, TRUE) THEN
              EXIT;
        END;

        CrLf[1] := 13;
        CrLf[2] := 10;

        IF TmpUser.FINDSET THEN
          REPEAT

            MailMgt.ToAddress := TmpUser."E-Mail";
            MailMgt.Subject := STRSUBSTNO(ctSubject, "No.", Description, "Status Code");
            MailMgt.AddToBody(
              STRSUBSTNO(ctBodyLine1, Mgt.ShortUserId, "No.", Description, "Status Code") + CrLf + CrLf +
              STRSUBSTNO(ctBodyLine2, ApplicationSettings.ServerInstanceName) + CrLf +
              STRSUBSTNO(ctBodyLine3, ApplicationSettings.DatabaseName));

            MailMgt.Send;

          UNTIL TmpUser.NEXT = 0;

      END;
    END;

    PROCEDURE AssistEdit@19() : Boolean;
    VAR
      Transport@1000 : Record 11102043;
      TransportType@1001 : Record 11102098;
      TransportTypeList@1002 : Page 11175784;
    BEGIN
      WITH Transport DO BEGIN
        Transport := Rec;

        IF TransportType.GET(xRec."Transport Type Code") THEN
          TransportTypeList.SETRECORD(TransportType);

        TransportTypeList.LOOKUPMODE(TRUE);
        IF TransportTypeList.RUNMODAL = ACTION::LookupOK THEN BEGIN

          TransportTypeList.GETRECORD(TransportType);
          VALIDATE("Transport Type Code", TransportType.Code);

          IF ("No." = '') AND (TransportType."Nos. Format" <> '') THEN
            "No." := GetNextNo(TransportType."Nos. Format");

          IF (Description = '') AND (TransportType."Transport Description" <> '') THEN
            VALIDATE(Description, STRSUBSTNO(FORMAT(WORKDATE, 0, TransportType."Transport Description"), "No."));

          Rec := Transport;
          EXIT(TRUE);
        END;

      END;
    END;

    PROCEDURE ResetStatus@20();
    VAR
      Flow@1000 : Record 11102040;
      ctResetStatus@1001 : TextConst 'DEU=This transport has already been transported.\Are you sure?;ENU=This transport has already been transported.\Are you sure?;ESP=This transport has already been transported.\Are you sure?;FRA=This transport has already been transported.\Are you sure?;NLD=Dit transport is al getransporteerd.\Weet u het zeker?;DEA=This transport has already been transported.\Are you sure?';
    BEGIN
      IF Transported THEN
        IF NOT CONFIRM(ctResetStatus, TRUE) THEN
          EXIT;

      Transported := FALSE;

      IF Flow.GET(Flow."Table Name"::Transport, "Transport Flow Code") THEN
        VALIDATE("Status Code", Flow.DefaultStatus);

      MODIFY(TRUE);
    END;

    PROCEDURE Rollback@21();
    VAR
      RollbackObjects@1000 : Page 11102098;
    BEGIN
      RollbackObjects.SetRunType(2, "No.");
      RollbackObjects.RUN;
    END;

    PROCEDURE PushObjects@22() ExitValue : Integer;
    VAR
      Project@1000 : Record 11102036;
      ProjectObject@1001 : Record 11102037;
      NAVDatabase@1002 : Record 11102099;
      Object@1003 : Record 2000000001;
      TmpObject@1004 : TEMPORARY Record 2000000001;
      PushObjects@1005 : Codeunit 11102098;
    BEGIN
      IF PAGE.RUNMODAL(0, NAVDatabase) <> ACTION::LookupOK THEN
        EXIT;

      Project.SETCURRENTKEY("Transport No.");
      Project.SETRANGE("Transport No.", "No.");
      IF Project.FINDSET THEN
        REPEAT
          ProjectObject.SETRANGE("Project No.", Project."No.");
          IF ProjectObject.FINDSET THEN
            REPEAT
              IF NOT TmpObject.GET(ProjectObject."Object Type", '', ProjectObject."Object No.") THEN
                IF Object.GET(ProjectObject."Object Type", '', ProjectObject."Object No.") THEN BEGIN
                  TmpObject := Object;
                  TmpObject.INSERT;
                END;
            UNTIL ProjectObject.NEXT = 0;
        UNTIL Project.NEXT = 0;

      TmpObject.FINDFIRST;
      PushObjects.SetToDatabaseCode(NAVDatabase.Code);
      PushObjects.RUN(TmpObject);
    END;

    PROCEDURE NextStatus@18();
    VAR
      Status@1000 : Record 11102039;
    BEGIN
      GetNextStatus(Status);
      IF SelectStatus(Status) THEN
        SetStatus(Status);
    END;

    PROCEDURE GetNextStatus@36(VAR Status@1000 : Record 11102039);
    VAR
      FlowStatus@1001 : Record 11102041;
    BEGIN
      FlowStatus.SETRANGE("Table Name", FlowStatus."Table Name"::Transport);
      FlowStatus.SETRANGE("Flow Code", "Transport Flow Code");
      FlowStatus.SETRANGE("Status Code", "Status Code");
      FlowStatus.FINDFIRST;

      IF FlowStatus."Next Status" = '' THEN BEGIN
        FlowStatus.SETRANGE("Status Code");
        FlowStatus.NEXT(1);
        Status.GET(Status."Table Name"::Transport, FlowStatus."Status Code");
        Status.SETRECFILTER;
      END ELSE BEGIN
        Status.SETRANGE("Table Name", Status."Table Name"::Transport);
        Status.SETFILTER(Code, FlowStatus."Next Status");
      END;
    END;

    PROCEDURE PreviousStatus@17();
    VAR
      Status@1000 : Record 11102039;
    BEGIN
      GetPreviousStatus(Status);
      IF SelectStatus(Status) THEN
        SetStatus(Status);
    END;

    PROCEDURE GetPreviousStatus@40(VAR Status@1000 : Record 11102039);
    VAR
      FlowStatus@1001 : Record 11102041;
    BEGIN
      FlowStatus.SETRANGE("Table Name", FlowStatus."Table Name"::Transport);
      FlowStatus.SETRANGE("Flow Code", "Transport Flow Code");
      FlowStatus.SETRANGE("Status Code", "Status Code");
      FlowStatus.FINDFIRST;

      IF FlowStatus."Previous Status" = '' THEN BEGIN
        FlowStatus.SETRANGE("Status Code");
        FlowStatus.NEXT(-1);
        Status.GET(Status."Table Name"::Transport, FlowStatus."Status Code");
        Status.SETRECFILTER;
      END ELSE BEGIN
        Status.SETRANGE("Table Name", Status."Table Name"::Transport);
        Status.SETFILTER(Code, FlowStatus."Previous Status");
      END;
    END;

    PROCEDURE SelectStatus@37(VAR Status@1000 : Record 11102039) : Boolean;
    VAR
      StatusList@1001 : Page 11102045;
    BEGIN
      IF Status.COUNT = 1 THEN BEGIN
        Status.FINDFIRST;
        EXIT(TRUE);
      END;

      StatusList.SETTABLEVIEW(Status);
      StatusList.LOOKUPMODE := TRUE;
      StatusList.EDITABLE := FALSE;
      IF StatusList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        StatusList.GETRECORD(Status);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE SetStatus@42(VAR Status@1000 : Record 11102039);
    BEGIN
      VALIDATE("Status Code", Status.Code);
      MODIFY(TRUE);
    END;

    PROCEDURE LockObjects@24();
    VAR
      Project@1000 : Record 11102036;
      ProjectObject@1001 : Record 11102037;
      ObjectLock@1002 : Record 11102054;
      Object@1003 : Record 2000000001;
    BEGIN
      Project.SETCURRENTKEY("Transport No.");
      Project.SETRANGE("Transport No.", "No.");
      IF Project.FINDSET THEN
        REPEAT
          ProjectObject.SETRANGE("Project No.", Project."No.");
          IF ProjectObject.FINDSET THEN
            REPEAT
              IF Object.GET(ProjectObject."Object Type", '', ProjectObject."Object No.") THEN
                ObjectLock.InsertLock(Object);
            UNTIL ProjectObject.NEXT = 0;
        UNTIL Project.NEXT = 0;
    END;

    PROCEDURE RemoveObjectLocks@23();
    VAR
      Project@1000 : Record 11102036;
      ProjectObject@1001 : Record 11102037;
      ObjectLock@1002 : Record 11102054;
    BEGIN
      Project.SETCURRENTKEY("Transport No.");
      Project.SETRANGE("Transport No.", "No.");
      IF Project.FINDSET THEN
        REPEAT
          ProjectObject.SETRANGE("Project No.", Project."No.");
          IF ProjectObject.FINDSET THEN
            REPEAT
              IF ObjectLock.GET(ProjectObject."Object Type", ProjectObject."Object No.") THEN
                ObjectLock.DELETE(TRUE);
            UNTIL ProjectObject.NEXT = 0;
        UNTIL Project.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

