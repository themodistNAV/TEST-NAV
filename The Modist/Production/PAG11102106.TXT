OBJECT Page 11102106 OM - Compare Fields
{
  OBJECT-PROPERTIES
  {
    Date=19/11/15;
    Time=12:00:00 PM;
    Version List=OMA10.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Compare Fields;
               ENU=Compare Fields;
               ESP=Compare Fields;
               FRA=Compare Fields;
               NLD=Velden vergelijken;
               DEA=Compare Fields];
    SaveValues=Yes;
    InsertAllowed=No;
    SourceTable=Table11102067;
    PageType=Worksheet;
    PromotedActionCategoriesML=[ENU=0,1,2,Object,Process;
                                NLD=0,1,2,Object,Verwerken];
    OnOpenPage=VAR
                 FileHandler@1000 : Codeunit 11102097;
                 CompareFieldsMgt@1001 : Codeunit 11102103;
                 OpeningServerFileName@1002 : Text;
                 ctFieldFileName@1003 : TextConst 'DEU=fields.fld;ENU=fields.fld;ESP=fields.fld;FRA=fields.fld;NLD=fields.fld;DEA=fields.fld';
               BEGIN
                 IF NOT Initialized THEN BEGIN
                   Initialized := TRUE;
                   LeftIsCurrentDatabase := TRUE;
                 END;

                 IF OpeningClientFileName <> '' THEN BEGIN
                   DELETEALL;
                   RightDatabaseCode := '';
                   OpeningServerFileName := FileHandler.UploadToServer(OpeningClientFileName, ctFieldFileName);
                   CompareFieldsMgt.ImportFile(
                     OpeningServerFileName, LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus);
                   LeftIsCurrentDatabase := FALSE;
                   LeftDatabaseCode := '';
                 END;

                 IF OpeningClientDirectoryName <> '' THEN BEGIN
                   DELETEALL;
                   RightDatabaseCode := '';
                   CompareFieldsMgt.ImportDirectory(
                     OpeningClientDirectoryName, LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus);
                   LeftIsCurrentDatabase := FALSE;
                   LeftDatabaseCode := '';
                 END;
               END;

    OnAfterGetRecord=VAR
                       KnownObjectExportError@1000 : Record 11102073;
                       Object@1001 : Record 2000000001;
                       SourceControl@1002 : Codeunit 11102050;
                     BEGIN
                       IF LeftIsCurrentDatabase THEN BEGIN
                         LeftRowStyle := '';
                         IF Object.GET(Object.Type::Table, '', "Table No.") THEN
                           IF SourceControl.ObjectHeaderIsOutdated(Object, FALSE) THEN BEGIN
                             LeftRowStyle := 'Attention';
                             IF KnownObjectExportError.GET(KnownObjectExportError."Object Type"::Table, "Table No.") THEN
                               LeftRowStyle := 'Unfavorable';
                           END;
                       END ELSE
                         LeftRowStyle := GetRowStyle(TmpHistoryStatus[1], "Table No.");

                       RightRowStyle := GetRowStyle(TmpHistoryStatus[2], "Table No.");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetFooterStyle;
                         END;

    ActionList=ACTIONS
    {
      { 1       ;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 83      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Object;
                                 ENU=&Object;
                                 ESP=&Object;
                                 FRA=&Object;
                                 NLD=&Object;
                                 DEA=&Object] }
      { 82      ;2   ;Action    ;
                      ShortCutKey=Ctrl+D;
                      CaptionML=[DEU=&Code;
                                 ENU=&Code;
                                 ESP=&Code;
                                 FRA=&Code;
                                 NLD=&Code;
                                 DEA=&Code];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=DesignCodeBehind;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Object@1000 : Record 2000000001;
                                 EditorMgt@1001 : Codeunit 11102106;
                               BEGIN
                                 EditorMgt.OpenEditorWithLifeObject(Object.Type::Table, "Table No.");
                               END;
                                }
      { 81      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F2;
                      CaptionML=[DEU=Design;
                                 ENU=Design;
                                 ESP=Design;
                                 FRA=Design;
                                 NLD=Design;
                                 DEA=Design];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Design;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Object@1000 : Record 2000000001;
                                 ObjectMgt@1001 : Codeunit 11102046;
                               BEGIN
                                 Object.GET(Object.Type::Table, '', "Table No.");
                                 ObjectMgt.DesignObject(Object);
                               END;
                                }
      { 80      ;2   ;Action    ;
                      ShortCutKey=Ctrl+R;
                      CaptionML=[DEU=Run;
                                 ENU=Run;
                                 ESP=Run;
                                 FRA=Run;
                                 NLD=Run;
                                 DEA=Run];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Object@1000 : Record 2000000001;
                                 ObjectMgt@1001 : Codeunit 11102046;
                               BEGIN
                                 Object.GET(Object.Type::Table, '', "Table No.");
                                 ObjectMgt.RunObject(Object);
                               END;
                                }
      { 84      ;2   ;Action    ;
                      CaptionML=[DEU=Navigate;
                                 ENU=Navigate;
                                 ESP=Navigate;
                                 FRA=Navigate;
                                 NLD=Navigeren;
                                 DEA=Navigate];
                      Image=Navigate;
                      OnAction=VAR
                                 Object@1000 : Record 2000000001;
                                 ObjectMgt@1001 : Codeunit 11102046;
                               BEGIN
                                 Object.GET(Object.Type::Table, '', "Table No.");
                                 ObjectMgt.Navigate(Object);
                               END;
                                }
      { 2       ;1   ;ActionGroup;
                      CaptionML=[DEU=F&unctions;
                                 ENU=F&unctions;
                                 ESP=F&unctions;
                                 FRA=F&unctions;
                                 NLD=F&uncties;
                                 DEA=F&unctions] }
      { 3       ;2   ;Action    ;
                      ShortCutKey=F5;
                      CaptionML=[DEU=Refresh;
                                 ENU=Refresh;
                                 ESP=Refresh;
                                 FRA=Refresh;
                                 NLD=Vernieu&wen;
                                 DEA=Refresh];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Refresh;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 Refresh;
                               END;
                                }
      { 4       ;2   ;Action    ;
                      ShortCutKey=Ctrl+G;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Add Tables;
                                 ENU=Add Tables;
                                 ESP=Add Tables;
                                 FRA=Add Tables;
                                 NLD=Tabellen toevoegen;
                                 DEA=Add Tables];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Add;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 CompareFieldsMgt@1000 : Codeunit 11102103;
                               BEGIN
                                 CompareFieldsMgt.AddTables(LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      CaptionML=[DEU=Add Field Di&fferences;
                                 ENU=Add Field Di&fferences;
                                 ESP=Add Field Di&fferences;
                                 FRA=Add Field Di&fferences;
                                 NLD=Afwijkende velden toevoegen;
                                 DEA=Add Field Di&fferences];
                      Image=AddAction;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 TmpExistingObject@1001 : TEMPORARY Record 2000000001;
                                 TmpNewExistingObject@1002 : TEMPORARY Record 2000000001;
                                 Progressbar@1003 : Codeunit 11102044;
                                 CompareFieldsMgt@1004 : Codeunit 11102103;
                                 ctAddingTables@1005 : TextConst 'DEU=Adding tables...;ENU=Adding tables...;ESP=Adding tables...;FRA=Adding tables...;NLD=Tabellen toevoegen...;DEA=Adding tables...';
                                 ctNoDatabaseChosen@1006 : TextConst 'DEU=No database chosen.;ENU=No database chosen.;ESP=No database chosen.;FRA=No database chosen.;NLD=Geen database gekozen.;DEA=No database chosen.';
                               BEGIN
                                 IF RightDatabaseCode = '' THEN
                                   ERROR(ctNoDatabaseChosen);

                                 GetAddedObjects(TmpExistingObject);

                                 Progressbar.Open(ctAddingTables, 0);

                                 CompareFieldsMgt.AddTablesWithDifferences(
                                   LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus, Progressbar);

                                 GetAddedObjects(TmpNewExistingObject);

                                 Progressbar.BarSize := TmpNewExistingObject.COUNT;
                                 Progressbar.UseRange(95, 100);
                                 IF TmpNewExistingObject.FINDSET THEN
                                   REPEAT
                                     Progressbar.AddToBar(1);
                                     IF NOT TmpExistingObject.GET(TmpNewExistingObject.Type, '', TmpNewExistingObject.ID) THEN BEGIN
                                       FieldCompareLine.SETRANGE("Table No.", TmpNewExistingObject.ID);
                                       FieldCompareLine.SETRANGE(Different, FALSE);
                                       FieldCompareLine.DELETEALL;
                                     END;
                                   UNTIL TmpNewExistingObject.NEXT = 0;

                                 Progressbar.Close;
                               END;
                                }
      { 6       ;2   ;Separator  }
      { 7       ;2   ;Action    ;
                      CaptionML=[DEU=Empty Fields;
                                 ENU=Empty Fields;
                                 ESP=Empty Fields;
                                 FRA=Empty Fields;
                                 NLD=Velden leegmaken;
                                 DEA=Empty Fields];
                      Image=DeleteQtyToHandle;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                                 ctEmptySelectedField@1002 : TextConst 'DEU=Selected fields will be emptied.\Are you sure?;ENU=Selected fields will be emptied.\Are you sure?;ESP=Selected fields will be emptied.\Are you sure?;FRA=Selected fields will be emptied.\Are you sure?;NLD=De geselecteerde velden zullen worden leeggemaakt.\Weet u het zeker?;DEA=Selected fields will be emptied.\Are you sure?';
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(FieldCompareLine);
                                 FieldCompareLine.SETFILTER(Name, '<>%1', '');

                                 IF CONFIRM(ctEmptySelectedField, TRUE) THEN
                                   CompareFieldsMgt.EmptyFields(FieldCompareLine);
                               END;
                                }
      { 8       ;2   ;Action    ;
                      CaptionML=[DEU=Delete Fields;
                                 ENU=Delete Fields;
                                 ESP=Delete Fields;
                                 FRA=Delete Fields;
                                 NLD=Vel&den verwijderen;
                                 DEA=Delete Fields];
                      Image=Delete;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                                 ctDeleteSelectedField@1002 : TextConst 'DEU=Selected fields will be deleted.\Are you sure?;ENU=Selected fields will be deleted.\Are you sure?;ESP=Selected fields will be deleted.\Are you sure?;FRA=Selected fields will be deleted.\Are you sure?;NLD=De geselecteerde velden zullen worden verwijderd.\Weet u het zeker?;DEA=Selected fields will be deleted.\Are you sure?';
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(FieldCompareLine);
                                 FieldCompareLine.SETFILTER(Name, '<>%1', '');

                                 IF CONFIRM(ctDeleteSelectedField, TRUE) THEN
                                   CompareFieldsMgt.DeleteFields(FieldCompareLine);
                               END;
                                }
      { 9       ;2   ;Action    ;
                      CaptionML=[DEU=Add to Renumber Fields &Tool;
                                 ENU=Add to Renumber Fields &Tool;
                                 ESP=Add to Renumber Fields &Tool;
                                 FRA=Add to Renumber Fields &Tool;
                                 NLD=Velden &omnummeren;
                                 DEA=Add to Renumber Fields &Tool];
                      Image=StepInto;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                                 RenumberFields@1002 : Page 11102108;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(FieldCompareLine);
                                 FieldCompareLine.SETFILTER(Name, '<>%1', '');
                                 FieldCompareLine.FINDFIRST;

                                 CompareFieldsMgt.AddToRenumberTool(FieldCompareLine);

                                 COMMIT;
                                 RenumberFields.RUNMODAL;
                               END;
                                }
      { 10      ;2   ;Separator  }
      { 11      ;2   ;Action    ;
                      CaptionML=[DEU=Show Changes in Directory;
                                 ENU=Show Changes in Directory;
                                 ESP=Show Changes in Directory;
                                 FRA=Show Changes in Directory;
                                 NLD=Toon wijzigingen in &map;
                                 DEA=Show Changes in Directory];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewPage;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);
                                 CompareFieldsMgt.ShowChangesInDirectory(FieldCompareLine);
                               END;
                                }
      { 12      ;2   ;Action    ;
                      CaptionML=[DEU=Show Changes &in One File;
                                 ENU=Show Changes &in One File;
                                 ESP=Show Changes &in One File;
                                 FRA=Show Changes &in One File;
                                 NLD=Toon wijzigingen &in ‚‚n bestand;
                                 DEA=Show Changes &in One File];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewDocumentLine;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);
                                 CompareFieldsMgt.ShowChangesOneFile(FieldCompareLine);
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      CaptionML=[DEU=Left;
                                 ENU=Left;
                                 ESP=Left;
                                 FRA=Left;
                                 NLD=Links;
                                 DEA=Left] }
      { 14      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[DEU=Refresh;
                                 ENU=Refresh;
                                 ESP=Refresh;
                                 FRA=Refresh;
                                 NLD=Links vernieuwen;
                                 DEA=Refresh];
                      Image=Refresh;
                      OnAction=BEGIN
                                 RefreshLeft;
                               END;
                                }
      { 15      ;2   ;ActionGroup;
                      CaptionML=[DEU=Import;
                                 ENU=Import;
                                 ESP=Import;
                                 FRA=Import;
                                 NLD=Importeren;
                                 DEA=Import];
                      Image=Import }
      { 16      ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Import Fields File;
                                 ENU=Import Fields File;
                                 ESP=Import Fields File;
                                 FRA=Import Fields File;
                                 NLD=Importeer links veldenbestand;
                                 DEA=Import Fields File];
                      Image=Import;
                      OnAction=VAR
                                 CompareFieldsMgt@1000 : Codeunit 11102103;
                               BEGIN
                                 IF NOT CompareFieldsMgt.ImportLeft(LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus) THEN
                                   EXIT;

                                 LeftIsCurrentDatabase := FALSE;
                                 LeftDatabaseCode := '';
                               END;
                                }
      { 17      ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Import &Split Fields Files;
                                 ENU=Import &Split Fields Files;
                                 ESP=Import &Split Fields Files;
                                 FRA=Import &Split Fields Files;
                                 NLD=Importeer links &gesplitst veldenbestand;
                                 DEA=Import &Split Fields Files];
                      Image=Import;
                      OnAction=VAR
                                 CompareFieldsMgt@1000 : Codeunit 11102103;
                               BEGIN
                                 CompareFieldsMgt.ImportLeftSplit(LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus);
                               END;
                                }
      { 18      ;2   ;ActionGroup;
                      CaptionML=[DEU=Export;
                                 ENU=Export;
                                 ESP=Export;
                                 FRA=Export;
                                 NLD=Exporteren;
                                 DEA=Export];
                      Image=Export }
      { 19      ;3   ;Action    ;
                      CaptionML=[DEU=Export to Fields File;
                                 ENU=Export to Fields File;
                                 ESP=Export to Fields File;
                                 FRA=Export to Fields File;
                                 NLD=Linker objecten exporteren naar bestand;
                                 DEA=Export to Fields File];
                      Image=Export;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);
                                 CompareFieldsMgt.ExportLeft(FieldCompareLine);
                               END;
                                }
      { 20      ;3   ;Action    ;
                      CaptionML=[DEU=Export to &Split Fields Files;
                                 ENU=Export to &Split Fields Files;
                                 ESP=Export to &Split Fields Files;
                                 FRA=Export to &Split Fields Files;
                                 NLD=Linker objecten exporteren naar &map;
                                 DEA=Export to &Split Fields Files];
                      Image=Export;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);

                                 CompareFieldsMgt.ExportLeftSplit(FieldCompareLine);
                               END;
                                }
      { 21      ;2   ;ActionGroup;
                      CaptionML=[DEU=Mark;
                                 ENU=Mark;
                                 ESP=Mark;
                                 FRA=Mark;
                                 NLD=Markeren;
                                 DEA=Mark];
                      Image=EditFilter }
      { 22      ;3   ;Action    ;
                      ShortCutKey=Ctrl+M;
                      CaptionML=[DEU=Mark Objects;
                                 ENU=Mark Objects;
                                 ESP=Mark Objects;
                                 FRA=Mark Objects;
                                 NLD=Objecten markeren &linker database;
                                 DEA=Mark Objects];
                      Image=EditFilter;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);

                                 CompareFieldsMgt.MarkObjectsLeft(FieldCompareLine, LeftIsCurrentDatabase, LeftDatabaseCode);
                               END;
                                }
      { 23      ;3   ;Action    ;
                      CaptionML=[DEU=Remove Marks;
                                 ENU=Remove Marks;
                                 ESP=Remove Marks;
                                 FRA=Remove Marks;
                                 NLD=Verwijder markeringen linker database;
                                 DEA=Remove Marks];
                      Image=RemoveFilterLines;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);

                                 CompareFieldsMgt.RemoveMarksLeft(FieldCompareLine, LeftIsCurrentDatabase, LeftDatabaseCode);
                               END;
                                }
      { 24      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+M;
                      CaptionML=[DEU=Remove &all Marks;
                                 ENU=Remove &all Marks;
                                 ESP=Remove &all Marks;
                                 FRA=Remove &all Marks;
                                 NLD=Verwijder &alle markeringen linker database;
                                 DEA=Remove &all Marks];
                      Image=ClearFilter;
                      OnAction=VAR
                                 CompareFieldsMgt@1000 : Codeunit 11102103;
                               BEGIN
                                 CompareFieldsMgt.RemoveAllMarksLeft(LeftIsCurrentDatabase, LeftDatabaseCode);
                               END;
                                }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[DEU=Right;
                                 ENU=Right;
                                 ESP=Right;
                                 FRA=Right;
                                 NLD=Rechts;
                                 DEA=Right] }
      { 26      ;2   ;Action    ;
                      ShortCutKey=Alt+F5;
                      CaptionML=[DEU=Refresh;
                                 ENU=Refresh;
                                 ESP=Refresh;
                                 FRA=Refresh;
                                 NLD=Rechts vernieuwen;
                                 DEA=Refresh];
                      Image=Refresh;
                      OnAction=BEGIN
                                 RefreshRight;
                               END;
                                }
      { 27      ;2   ;ActionGroup;
                      CaptionML=[DEU=Import;
                                 ENU=Import;
                                 ESP=Import;
                                 FRA=Import;
                                 NLD=Importeren;
                                 DEA=Import];
                      Image=Import }
      { 28      ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Import Fields File;
                                 ENU=Import Fields File;
                                 ESP=Import Fields File;
                                 FRA=Import Fields File;
                                 NLD=Importeer &rechts veldenbestand;
                                 DEA=Import Fields File];
                      Image=Import;
                      OnAction=VAR
                                 CompareFieldsMgt@1000 : Codeunit 11102103;
                               BEGIN
                                 IF NOT CompareFieldsMgt.ImportRight(LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus) THEN
                                   EXIT;

                                 RightDatabaseCode := '';
                               END;
                                }
      { 29      ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Import Split Fields Files;
                                 ENU=Import Split Fields Files;
                                 ESP=Import Split Fields Files;
                                 FRA=Import Split Fields Files;
                                 NLD=Importeer rechts ges&plitst veldenbestand;
                                 DEA=Import Split Fields Files];
                      Image=Import;
                      OnAction=VAR
                                 CompareFieldsMgt@1000 : Codeunit 11102103;
                               BEGIN
                                 IF NOT CompareFieldsMgt.ImportRightSplit(LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus) THEN
                                   EXIT;

                                 RightDatabaseCode := '';
                               END;
                                }
      { 30      ;2   ;ActionGroup;
                      CaptionML=[DEU=Export;
                                 ENU=Export;
                                 ESP=Export;
                                 FRA=Export;
                                 NLD=Exporteren;
                                 DEA=Export];
                      Image=Export }
      { 31      ;3   ;Action    ;
                      CaptionML=[DEU=Export to Fields File;
                                 ENU=Export to Fields File;
                                 ESP=Export to Fields File;
                                 FRA=Export to Fields File;
                                 NLD=Rechter objecten exporteren naar bestand;
                                 DEA=Export to Fields File];
                      Image=Export;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);
                                 CompareFieldsMgt.ExportRight(FieldCompareLine);
                               END;
                                }
      { 32      ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Export to Split Fields Files;
                                 ENU=Export to Split Fields Files;
                                 ESP=Export to Split Fields Files;
                                 FRA=Export to Split Fields Files;
                                 NLD=Rechter &objecten exporteren naar map;
                                 DEA=Export to Split Fields Files];
                      Image=Export;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);

                                 CompareFieldsMgt.ExportRighSplit(FieldCompareLine);
                               END;
                                }
      { 33      ;2   ;ActionGroup;
                      CaptionML=[DEU=Mark;
                                 ENU=Mark;
                                 ESP=Mark;
                                 FRA=Mark;
                                 NLD=Markeren;
                                 DEA=Mark];
                      Image=EditFilter }
      { 34      ;3   ;Action    ;
                      CaptionML=[DEU=Mark Objects;
                                 ENU=Mark Objects;
                                 ESP=Mark Objects;
                                 FRA=Mark Objects;
                                 NLD=Objecten markeren &rechter database;
                                 DEA=Mark Objects];
                      Image=EditFilter;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);

                                 CompareFieldsMgt.MarkObjectsRight(FieldCompareLine, RightDatabaseCode);
                               END;
                                }
      { 35      ;3   ;Action    ;
                      CaptionML=[DEU=Remove Marks;
                                 ENU=Remove Marks;
                                 ESP=Remove Marks;
                                 FRA=Remove Marks;
                                 NLD=Verwijder markeringen re&chter database;
                                 DEA=Remove Marks];
                      Image=RemoveFilterLines;
                      OnAction=VAR
                                 FieldCompareLine@1000 : Record 11102067;
                                 CompareFieldsMgt@1001 : Codeunit 11102103;
                               BEGIN
                                 GetSelectedLines(FieldCompareLine);

                                 CompareFieldsMgt.RemoveMarksRight(FieldCompareLine, RightDatabaseCode);
                               END;
                                }
      { 36      ;3   ;Action    ;
                      CaptionML=[DEU=Remove all Marks;
                                 ENU=Remove all Marks;
                                 ESP=Remove all Marks;
                                 FRA=Remove all Marks;
                                 NLD=Verwijder alle markeringen rechter &database;
                                 DEA=Remove all Marks];
                      Image=ClearFilter;
                      OnAction=VAR
                                 CompareFieldsMgt@1000 : Codeunit 11102103;
                               BEGIN
                                 CompareFieldsMgt.RemoveAllMarksRight(RightDatabaseCode);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 37  ;0   ;Container ;
                ContainerType=ContentArea }

    { 38  ;1   ;Group      }

    { 39  ;2   ;Field     ;
                CaptionML=[DEU=Left is Current Database;
                           ENU=Left is Current Database;
                           ESP=Left is Current Database;
                           FRA=Left is Current Database;
                           NLD=Linker database is huidige database;
                           DEA=Left is Current Database];
                SourceExpr=LeftIsCurrentDatabase;
                OnValidate=VAR
                             CompareFieldsMgt@1000 : Codeunit 11102103;
                           BEGIN
                             IF NOT LeftIsCurrentDatabase AND (LeftDatabaseCode = '') THEN
                               CompareFieldsMgt.DeleteLeftTables(TmpHistoryStatus[1])
                             ELSE
                               RefreshLeft;
                           END;
                            }

    { 40  ;2   ;Field     ;
                CaptionML=[DEU=Left Database;
                           ENU=Left Database;
                           ESP=Left Database;
                           FRA=Left Database;
                           NLD=Linker database;
                           DEA=Left Database];
                SourceExpr=LeftDatabaseCode;
                TableRelation="OM - NAV Database";
                Enabled=LeftIsCurrentDatabase;
                OnValidate=VAR
                             CompareFieldsMgt@1000 : Codeunit 11102103;
                           BEGIN
                             IF NOT LeftIsCurrentDatabase AND (LeftDatabaseCode = '') THEN
                               CompareFieldsMgt.DeleteLeftTables(TmpHistoryStatus[1])
                             ELSE
                               RefreshLeft;

                             CurrPage.UPDATE(FALSE);
                           END;
                            }

    { 41  ;2   ;Field     ;
                CaptionML=[DEU=Right Database;
                           ENU=Right Database;
                           ESP=Right Database;
                           FRA=Right Database;
                           NLD=Rechter database;
                           DEA=Right Database];
                SourceExpr=RightDatabaseCode;
                TableRelation="OM - NAV Database";
                OnValidate=VAR
                             CompareFieldsMgt@1000 : Codeunit 11102103;
                           BEGIN
                             IF RightDatabaseCode = '' THEN
                               CompareFieldsMgt.DeleteRightTables(TmpHistoryStatus[2])
                             ELSE
                               RefreshRight;

                             CurrPage.UPDATE(FALSE);
                           END;
                            }

    { 42  ;2   ;Field     ;
                SourceExpr=LastUsedFileName;
                Visible=FALSE }

    { 43  ;1   ;Group     ;
                GroupType=Repeater }

    { 44  ;2   ;Field     ;
                SourceExpr="Table No.";
                StyleExpr=LeftRowStyle }

    { 45  ;2   ;Field     ;
                SourceExpr="Table Name";
                StyleExpr=LeftRowStyle }

    { 46  ;2   ;Field     ;
                SourceExpr="No.";
                StyleExpr=LeftRowStyle }

    { 47  ;2   ;Field     ;
                SourceExpr=Name;
                StyleExpr=LeftRowStyle }

    { 48  ;2   ;Field     ;
                SourceExpr=Type;
                Visible=FALSE;
                StyleExpr=LeftRowStyle }

    { 49  ;2   ;Field     ;
                SourceExpr="Option String";
                StyleExpr=LeftRowStyle }

    { 50  ;2   ;Field     ;
                SourceExpr=Length;
                Visible=FALSE;
                StyleExpr=LeftRowStyle }

    { 51  ;2   ;Field     ;
                SourceExpr="Type Name";
                StyleExpr=LeftRowStyle }

    { 52  ;2   ;Field     ;
                SourceExpr=Class;
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 53  ;2   ;Field     ;
                SourceExpr=Enabled;
                Visible=FALSE;
                StyleExpr=LeftRowStyle }

    { 54  ;2   ;Field     ;
                SourceExpr="SQL Data Type";
                Visible=FALSE;
                StyleExpr=LeftRowStyle }

    { 55  ;2   ;Field     ;
                SourceExpr=Different }

    { 56  ;2   ;Field     ;
                SourceExpr="New Name";
                StyleExpr=RightRowStyle }

    { 57  ;2   ;Field     ;
                SourceExpr="New Type";
                Visible=FALSE;
                StyleExpr=RightRowStyle }

    { 58  ;2   ;Field     ;
                SourceExpr="New Length";
                Visible=FALSE;
                StyleExpr=RightRowStyle }

    { 59  ;2   ;Field     ;
                SourceExpr="New Type Name";
                StyleExpr=RightRowStyle }

    { 60  ;2   ;Field     ;
                SourceExpr="New Option String";
                StyleExpr=RightRowStyle }

    { 61  ;2   ;Field     ;
                SourceExpr="New Class";
                StyleExpr=RightRowStyle }

    { 62  ;2   ;Field     ;
                SourceExpr="New Enabled";
                Visible=FALSE;
                StyleExpr=RightRowStyle }

    { 63  ;2   ;Field     ;
                SourceExpr="New SQL Data Type";
                Visible=FALSE;
                StyleExpr=RightRowStyle }

    { 64  ;1   ;Group      }

    { 65  ;2   ;Group     ;
                CaptionML=[DEU=Left;
                           ENU=Left;
                           ESP=Left;
                           FRA=Left;
                           NLD=Links;
                           DEA=Left];
                GroupType=Group }

    { 66  ;3   ;Field     ;
                Name=EnabledBottom;
                SourceExpr=Enabled;
                Editable=FALSE;
                StyleExpr=EnabledFooterStyle }

    { 67  ;3   ;Field     ;
                Name=NameBottom;
                SourceExpr=Name;
                Editable=FALSE;
                StyleExpr=NameFooterStyle }

    { 68  ;3   ;Field     ;
                Name=TypeNameBottom;
                SourceExpr="Type Name";
                Editable=FALSE;
                StyleExpr=TypeNameFooterStyle }

    { 69  ;3   ;Field     ;
                Name=ClassBottom;
                SourceExpr=Class;
                Editable=FALSE;
                StyleExpr=ClassFooterStyle }

    { 70  ;3   ;Field     ;
                Name=SQLDataTypeBottom;
                SourceExpr="SQL Data Type";
                Editable=FALSE;
                StyleExpr=SQLDataTypeFooterStyle }

    { 71  ;3   ;Field     ;
                Name=OptionStringBottom;
                SourceExpr="Option String";
                Editable=FALSE;
                StyleExpr=OptionStringFooterStyle }

    { 72  ;2   ;Group     ;
                CaptionML=[DEU=Right;
                           ENU=Right;
                           ESP=Right;
                           FRA=Right;
                           NLD=Rechts;
                           DEA=Right];
                GroupType=Group }

    { 73  ;3   ;Field     ;
                Name=NewEnabledBottom;
                CaptionML=[DEU=Enabled;
                           ENU=Enabled;
                           ESP=Enabled;
                           FRA=Enabled;
                           NLD=Ingeschakeld;
                           DEA=Enabled];
                SourceExpr="New Enabled";
                Editable=FALSE;
                StyleExpr=EnabledFooterStyle }

    { 74  ;3   ;Field     ;
                Name=NewNameBottom;
                CaptionML=[DEU=Name;
                           ENU=Name;
                           ESP=Name;
                           FRA=Name;
                           NLD=Naam;
                           DEA=Name];
                SourceExpr="New Name";
                Editable=FALSE;
                StyleExpr=NameFooterStyle }

    { 75  ;3   ;Field     ;
                Name=NewTypeNameBottom;
                CaptionML=[DEU=Type Name;
                           ENU=Type Name;
                           ESP=Type Name;
                           FRA=Type Name;
                           NLD=Soortnaam;
                           DEA=Type Name];
                SourceExpr="New Type Name";
                Editable=FALSE;
                StyleExpr=TypeNameFooterStyle }

    { 76  ;3   ;Field     ;
                Name=NewClassBottom;
                CaptionML=[DEU=Class;
                           ENU=Class;
                           ESP=Class;
                           FRA=Class;
                           NLD=Class;
                           DEA=Class];
                SourceExpr="New Class";
                Editable=FALSE;
                StyleExpr=ClassFooterStyle }

    { 77  ;3   ;Field     ;
                Name=NewSQLDataTypeBottom;
                CaptionML=[DEU=SQL Data Type;
                           ENU=SQL Data Type;
                           ESP=SQL Data Type;
                           FRA=SQL Data Type;
                           NLD=SQL Data Type;
                           DEA=SQL Data Type];
                SourceExpr="New SQL Data Type";
                Editable=FALSE;
                StyleExpr=SQLDataTypeFooterStyle }

    { 78  ;3   ;Field     ;
                Name=NewOptionStringBottom;
                CaptionML=[DEU=Option String;
                           ENU=Option String;
                           ESP=Option String;
                           FRA=Option String;
                           NLD=Optiestring;
                           DEA=Option String];
                SourceExpr="New Option String";
                Editable=FALSE;
                StyleExpr=OptionStringFooterStyle }

    { 79  ;1   ;Field     ;
                SourceExpr=Initialized;
                Visible=FALSE }

  }
  CODE
  {
    VAR
      TmpHistoryStatus@1000 : ARRAY [2] OF TEMPORARY Record 2000000001;
      ClassFooterStyle@1001 : Text INDATASET;
      EnabledFooterStyle@1002 : Text INDATASET;
      LastUsedFileName@1003 : Text;
      LeftRowStyle@1004 : Text INDATASET;
      NameFooterStyle@1005 : Text INDATASET;
      OpeningClientDirectoryName@1006 : Text;
      OpeningClientFileName@1007 : Text;
      OptionStringFooterStyle@1008 : Text INDATASET;
      RightRowStyle@1009 : Text INDATASET;
      SQLDataTypeFooterStyle@1010 : Text INDATASET;
      TypeNameFooterStyle@1011 : Text INDATASET;
      LeftDatabaseCode@1012 : Code[20];
      RightDatabaseCode@1013 : Code[20];
      Initialized@1014 : Boolean;
      LeftIsCurrentDatabase@1015 : Boolean INDATASET;

    LOCAL PROCEDURE Refresh@1();
    VAR
      TmpObject@1000 : TEMPORARY Record 2000000001;
      CompareFieldsMgt@1001 : Codeunit 11102103;
    BEGIN
      GetAddedObjects(TmpObject);
      CompareFieldsMgt.Refresh(TmpObject, LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus);
    END;

    LOCAL PROCEDURE RefreshLeft@2();
    VAR
      TmpObject@1000 : TEMPORARY Record 2000000001;
      CompareFieldsMgt@1001 : Codeunit 11102103;
    BEGIN
      GetAddedObjects(TmpObject);
      CompareFieldsMgt.RefreshLeft(TmpObject, LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus);
    END;

    LOCAL PROCEDURE RefreshRight@3();
    VAR
      TmpObject@1000 : TEMPORARY Record 2000000001;
      CompareFieldsMgt@1001 : Codeunit 11102103;
    BEGIN
      GetAddedObjects(TmpObject);
      CompareFieldsMgt.RefreshRight(TmpObject, LeftIsCurrentDatabase, LeftDatabaseCode, RightDatabaseCode, TmpHistoryStatus);
    END;

    LOCAL PROCEDURE GetAddedObjects@4(VAR TmpObject@1000 : TEMPORARY Record 2000000001);
    VAR
      FieldCompareLine@1001 : Record 11102067;
    BEGIN
      FieldCompareLine.FILTERGROUP(10);
      IF FieldCompareLine.FINDFIRST THEN
        REPEAT
          IF NOT TmpObject.GET(TmpObject.Type::Table, '', FieldCompareLine."Table No.") THEN BEGIN
            TmpObject.Type := TmpObject.Type::Table;
            TmpObject.ID := FieldCompareLine."Table No.";
            TmpObject.Name := COPYSTR(FieldCompareLine."Table Name", 1, MAXSTRLEN(TmpObject.Name));
            TmpObject.INSERT;
          END;
          FieldCompareLine.SETFILTER("Table No.", '>%1', FieldCompareLine."Table No.");
        UNTIL FieldCompareLine.NEXT = 0;

      FieldCompareLine.SETRANGE("Table No.");
      FieldCompareLine.FILTERGROUP(0);
    END;

    LOCAL PROCEDURE GetSelectedLines@5(VAR FieldCompareLine@1000 : Record 11102067);
    BEGIN
      CurrPage.SETSELECTIONFILTER(FieldCompareLine);
      IF FieldCompareLine.COUNT = 1 THEN BEGIN
        FieldCompareLine.RESET;
        FieldCompareLine.COPYFILTERS(Rec);
      END;
    END;

    PROCEDURE SetOpeningClientFileName@6(NewValue@1000 : Text[1024]);
    BEGIN
      OpeningClientFileName := NewValue;
    END;

    PROCEDURE SetOpeningClientDirectoryName@7(NewValue@1000 : Text[1024]);
    BEGIN
      OpeningClientDirectoryName := NewValue;
    END;

    LOCAL PROCEDURE GetRowStyle@8(VAR HistoryStatus@1000 : TEMPORARY Record 2000000001;TableNo@1001 : Integer) : Text;
    VAR
      Updated@1002 : 'Updated,Outdated,Error';
    BEGIN
      IF NOT HistoryStatus.GET(HistoryStatus.Type::Table, '', TableNo) THEN
        EXIT;

      CASE HistoryStatus."DBM Table No." OF
        Updated::Error :
          EXIT('Unfavorable');

        Updated::Outdated :
          EXIT('Attention');
      END;
    END;

    LOCAL PROCEDURE SetFooterStyle@9();
    BEGIN
      IF (Name <> '') AND ("New Name" <> '') THEN BEGIN
        EnabledFooterStyle := DifferentStyle(Enabled <> "New Enabled");
        NameFooterStyle := DifferentStyle(Name <> "New Name");
        TypeNameFooterStyle := DifferentStyle("Type Name" <> "New Type Name");
        ClassFooterStyle := DifferentStyle(Class <> "New Class");
        SQLDataTypeFooterStyle := DifferentStyle("SQL Data Type" <> "New SQL Data Type");
        OptionStringFooterStyle := DifferentStyle("Option String" <> "New Option String");
      END ELSE BEGIN
        EnabledFooterStyle := DifferentStyle(FALSE);
        NameFooterStyle := DifferentStyle(FALSE);
        TypeNameFooterStyle := DifferentStyle(FALSE);
        ClassFooterStyle := DifferentStyle(FALSE);
        SQLDataTypeFooterStyle := DifferentStyle(FALSE);
        OptionStringFooterStyle := DifferentStyle(FALSE);
      END;
    END;

    LOCAL PROCEDURE DifferentStyle@10(IsDifferent@1000 : Boolean) : Text;
    BEGIN
      IF IsDifferent THEN
        EXIT('Unfavorable');
    END;

    BEGIN
    END.
  }
}

