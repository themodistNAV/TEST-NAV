OBJECT Page 11102115 OM - Compare Databases
{
  OBJECT-PROPERTIES
  {
    Date=19/11/15;
    Time=12:00:00 PM;
    Version List=OMA10.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Compare Databases;
               ENU=Compare Databases;
               ESP=Compare Databases;
               FRA=Compare Databases;
               NLD=Databases vergelijken;
               DEA=Compare Databases];
    SaveValues=Yes;
    InsertAllowed=No;
    SourceTable=Table11102079;
    SourceTableView=SORTING(Line Type,Type,No.)
                    WHERE(Line Type=CONST(Database Compare Sheet));
    PageType=Worksheet;
    PromotedActionCategoriesML=[ENU=0,1,2,Object,Process,Push,Merge;
                                NLD=0,1,2,Object,Verwerken,Push,Merge];
    OnOpenPage=VAR
                 ObjectImportLine@1000 : Record 11102079;
               BEGIN
                 IF NOT Initialized THEN BEGIN
                   Initialized := TRUE;
                   LeftIsCurrentDatabase := TRUE;
                 END;

                 ObjectImportLine.SETRANGE("Line Type", ObjectImportLine."Line Type"::"Database Compare Sheet");
                 IF ObjectImportLine.FINDFIRST THEN BEGIN

                   IF ObjectImportLine."Database Code" = '' THEN
                     LeftIsCurrentDatabase := TRUE
                   ELSE
                     LeftDatabaseCode := ObjectImportLine."Database Code";
                   RightDatabaseCode := ObjectImportLine."New Database Code";

                 END;

                 SetDatabaseFilters;

                 ReadActiveProjects;
               END;

    OnAfterGetRecord=VAR
                       KnownObjectExportError@1000 : Record 11102073;
                       Object@1001 : Record 2000000001;
                       SourceControl@1002 : Codeunit 11102050;
                     BEGIN
                       IF LeftIsCurrentDatabase THEN BEGIN
                         LeftRowStyle := '';
                         IF Object.GET(Type, '', "No.") THEN
                           IF SourceControl.ObjectHeaderIsOutdated(Object, FALSE) THEN BEGIN
                             LeftRowStyle := 'Attention';
                             IF KnownObjectExportError.GET(Type, "No.") THEN
                               LeftRowStyle := 'Unfavorable';
                           END;
                       END ELSE
                         LeftRowStyle := GetRowStyle(Updated);

                       IF UseCommandLine THEN
                         RightRowStyle := GetRowStyle(0)
                       ELSE
                         RightRowStyle := GetRowStyle("New Updated");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetFooterStyle;
                         END;

    ActionList=ACTIONS
    {
      { 1       ;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 2       ;1   ;Action    ;
                      CaptionML=[DEU=&Refresh;
                                 ENU=&Refresh;
                                 ESP=&Refresh;
                                 FRA=&Refresh;
                                 NLD=Ver&nieuwen;
                                 DEA=&Refresh];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Refresh;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 Refresh;
                               END;
                                }
      { 3       ;1   ;Action    ;
                      CaptionML=[DEU=Get Objects;
                                 ENU=Get Objects;
                                 ESP=Get Objects;
                                 FRA=Get Objects;
                                 NLD=Objecten ophalen;
                                 DEA=Get Objects];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 TmpObject@1001 : TEMPORARY Record 2000000001;
                                 PushObjects@1002 : Codeunit 11102098;
                                 ctConfirm@1003 : TextConst 'DEU=Object will be copied from right to left.\Are you sure?;ENU=Object will be copied from right to left.\Are you sure?;ESP=Object will be copied from right to left.\Are you sure?;FRA=Object will be copied from right to left.\Are you sure?;NLD=Objecten zullen van de rechts naar links worden gekopieerd worden.\Weet u het zeker?;DEA=Object will be copied from right to left.\Are you sure?';
                               BEGIN
                                 IF NOT CONFIRM(ctConfirm, TRUE) THEN
                                   EXIT;

                                 GetSelectedObjects(TmpObject, FALSE);

                                 PushObjects.SetFromDatabaseCode(RightDatabaseCode);
                                 IF NOT LeftIsCurrentDatabase THEN
                                   PushObjects.SetToDatabaseCode(LeftDatabaseCode);

                                 PushObjects.RUN(TmpObject);

                                 ObjectImportLine.SETRANGE("Line Type", ObjectImportLine."Line Type"::"Database Compare Sheet");
                                 RefreshSelection(ObjectImportLine);
                               END;
                                }
      { 4       ;1   ;Action    ;
                      CaptionML=[DEU=Push Objects;
                                 ENU=Push Objects;
                                 ESP=Push Objects;
                                 FRA=Push Objects;
                                 NLD=Objecten pushen;
                                 DEA=Push Objects];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 TmpObject@1001 : TEMPORARY Record 2000000001;
                                 PushObjects@1002 : Codeunit 11102098;
                                 ctConfirm@1003 : TextConst 'DEU=Object will be copied from left to right.\Are you sure?;ENU=Object will be copied from left to right.\Are you sure?;ESP=Object will be copied from left to right.\Are you sure?;FRA=Object will be copied from left to right.\Are you sure?;NLD=Objecten zullen van de links naar rechts worden gekopieerd worden.\Weet u het zeker?;DEA=Object will be copied from left to right.\Are you sure?';
                               BEGIN
                                 IF NOT CONFIRM(ctConfirm, TRUE) THEN
                                   EXIT;

                                 GetSelectedObjects(TmpObject, TRUE);

                                 IF NOT LeftIsCurrentDatabase THEN
                                   PushObjects.SetFromDatabaseCode(LeftDatabaseCode);
                                 PushObjects.SetToDatabaseCode(RightDatabaseCode);

                                 PushObjects.RUN(TmpObject);

                                 ObjectImportLine.SETRANGE("Line Type", ObjectImportLine."Line Type"::"Database Compare Sheet");
                                 RefreshSelection(ObjectImportLine);
                               END;
                                }
      { 74      ;1   ;ActionGroup;
                      CaptionML=[DEU=Merge;
                                 ENU=Merge;
                                 ESP=Merge;
                                 FRA=Merge;
                                 NLD=Mergen;
                                 DEA=Merge];
                      Image=StepInto }
      { 75      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Merge into Left;
                                 ENU=Merge into Left;
                                 ESP=Merge into Left;
                                 FRA=Merge into Left;
                                 NLD=Mergen naar links;
                                 DEA=Merge into Left];
                      Promoted=Yes;
                      Enabled=UseCommandLine;
                      PromotedIsBig=Yes;
                      Image=StepInto;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 MergeInto(FALSE);
                               END;
                                }
      { 73      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Merge into Right;
                                 ENU=Merge into Right;
                                 ESP=Merge into Right;
                                 FRA=Merge into Right;
                                 NLD=Mergen naar rechts;
                                 DEA=Merge into Right];
                      Promoted=Yes;
                      Enabled=UseCommandLine;
                      Image=StepInto;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 MergeInto(TRUE);
                               END;
                                }
      { 69      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Object;
                                 ENU=&Object;
                                 ESP=&Object;
                                 FRA=&Object;
                                 NLD=&Object;
                                 DEA=&Object] }
      { 68      ;2   ;Action    ;
                      ShortCutKey=Ctrl+D;
                      CaptionML=[DEU=&Code;
                                 ENU=&Code;
                                 ESP=&Code;
                                 FRA=&Code;
                                 NLD=&Code;
                                 DEA=&Code];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=DesignCodeBehind;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 EditorMgt@1000 : Codeunit 11102106;
                               BEGIN
                                 EditorMgt.OpenEditorWithLifeObject(Type, "No.");
                               END;
                                }
      { 67      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F2;
                      CaptionML=[DEU=Design;
                                 ENU=Design;
                                 ESP=Design;
                                 FRA=Design;
                                 NLD=Design;
                                 DEA=Design];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Design;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Object@1000 : Record 2000000001;
                                 ObjectMgt@1001 : Codeunit 11102046;
                               BEGIN
                                 Object.GET(Type, '', "No.");
                                 ObjectMgt.DesignObject(Object);
                               END;
                                }
      { 66      ;2   ;Action    ;
                      ShortCutKey=Ctrl+R;
                      CaptionML=[DEU=Run;
                                 ENU=Run;
                                 ESP=Run;
                                 FRA=Run;
                                 NLD=Run;
                                 DEA=Run];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Object@1000 : Record 2000000001;
                                 ObjectMgt@1001 : Codeunit 11102046;
                               BEGIN
                                 Object.GET(Type, '', "No.");
                                 ObjectMgt.RunObject(Object);
                               END;
                                }
      { 70      ;2   ;Action    ;
                      CaptionML=[DEU=Navigate;
                                 ENU=Navigate;
                                 ESP=Navigate;
                                 FRA=Navigate;
                                 NLD=Navigeren;
                                 DEA=Navigate];
                      Image=Navigate;
                      OnAction=VAR
                                 Object@1000 : Record 2000000001;
                                 ObjectMgt@1001 : Codeunit 11102046;
                               BEGIN
                                 Object.GET(Type, '', "No.");
                                 ObjectMgt.Navigate(Object);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[DEU=F&unctions;
                                 ENU=F&unctions;
                                 ESP=F&unctions;
                                 FRA=F&unctions;
                                 NLD=F&uncties;
                                 DEA=F&unctions] }
      { 6       ;2   ;Action    ;
                      CaptionML=[DEU=Show Changes in &Directory;
                                 ENU=Show Changes in &Directory;
                                 ESP=Show Changes in &Directory;
                                 FRA=Show Changes in &Directory;
                                 NLD=Toon wijzigingen in &map;
                                 DEA=Show Changes in &Directory];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewPage;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 Object@1001 : Record 2000000001;
                                 TmpObject@1002 : TEMPORARY Record 2000000001;
                                 Progressbar@1003 : Codeunit 11102044;
                                 SourceControl@1004 : Codeunit 11102050;
                                 CheckCALHistory@1005 : Codeunit 11102063;
                                 FileHandler@1006 : Codeunit 11102097;
                                 FileNameMgt@1007 : Codeunit 11102107;
                                 oFile@1008 : File;
                                 ClientDirectory@1009 : Text;
                                 FileName@1010 : Text;
                                 LeftServerDirectory@1011 : Text;
                                 RightServerDirectory@1012 : Text;
                                 ServerDirectory@1013 : Text;
                                 ctExportingObjects@1014 : TextConst 'DEU=Exporting objects...;ENU=Exporting objects...;ESP=Exporting objects...;FRA=Exporting objects...;NLD=Objecten exporteren...;DEA=Exporting objects...';
                               BEGIN
                                 ServerDirectory := FileHandler.CreateServerDirectory;

                                 LeftServerDirectory := ServerDirectory + 'left-database\';
                                 RightServerDirectory := ServerDirectory + 'right-database\';

                                 FileHandler.CheckCreateServerDirectory(LeftServerDirectory);
                                 FileHandler.CheckCreateServerDirectory(RightServerDirectory);

                                 CurrPage.SETSELECTIONFILTER(ObjectImportLine);

                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT
                                     IF Object.GET(ObjectImportLine.Type, '', ObjectImportLine."No.") THEN
                                       IF NOT TmpObject.GET(ObjectImportLine.Type, '', ObjectImportLine."No.") THEN BEGIN
                                         TmpObject := Object;
                                         TmpObject.INSERT;
                                       END;
                                   UNTIL ObjectImportLine.NEXT = 0;

                                 CheckCALHistory.RunWithObjectRange(TmpObject);

                                 Progressbar.Open(ctExportingObjects, 0);
                                 Progressbar.BarSize := ObjectImportLine.COUNT;

                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT

                                     Progressbar.AddToBar(1);

                                     FileName := FileNameMgt.FileName(ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine.Name);

                                     IF ObjectImportLine.Name <> '' THEN BEGIN
                                       oFile.TEXTMODE(TRUE);
                                       oFile.WRITEMODE(TRUE);
                                       oFile.CREATE(LeftServerDirectory + FileName);
                                       WriteObjectToFile(oFile, ObjectImportLine, ObjectImportLine."Database Code");
                                       oFile.CLOSE;

                                       SourceControl.SetStampToFile(LeftServerDirectory + FileName, ObjectImportLine."Object Date", ObjectImportLine."Object Time");
                                     END;

                                     IF ObjectImportLine."New Name" <> '' THEN BEGIN
                                       oFile.TEXTMODE(TRUE);
                                       oFile.WRITEMODE(TRUE);
                                       oFile.CREATE(RightServerDirectory + FileName);
                                       WriteObjectToFile(oFile, ObjectImportLine, ObjectImportLine."New Database Code");
                                       oFile.CLOSE;

                                       SourceControl.SetStampToFile(RightServerDirectory + FileName, ObjectImportLine."New Date", ObjectImportLine."New Time");
                                     END;

                                   UNTIL ObjectImportLine.NEXT = 0;

                                 Progressbar.Close;

                                 ClientDirectory := FileHandler.DownloadDirectoryToClient(ServerDirectory, '');

                                 SourceControl.StartCompareToolDirectory(ClientDirectory + 'left-database\', ClientDirectory + 'right-database\');
                               END;
                                }
      { 7       ;2   ;Action    ;
                      CaptionML=[DEU=Show Changes &in One File;
                                 ENU=Show Changes &in One File;
                                 ESP=Show Changes &in One File;
                                 FRA=Show Changes &in One File;
                                 NLD=Toon wijzigingen &in ‚‚n bestand;
                                 DEA=Show Changes &in One File];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewDocumentLine;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 Object@1001 : Record 2000000001;
                                 TmpObject@1002 : TEMPORARY Record 2000000001;
                                 Progressbar@1003 : Codeunit 11102044;
                                 SourceControl@1004 : Codeunit 11102050;
                                 CheckCALHistory@1005 : Codeunit 11102063;
                                 FileHandler@1006 : Codeunit 11102097;
                                 oLeftFile@1007 : File;
                                 oRightFile@1008 : File;
                                 ClientLeftFileName@1009 : Text;
                                 ClientRightFileName@1010 : Text;
                                 Directory@1011 : Text;
                                 LeftFileName@1012 : Text;
                                 RightFileName@1013 : Text;
                                 ctExportingObjects@1014 : TextConst 'DEU=Exporting objects...;ENU=Exporting objects...;ESP=Exporting objects...;FRA=Exporting objects...;NLD=Objecten exporteren...;DEA=Exporting objects...';
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(ObjectImportLine);

                                 Directory := FileHandler.TempDirectory;

                                 LeftFileName := Directory + 'left.txt';
                                 RightFileName := Directory + 'right.txt';

                                 FileHandler.DeleteServerFile(LeftFileName);
                                 FileHandler.DeleteServerFile(RightFileName);

                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT
                                     IF Object.GET(ObjectImportLine.Type, '', ObjectImportLine."No.") THEN
                                       IF NOT TmpObject.GET(ObjectImportLine.Type, '', ObjectImportLine."No.") THEN BEGIN
                                         TmpObject := Object;
                                         TmpObject.INSERT;
                                       END;
                                   UNTIL ObjectImportLine.NEXT = 0;

                                 CheckCALHistory.RunWithObjectRange(TmpObject);

                                 oLeftFile.TEXTMODE(TRUE);
                                 oLeftFile.WRITEMODE(TRUE);
                                 oLeftFile.CREATE(LeftFileName);

                                 oRightFile.TEXTMODE(TRUE);
                                 oRightFile.WRITEMODE(TRUE);
                                 oRightFile.CREATE(RightFileName);

                                 Progressbar.Open(ctExportingObjects, 0);
                                 Progressbar.BarSize := ObjectImportLine.COUNT;

                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT
                                     Progressbar.AddToBar(1);

                                     IF ObjectImportLine.Name <> '' THEN
                                       WriteObjectToFile(oLeftFile, ObjectImportLine, ObjectImportLine."Database Code");

                                     IF ObjectImportLine."New Name" <> '' THEN
                                       WriteObjectToFile(oRightFile, ObjectImportLine, ObjectImportLine."New Database Code");

                                   UNTIL ObjectImportLine.NEXT = 0;

                                 Progressbar.Close;

                                 oLeftFile.CLOSE;
                                 oRightFile.CLOSE;

                                 ClientLeftFileName := FileHandler.DownloadToClient(LeftFileName, '', '');
                                 ClientRightFileName := FileHandler.DownloadToClient(RightFileName, '', '');

                                 SourceControl.StartCompareToolFile(ClientLeftFileName, ClientRightFileName);
                               END;
                                }
      { 8       ;1   ;ActionGroup;
                      CaptionML=[DEU=Left Database;
                                 ENU=Left Database;
                                 ESP=Left Database;
                                 FRA=Left Database;
                                 NLD=Linker database;
                                 DEA=Left Database] }
      { 9       ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Open;
                                 ENU=Open;
                                 ESP=Open;
                                 FRA=Open;
                                 NLD=Links;
                                 DEA=Open];
                      Image=Import;
                      OnAction=BEGIN
                                 OpenFile(TRUE);
                               END;
                                }
      { 10      ;2   ;ActionGroup;
                      CaptionML=[DEU=Export;
                                 ENU=Export;
                                 ESP=Export;
                                 FRA=Export;
                                 NLD=Exporteren;
                                 DEA=Export];
                      Image=Export }
      { 11      ;3   ;Action    ;
                      CaptionML=[DEU=Export to Text File;
                                 ENU=Export to Text File;
                                 ESP=Export to Text File;
                                 FRA=Export to Text File;
                                 NLD=Linker objecten exporteren naar bestand;
                                 DEA=Export to Text File];
                      Image=Export;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 Progressbar@1001 : Codeunit 11102044;
                                 CommonDialog@1002 : Codeunit 11102059;
                                 FileHandler@1003 : Codeunit 11102097;
                                 oFile@1004 : File;
                                 ServerFileName@1005 : Text;
                                 ctDefaultFileName@1006 : TextConst 'DEU=objects.txt;ENU=objects.txt;ESP=objects.txt;FRA=objects.txt;NLD=objects.txt;DEA=objects.txt';
                                 ctExportingObjects@1007 : TextConst 'DEU=Exporting objects...;ENU=Exporting objects...;ESP=Exporting objects...;FRA=Exporting objects...;NLD=Objecten exporteren...;DEA=Exporting objects...';
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(ObjectImportLine);

                                 CommonDialog.AddKnownExtension('txt-o');
                                 IF NOT CommonDialog.SaveFile(ExportFileName, ServerFileName, ctDefaultFileName) THEN
                                   EXIT;

                                 Progressbar.Open(ctExportingObjects, 0);
                                 Progressbar.BarSize := ObjectImportLine.COUNT;

                                 oFile.TEXTMODE(TRUE);
                                 oFile.WRITEMODE(TRUE);
                                 oFile.CREATE(ServerFileName);
                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT

                                     Progressbar.AddToBar(1);

                                     IF ObjectImportLine.Name <> '' THEN
                                       WriteObjectToFile(oFile, ObjectImportLine, ObjectImportLine."Database Code");

                                   UNTIL ObjectImportLine.NEXT = 0;
                                 oFile.CLOSE;

                                 Progressbar.Close;

                                 FileHandler.DownloadToClient(ServerFileName, ExportFileName, ctDefaultFileName);
                               END;
                                }
      { 12      ;3   ;Action    ;
                      CaptionML=[DEU=Export to &Split Text Files;
                                 ENU=Export to &Split Text Files;
                                 ESP=Export to &Split Text Files;
                                 FRA=Export to &Split Text Files;
                                 NLD=Linker objecten exporteren naar &map;
                                 DEA=Export to &Split Text Files];
                      Image=Export;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 Progressbar@1001 : Codeunit 11102044;
                                 SourceControl@1002 : Codeunit 11102050;
                                 CommonDialog@1003 : Codeunit 11102059;
                                 FileNameMgt@1004 : Codeunit 11102107;
                                 oFile@1005 : File;
                                 FileName@1006 : Text;
                                 PathToExport@1007 : Text;
                                 ctExportingObjects@1008 : TextConst 'DEU=Exporting objects...;ENU=Exporting objects...;ESP=Exporting objects...;FRA=Exporting objects...;NLD=Objecten exporteren...;DEA=Exporting objects...';
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(ObjectImportLine);

                                 CommonDialog.SelectDirectory(PathToExport);
                                 IF PathToExport <> '' THEN BEGIN

                                   Progressbar.Open(ctExportingObjects, 0);
                                   Progressbar.BarSize := ObjectImportLine.COUNT;

                                   IF ObjectImportLine.FINDSET THEN
                                     REPEAT

                                       Progressbar.AddToBar(1);

                                       FileName := FileNameMgt.FileName(ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine.Name);

                                       oFile.TEXTMODE(TRUE);
                                       oFile.WRITEMODE(TRUE);
                                       oFile.CREATE(PathToExport + FileName);

                                       IF ObjectImportLine.Name <> '' THEN
                                         WriteObjectToFile(oFile, ObjectImportLine, ObjectImportLine."Database Code");

                                       oFile.CLOSE;

                                       SourceControl.SetStampToFile(PathToExport + FileName, ObjectImportLine."Object Date", ObjectImportLine."Object Time");

                                     UNTIL ObjectImportLine.NEXT = 0;

                                   Progressbar.Close;

                                 END;
                               END;
                                }
      { 13      ;2   ;ActionGroup;
                      CaptionML=[DEU=Mark;
                                 ENU=Mark;
                                 ESP=Mark;
                                 FRA=Mark;
                                 NLD=Objecten markeren;
                                 DEA=Mark];
                      Image=EditFilter }
      { 14      ;3   ;Action    ;
                      ShortCutKey=Ctrl+M;
                      CaptionML=[DEU=Mark Objects;
                                 ENU=Mark Objects;
                                 ESP=Mark Objects;
                                 FRA=Mark Objects;
                                 NLD=Objecten markeren &linker database;
                                 DEA=Mark Objects];
                      Image=EditFilter;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 NAVDatabase@1001 : Record 11102099;
                                 Object@1002 : Record 2000000001;
                                 VersionControl@1003 : Codeunit 11102040;
                                 DatabaseMgt@1004 : Codeunit 11102083;
                               BEGIN
                                 IF LeftIsCurrentDatabase THEN BEGIN

                                   VersionControl.CheckMarkLock;

                                   CurrPage.SETSELECTIONFILTER(ObjectImportLine);
                                   IF ObjectImportLine.FINDSET THEN
                                     REPEAT
                                       IF Object.GET(ObjectImportLine.Type, '', ObjectImportLine."No.") THEN BEGIN
                                         VersionControl.MarkObject(Object, TRUE);
                                         ObjectImportLine."Version List" := Object."Version List";
                                         ObjectImportLine.MODIFY;
                                       END;
                                     UNTIL ObjectImportLine.NEXT = 0;
                                 END ELSE BEGIN

                                   NAVDatabase.GET(LeftDatabaseCode);

                                   CurrPage.SETSELECTIONFILTER(ObjectImportLine);
                                   IF ObjectImportLine.FINDSET THEN
                                     REPEAT
                                       DatabaseMgt.MarkObject(NAVDatabase, ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine."Version List");
                                       ObjectImportLine.MODIFY;
                                     UNTIL ObjectImportLine.NEXT = 0;

                                 END;
                               END;
                                }
      { 15      ;3   ;Action    ;
                      CaptionML=[DEU=Remove Marks;
                                 ENU=Remove Marks;
                                 ESP=Remove Marks;
                                 FRA=Remove Marks;
                                 NLD=Verwijder markeringen linker database;
                                 DEA=Remove Marks];
                      Image=RemoveFilterLines;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 NAVDatabase@1001 : Record 11102099;
                                 Object@1002 : Record 2000000001;
                                 VersionControl@1003 : Codeunit 11102040;
                                 DatabaseMgt@1004 : Codeunit 11102083;
                               BEGIN
                                 IF LeftIsCurrentDatabase THEN BEGIN
                                   CurrPage.SETSELECTIONFILTER(ObjectImportLine);
                                   IF ObjectImportLine.FINDSET THEN
                                     REPEAT
                                       IF Object.GET(ObjectImportLine.Type, '', ObjectImportLine."No.") THEN BEGIN
                                         VersionControl.RemoveObjectMark(Object);

                                         IF ObjectImportLine."Version List" <> Object."Version List" THEN BEGIN
                                           ObjectImportLine."Version List" := Object."Version List";
                                           ObjectImportLine.MODIFY;
                                         END;
                                       END;
                                     UNTIL ObjectImportLine.NEXT = 0;

                                   VersionControl.RemoveMarkLock(TRUE);
                                 END ELSE BEGIN

                                   NAVDatabase.GET(LeftDatabaseCode);

                                   CurrPage.SETSELECTIONFILTER(ObjectImportLine);
                                   IF ObjectImportLine.FINDSET THEN
                                     REPEAT
                                       DatabaseMgt.RemoveMarkObject(NAVDatabase, ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine."Version List");
                                       ObjectImportLine.MODIFY;
                                     UNTIL ObjectImportLine.NEXT = 0;

                                 END;
                               END;
                                }
      { 16      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+M;
                      CaptionML=[DEU=Remove &all Marks;
                                 ENU=Remove &all Marks;
                                 ESP=Remove &all Marks;
                                 FRA=Remove &all Marks;
                                 NLD=Verwijder &alle markeringen linker database;
                                 DEA=Remove &all Marks];
                      Image=ClearFilter;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 NAVDatabase@1001 : Record 11102099;
                                 VersionControl@1002 : Codeunit 11102040;
                                 DatabaseMgt@1003 : Codeunit 11102083;
                               BEGIN
                                 IF LeftIsCurrentDatabase THEN
                                   VersionControl.RemoveObjectMarks(FALSE)
                                 ELSE BEGIN

                                   NAVDatabase.GET(LeftDatabaseCode);

                                   ObjectImportLine.SETRANGE("Line Type", ObjectImportLine."Line Type"::"Database Compare Sheet");
                                   ObjectImportLine.SETFILTER("Version List", '#*');
                                   IF ObjectImportLine.FINDSET THEN
                                     REPEAT
                                       DatabaseMgt.RemoveMarkObject(NAVDatabase, ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine."Version List");
                                       ObjectImportLine.MODIFY;
                                     UNTIL ObjectImportLine.NEXT = 0;

                                 END;
                               END;
                                }
      { 17      ;1   ;ActionGroup;
                      CaptionML=[DEU=Right Database;
                                 ENU=Right Database;
                                 ESP=Right Database;
                                 FRA=Right Database;
                                 NLD=Rechter database;
                                 DEA=Right Database] }
      { 18      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Open;
                                 ENU=Open;
                                 ESP=Open;
                                 FRA=Open;
                                 NLD=Rechts;
                                 DEA=Open];
                      Image=Import;
                      OnAction=BEGIN
                                 OpenFile(FALSE);
                               END;
                                }
      { 19      ;2   ;ActionGroup;
                      CaptionML=[DEU=Export;
                                 ENU=Export;
                                 ESP=Export;
                                 FRA=Export;
                                 NLD=Exporteren;
                                 DEA=Export];
                      Image=Export }
      { 20      ;3   ;Action    ;
                      CaptionML=[DEU=Export to Text File;
                                 ENU=Export to Text File;
                                 ESP=Export to Text File;
                                 FRA=Export to Text File;
                                 NLD=Rechter objecten exporteren naar bestand;
                                 DEA=Export to Text File];
                      Image=Export;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 Progressbar@1001 : Codeunit 11102044;
                                 CommonDialog@1002 : Codeunit 11102059;
                                 FileHandler@1003 : Codeunit 11102097;
                                 oFile@1004 : File;
                                 ServerFileName@1005 : Text;
                                 ctDefaultFileName@1006 : TextConst 'DEU=objects.txt;ENU=objects.txt;ESP=objects.txt;FRA=objects.txt;NLD=objects.txt;DEA=objects.txt';
                                 ctExportingObjects@1007 : TextConst 'DEU=Exporting objects...;ENU=Exporting objects...;ESP=Exporting objects...;FRA=Exporting objects...;NLD=Objecten exporteren...;DEA=Exporting objects...';
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(ObjectImportLine);

                                 CommonDialog.AddKnownExtension('txt-o');
                                 IF NOT CommonDialog.SaveFile(ExportFileName, ServerFileName, ctDefaultFileName) THEN
                                   EXIT;

                                 Progressbar.Open(ctExportingObjects, 0);
                                 Progressbar.BarSize := ObjectImportLine.COUNT;

                                 oFile.TEXTMODE(TRUE);
                                 oFile.WRITEMODE(TRUE);
                                 oFile.CREATE(ServerFileName);
                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT

                                     Progressbar.AddToBar(1);

                                     IF ObjectImportLine.Name <> '' THEN
                                       WriteObjectToFile(oFile, ObjectImportLine, ObjectImportLine."New Database Code");
                                   UNTIL ObjectImportLine.NEXT = 0;
                                 oFile.CLOSE;

                                 Progressbar.Close;

                                 FileHandler.DownloadToClient(ServerFileName, ExportFileName, ctDefaultFileName);
                               END;
                                }
      { 21      ;3   ;Action    ;
                      CaptionML=[DEU=Export to Split Text Files;
                                 ENU=Export to Split Text Files;
                                 ESP=Export to Split Text Files;
                                 FRA=Export to Split Text Files;
                                 NLD=Rechter &objecten exporteren naar map;
                                 DEA=Export to Split Text Files];
                      Image=Export;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 Progressbar@1001 : Codeunit 11102044;
                                 SourceControl@1002 : Codeunit 11102050;
                                 CommonDialog@1003 : Codeunit 11102059;
                                 FileNameMgt@1004 : Codeunit 11102107;
                                 oFile@1005 : File;
                                 FileName@1006 : Text;
                                 PathToExport@1007 : Text;
                                 ctExportingObjects@1008 : TextConst 'DEU=Exporting objects...;ENU=Exporting objects...;ESP=Exporting objects...;FRA=Exporting objects...;NLD=Objecten exporteren...;DEA=Exporting objects...';
                               BEGIN
                                 CommonDialog.SelectDirectory(PathToExport);

                                 CurrPage.SETSELECTIONFILTER(ObjectImportLine);

                                 IF PathToExport <> '' THEN BEGIN

                                   Progressbar.Open(ctExportingObjects, 0);
                                   Progressbar.BarSize := ObjectImportLine.COUNT;

                                   IF ObjectImportLine.FINDSET THEN
                                     REPEAT

                                       Progressbar.AddToBar(1);

                                       FileName := FileNameMgt.FileName(ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine.Name);

                                       oFile.TEXTMODE(TRUE);
                                       oFile.WRITEMODE(TRUE);
                                       oFile.CREATE(PathToExport + FileName);

                                       IF ObjectImportLine."New Name" <> '' THEN
                                         WriteObjectToFile(oFile, ObjectImportLine, ObjectImportLine."New Database Code");

                                       oFile.CLOSE;

                                       SourceControl.SetStampToFile(PathToExport + FileName, ObjectImportLine."New Date", ObjectImportLine."New Time");

                                     UNTIL ObjectImportLine.NEXT = 0;

                                   Progressbar.Close;

                                 END;
                               END;
                                }
      { 22      ;2   ;ActionGroup;
                      CaptionML=[DEU=Mark;
                                 ENU=Mark;
                                 ESP=Mark;
                                 FRA=Mark;
                                 NLD=Objecten markeren;
                                 DEA=Mark];
                      Image=EditFilter }
      { 23      ;3   ;Action    ;
                      CaptionML=[DEU=Mark Objects;
                                 ENU=Mark Objects;
                                 ESP=Mark Objects;
                                 FRA=Mark Objects;
                                 NLD=Objecten markeren &rechter database;
                                 DEA=Mark Objects];
                      Image=EditFilter;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 NAVDatabase@1001 : Record 11102099;
                                 DatabaseMgt@1002 : Codeunit 11102083;
                               BEGIN
                                 NAVDatabase.GET(RightDatabaseCode);

                                 CurrPage.SETSELECTIONFILTER(ObjectImportLine);
                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT
                                     DatabaseMgt.MarkObject(NAVDatabase, ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine."New Version List");
                                     ObjectImportLine.MODIFY;
                                   UNTIL ObjectImportLine.NEXT = 0;
                               END;
                                }
      { 24      ;3   ;Action    ;
                      CaptionML=[DEU=Remove Marks;
                                 ENU=Remove Marks;
                                 ESP=Remove Marks;
                                 FRA=Remove Marks;
                                 NLD=Verwijder markeringen re&chter database;
                                 DEA=Remove Marks];
                      Image=RemoveFilterLines;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 NAVDatabase@1001 : Record 11102099;
                                 DatabaseMgt@1002 : Codeunit 11102083;
                               BEGIN
                                 NAVDatabase.GET(RightDatabaseCode);

                                 CurrPage.SETSELECTIONFILTER(ObjectImportLine);
                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT
                                     DatabaseMgt.RemoveMarkObject(NAVDatabase, ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine."New Version List");
                                     ObjectImportLine.MODIFY;
                                   UNTIL ObjectImportLine.NEXT = 0;
                               END;
                                }
      { 25      ;3   ;Action    ;
                      CaptionML=[DEU=Remove all Marks;
                                 ENU=Remove all Marks;
                                 ESP=Remove all Marks;
                                 FRA=Remove all Marks;
                                 NLD=Verwijder alle markeringen rechter &database;
                                 DEA=Remove all Marks];
                      Image=ClearFilter;
                      OnAction=VAR
                                 ObjectImportLine@1000 : Record 11102079;
                                 NAVDatabase@1001 : Record 11102099;
                                 DatabaseMgt@1002 : Codeunit 11102083;
                               BEGIN
                                 NAVDatabase.GET(RightDatabaseCode);

                                 ObjectImportLine.SETRANGE("Line Type", ObjectImportLine."Line Type"::"Database Compare Sheet");
                                 ObjectImportLine.SETFILTER("New Version List", '#*');
                                 IF ObjectImportLine.FINDSET THEN
                                   REPEAT
                                     DatabaseMgt.RemoveMarkObject(NAVDatabase, ObjectImportLine.Type, ObjectImportLine."No.", ObjectImportLine."New Version List");
                                     ObjectImportLine.MODIFY;
                                   UNTIL ObjectImportLine.NEXT = 0;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 26  ;0   ;Container ;
                ContainerType=ContentArea }

    { 27  ;1   ;Group      }

    { 28  ;2   ;Field     ;
                CaptionML=[DEU=Left is Current Database;
                           ENU=Left is Current Database;
                           ESP=Left is Current Database;
                           FRA=Left is Current Database;
                           NLD=Linker database is huidige database;
                           DEA=Left is Current Database];
                SourceExpr=LeftIsCurrentDatabase;
                OnValidate=BEGIN
                             SetDatabaseFilters;
                             CurrPage.UPDATE;
                           END;
                            }

    { 29  ;2   ;Field     ;
                CaptionML=[DEU=Left Database;
                           ENU=Left Database;
                           ESP=Left Database;
                           FRA=Left Database;
                           NLD=Linker database;
                           DEA=Left Database];
                SourceExpr=LeftDatabaseCode;
                TableRelation="OM - NAV Database";
                Enabled=NOT LeftIsCurrentDatabase;
                OnValidate=BEGIN
                             SetDatabaseFilters;
                             CurrPage.UPDATE;
                           END;
                            }

    { 30  ;2   ;Field     ;
                CaptionML=[DEU=Right Database;
                           ENU=Right Database;
                           ESP=Right Database;
                           FRA=Right Database;
                           NLD=Rechter database;
                           DEA=Right Database];
                SourceExpr=RightDatabaseCode;
                TableRelation="OM - NAV Database";
                OnValidate=BEGIN
                             SetDatabaseFilters;
                             CurrPage.UPDATE;
                           END;
                            }

    { 71  ;2   ;Field     ;
                CaptionML=[DEU=Use Command Line;
                           ENU=Use Command Line;
                           ESP=Use Command Line;
                           FRA=Use Command Line;
                           NLD=Command-line gebruiken;
                           DEA=Use Command Line];
                SourceExpr=UseCommandLine;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 31  ;2   ;Field     ;
                SourceExpr=ImportFileName;
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr=ExportFileName;
                Visible=FALSE }

    { 33  ;1   ;Group     ;
                GroupType=Repeater }

    { 34  ;2   ;Field     ;
                SourceExpr=Type;
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 35  ;2   ;Field     ;
                SourceExpr="No.";
                Editable=FALSE;
                LookupPageID=OM - Object List;
                StyleExpr=LeftRowStyle }

    { 36  ;2   ;Field     ;
                SourceExpr=Name;
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 37  ;2   ;Field     ;
                SourceExpr=Modified;
                Visible=FALSE;
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 38  ;2   ;Field     ;
                SourceExpr="Version List";
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 39  ;2   ;Field     ;
                SourceExpr="Object Date";
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 40  ;2   ;Field     ;
                SourceExpr="Object Time";
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 41  ;2   ;Field     ;
                SourceExpr=Compiled;
                Visible=FALSE;
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 42  ;2   ;Field     ;
                CaptionML=[DEU=Active Projects;
                           ENU=Active Projects;
                           ESP=Active Projects;
                           FRA=Active Projects;
                           NLD=Actieve projecten;
                           DEA=Active Projects];
                SourceExpr=ActiveProjectsText;
                StyleExpr=LeftRowStyle;
                OnAssistEdit=BEGIN
                               AssistEditActiveProjects;
                               ReadActiveProjects;
                             END;
                              }

    { 43  ;2   ;Field     ;
                SourceExpr=Left;
                Editable=FALSE;
                StyleExpr=LeftRowStyle }

    { 44  ;2   ;Field     ;
                SourceExpr=Different;
                Editable=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr=Right;
                Editable=FALSE;
                StyleExpr=RightRowStyle }

    { 46  ;2   ;Field     ;
                SourceExpr="New Name";
                Editable=FALSE;
                StyleExpr=RightRowStyle }

    { 47  ;2   ;Field     ;
                SourceExpr="New Modified";
                Visible=FALSE;
                Editable=FALSE;
                StyleExpr=RightRowStyle }

    { 48  ;2   ;Field     ;
                SourceExpr="New Version List";
                Editable=FALSE;
                StyleExpr=RightRowStyle }

    { 49  ;2   ;Field     ;
                SourceExpr="New Date";
                Editable=FALSE;
                StyleExpr=RightRowStyle }

    { 50  ;2   ;Field     ;
                SourceExpr="New Time";
                Editable=FALSE;
                StyleExpr=RightRowStyle }

    { 51  ;2   ;Field     ;
                SourceExpr="New Compiled";
                Visible=FALSE;
                Editable=FALSE;
                StyleExpr=RightRowStyle }

    { 52  ;1   ;Group      }

    { 53  ;2   ;Group     ;
                CaptionML=[DEU=Left;
                           ENU=Left;
                           ESP=Left;
                           FRA=Left;
                           NLD=Links;
                           DEA=Left];
                GroupType=Group }

    { 54  ;3   ;Field     ;
                Name=NameFooter;
                SourceExpr=Name;
                Editable=FALSE;
                StyleExpr=NameFooterStyle }

    { 55  ;3   ;Field     ;
                Name=ModifiedFooter;
                SourceExpr=Modified;
                Editable=FALSE;
                StyleExpr=ModifiedFooterStyle }

    { 56  ;3   ;Field     ;
                Name=VersionListFooter;
                SourceExpr="Version List";
                Editable=FALSE;
                StyleExpr=VersionListFooterStyle }

    { 57  ;3   ;Field     ;
                Name=ObjectDateFooter;
                SourceExpr="Object Date";
                Editable=FALSE;
                StyleExpr=DateFooterStyle }

    { 58  ;3   ;Field     ;
                Name=ObjectTimeFooter;
                SourceExpr="Object Time";
                Editable=FALSE;
                StyleExpr=TimeFooterStyle }

    { 59  ;2   ;Group     ;
                CaptionML=[DEU=Right;
                           ENU=Right;
                           ESP=Right;
                           FRA=Right;
                           NLD=Rechts;
                           DEA=Right];
                GroupType=Group }

    { 60  ;3   ;Field     ;
                Name=NewNameFooter;
                CaptionML=[DEU=Name;
                           ENU=Name;
                           ESP=Name;
                           FRA=Name;
                           NLD=Naam;
                           DEA=Name];
                SourceExpr="New Name";
                Editable=FALSE;
                StyleExpr=NameFooterStyle }

    { 61  ;3   ;Field     ;
                Name=NewModifiedFooter;
                CaptionML=[DEU=Modified;
                           ENU=Modified;
                           ESP=Modified;
                           FRA=Modified;
                           NLD=Gewijzigd;
                           DEA=Modified];
                SourceExpr="New Modified";
                Editable=FALSE;
                StyleExpr=ModifiedFooterStyle }

    { 62  ;3   ;Field     ;
                Name=NewVersionListFooter;
                CaptionML=[DEU=Version No.;
                           ENU=Version No.;
                           ESP=Version No.;
                           FRA=Version No.;
                           NLD=Versielijst;
                           DEA=Version No.];
                SourceExpr="New Version List";
                Editable=FALSE;
                StyleExpr=VersionListFooterStyle }

    { 63  ;3   ;Field     ;
                Name=NewDateFooter;
                CaptionML=[DEU=Date;
                           ENU=Date;
                           ESP=Date;
                           FRA=Date;
                           NLD=Datum;
                           DEA=Date];
                SourceExpr="New Date";
                Editable=FALSE;
                StyleExpr=DateFooterStyle }

    { 64  ;3   ;Field     ;
                Name=NewTimeFooter;
                CaptionML=[DEU=Time;
                           ENU=Time;
                           ESP=Time;
                           FRA=Time;
                           NLD=Tijd;
                           DEA=Time];
                SourceExpr="New Time";
                Editable=FALSE;
                StyleExpr=TimeFooterStyle }

    { 65  ;1   ;Field     ;
                SourceExpr=Initialized;
                Visible=FALSE }

  }
  CODE
  {
    VAR
      TmpProjectObject@1000 : TEMPORARY Record 11102037;
      CompiledFooterStyle@1001 : Text INDATASET;
      DateFooterStyle@1002 : Text INDATASET;
      ExportFileName@1003 : Text;
      ImportFileName@1004 : Text;
      LeftRowStyle@1005 : Text INDATASET;
      ModifiedFooterStyle@1006 : Text INDATASET;
      NameFooterStyle@1007 : Text INDATASET;
      RightRowStyle@1008 : Text INDATASET;
      TimeFooterStyle@1009 : Text INDATASET;
      VersionListFooterStyle@1010 : Text INDATASET;
      LeftDatabaseCode@1011 : Code[20];
      RightDatabaseCode@1012 : Code[20];
      Initialized@1013 : Boolean;
      LeftIsCurrentDatabase@1014 : Boolean INDATASET;
      UseCommandLine@1015 : Boolean;

    LOCAL PROCEDURE Refresh@1();
    VAR
      ObjectImportLine@1000 : Record 11102079;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ObjectImportLine);
      ObjectImportLine.MARKEDONLY(TRUE);
      IF ObjectImportLine.COUNT > 1 THEN
        RefreshSelection(ObjectImportLine)
      ELSE
        RefreshAll;
    END;

    LOCAL PROCEDURE RefreshAll@2();
    VAR
      ObjectImportLine@1000 : Record 11102079;
      NAVDatabase@1001 : Record 11102099;
      Object@1002 : Record 2000000001;
      TmpObject@1003 : TEMPORARY Record 2000000001;
      Progressbar@1004 : Codeunit 11102044;
      DatabaseMgt@1005 : Codeunit 11102083;
      ctRefreshingObjects@1006 : TextConst 'DEU=Refreshing...;ENU=Refreshing...;ESP=Refreshing...;FRA=Refreshing...;NLD=Vernieuwen...;DEA=Refreshing...';
    BEGIN
      ObjectImportLine.SETRANGE("Line Type", ObjectImportLine."Line Type"::"Database Compare Sheet");
      ObjectImportLine.DELETEALL;

      Progressbar.Open(ctRefreshingObjects, 0);

      IF LeftIsCurrentDatabase THEN BEGIN
        Object.SETFILTER(Type, '<>%1', Object.Type::TableData);
        SetObjectsToLeft(Object, '', Progressbar, 0, 40);
      END ELSE
        IF LeftDatabaseCode <> '' THEN BEGIN
          NAVDatabase.GET(LeftDatabaseCode);
          DatabaseMgt.GetObjectProperties(NAVDatabase, TmpObject, Progressbar, 0, 20);
          SetObjectsToLeft(TmpObject, LeftDatabaseCode, Progressbar, 20, 40);
        END;

      IF RightDatabaseCode <> '' THEN BEGIN
        TmpObject.DELETEALL;
        NAVDatabase.GET(RightDatabaseCode);
        DatabaseMgt.GetObjectProperties(NAVDatabase, TmpObject, Progressbar, 40, 60);
        SetObjectsToRight(TmpObject, RightDatabaseCode, Progressbar, 60, 80);
      END;

      SetCompareFields(Progressbar, 80, 100);

      ReadActiveProjects;

      Progressbar.Close;
    END;

    LOCAL PROCEDURE RefreshSelection@3(VAR ObjectImportLine@1000 : Record 11102079);
    VAR
      NAVDatabase@1001 : Record 11102099;
      Object@1002 : Record 2000000001;
      TmpCurrObject@1003 : TEMPORARY Record 2000000001;
      TmpObject@1004 : TEMPORARY Record 2000000001;
      Progressbar@1005 : Codeunit 11102044;
      DatabaseMgt@1006 : Codeunit 11102083;
      ctRefreshingObjects@1007 : TextConst 'DEU=Refreshing...;ENU=Refreshing...;ESP=Refreshing...;FRA=Refreshing...;NLD=Vernieuwen...;DEA=Refreshing...';
    BEGIN
      Progressbar.Open(ctRefreshingObjects, 0);

      Progressbar.UseRange(0, 20);
      Progressbar.BarSize := ObjectImportLine.COUNT;

      IF ObjectImportLine.FINDSET THEN
        REPEAT
          Progressbar.AddToBar(1);

          TmpObject.Type := ObjectImportLine.Type;
          TmpObject.ID := ObjectImportLine."No.";
          TmpObject.INSERT;
          IF Object.GET(ObjectImportLine.Type, '', ObjectImportLine."No.") THEN BEGIN
            TmpCurrObject := Object;
            TmpCurrObject.INSERT;
          END;
        UNTIL ObjectImportLine.NEXT = 0;

      IF LeftIsCurrentDatabase THEN
        SetObjectsToLeft(TmpCurrObject, '', Progressbar, 20, 50)
      ELSE BEGIN
        NAVDatabase.GET(LeftDatabaseCode);
        DatabaseMgt.GetObjectPropertiesSelection(NAVDatabase, TmpObject, Progressbar, 20, 35);
        SetObjectsToLeft(TmpObject, LeftDatabaseCode, Progressbar, 35, 50);
      END;

      NAVDatabase.GET(RightDatabaseCode);
      DatabaseMgt.GetObjectPropertiesSelection(NAVDatabase, TmpObject, Progressbar, 50, 70);
      SetObjectsToRight(TmpObject, RightDatabaseCode, Progressbar, 70, 90);

      SetCompareFields(Progressbar, 90, 100);
    END;

    LOCAL PROCEDURE SetCompareFields@4(VAR Progressbar@1000 : Codeunit 11102044;ProgressbarFrom@1001 : Integer;ProgressbarTo@1002 : Integer);
    VAR
      ObjectImportLine@1003 : Record 11102079;
      OriginalObjectImportLine@1004 : Record 11102079;
      VersionControl@1005 : Codeunit 11102040;
      SourceControl@1006 : Codeunit 11102050;
      NewObjectDateTime@1007 : DateTime;
      ObjectDateTime@1008 : DateTime;
    BEGIN
      ObjectImportLine.SETRANGE("Line Type", ObjectImportLine."Line Type"::"Database Compare Sheet");

      Progressbar.BarSize := ObjectImportLine.COUNT;
      Progressbar.UseRange(ProgressbarFrom, ProgressbarTo);

      IF ObjectImportLine.FINDSET THEN
        REPEAT

          Progressbar.AddToBar(1);

          OriginalObjectImportLine := ObjectImportLine;

          ObjectImportLine.Left := ObjectImportLine.Left::" ";
          ObjectImportLine.Different := FALSE;
          ObjectImportLine.Right := ObjectImportLine.Right::" ";

          IF ObjectImportLine.Name = '' THEN BEGIN
            ObjectImportLine.Right := ObjectImportLine.Right::Orphan;
            ObjectImportLine.Different := TRUE;
          END;

          IF ObjectImportLine."New Name" = '' THEN BEGIN
            ObjectImportLine.Left := ObjectImportLine.Left::Orphan;
            ObjectImportLine.Different := TRUE;
          END;

          IF (ObjectImportLine.Name <> '') AND (ObjectImportLine."New Name" <> '') THEN BEGIN

            ObjectDateTime := SourceControl.CreateDateTime2(ObjectImportLine."Object Date", ObjectImportLine."Object Time");
            NewObjectDateTime := SourceControl.CreateDateTime2(ObjectImportLine."New Date", ObjectImportLine."New Time");

            IF (ObjectImportLine."Object Date" <> 0D) AND (ObjectImportLine."New Date" <> 0D) THEN
              IF ObjectImportLine."Object Date" = ObjectImportLine."New Date" THEN
                IF ABS(ObjectDateTime - NewObjectDateTime) < 1000 THEN BEGIN
                  ObjectImportLine."Object Time" := ObjectImportLine."New Time";
                  ObjectDateTime := SourceControl.CreateDateTime2(ObjectImportLine."Object Date", ObjectImportLine."Object Time");
                END;

            IF (ObjectImportLine.Name <> ObjectImportLine."New Name") OR
               (ObjectImportLine.Modified <> ObjectImportLine."New Modified") OR
               (VersionControl.CleanUpVersionList(ObjectImportLine."Version List") <>
                 VersionControl.CleanUpVersionList(ObjectImportLine."New Version List")) OR
               (ObjectImportLine."Object Date" <> ObjectImportLine."New Date") OR
               (ObjectImportLine."Object Time" <> ObjectImportLine."New Time") OR
               (ObjectImportLine.Compiled <> ObjectImportLine."New Compiled")
            THEN BEGIN
              ObjectImportLine.Different := TRUE;

              IF ObjectDateTime < NewObjectDateTime THEN BEGIN
                ObjectImportLine.Left := ObjectImportLine.Left::Older;
                ObjectImportLine.Right := ObjectImportLine.Right::Newer;
              END;

              IF ObjectDateTime > NewObjectDateTime THEN BEGIN
                ObjectImportLine.Left := ObjectImportLine.Left::Newer;
                ObjectImportLine.Right := ObjectImportLine.Right::Older;
              END;

            END;

          END;

          IF (ObjectImportLine."Database Code" <> LeftDatabaseCode2) OR
             (ObjectImportLine."New Database Code" <> RightDatabaseCode) OR
             (ObjectImportLine.Left <> OriginalObjectImportLine.Left) OR
             (ObjectImportLine.Different <> OriginalObjectImportLine.Different) OR
             (ObjectImportLine.Right <> OriginalObjectImportLine.Right)
          THEN BEGIN
            ObjectImportLine."Database Code" := LeftDatabaseCode2;
            ObjectImportLine."New Database Code" := RightDatabaseCode;
            ObjectImportLine.MODIFY;
          END;

        UNTIL ObjectImportLine.NEXT = 0;
    END;

    LOCAL PROCEDURE SetObjectsToLeft@5(VAR Object@1000 : Record 2000000001;DatabaseCode@1001 : Code[20];VAR Progressbar@1002 : Codeunit 11102044;ProgressbarFrom@1003 : Integer;ProgressbarTo@1004 : Integer);
    VAR
      ObjectImportLine@1005 : Record 11102079;
      DoInsert@1006 : Boolean;
    BEGIN
      Progressbar.BarSize := Object.COUNT;
      Progressbar.UseRange(ProgressbarFrom, ProgressbarTo);

      IF Object.FINDSET THEN
        REPEAT

          Progressbar.AddToBar(1);

          DoInsert := NOT ObjectImportLine.GET(ObjectImportLine."Line Type"::"Database Compare Sheet", Object.Type, Object.ID);

          IF DoInsert THEN BEGIN
            ObjectImportLine.INIT;
            ObjectImportLine."Line Type" := ObjectImportLine."Line Type"::"Database Compare Sheet";
            ObjectImportLine.Type := Object.Type;
            ObjectImportLine."No." := Object.ID;
          END;

          ObjectImportLine."Line Type" := ObjectImportLine."Line Type"::"Database Compare Sheet";
          ObjectImportLine."Database Code" := DatabaseCode;
          ObjectImportLine.Type := Object.Type;
          ObjectImportLine."No." := Object.ID;
          ObjectImportLine.Name := Object.Name;
          ObjectImportLine.Modified := Object.Modified;
          ObjectImportLine."Version List" := Object."Version List";
          ObjectImportLine."Object Date" := Object.Date;
          ObjectImportLine."Object Time" := Object.Time;
          ObjectImportLine.Compiled := Object.Compiled;
          ObjectImportLine.Updated := Object."DBM Table No.";

          IF DoInsert THEN
            ObjectImportLine.INSERT
          ELSE
            ObjectImportLine.MODIFY;

        UNTIL Object.NEXT = 0;
    END;

    LOCAL PROCEDURE SetObjectsToRight@6(VAR Object@1000 : Record 2000000001;DatabaseCode@1001 : Code[20];VAR Progressbar@1002 : Codeunit 11102044;ProgressbarFrom@1003 : Integer;ProgressbarTo@1004 : Integer);
    VAR
      ObjectImportLine@1005 : Record 11102079;
      DoInsert@1006 : Boolean;
    BEGIN
      Progressbar.BarSize := Object.COUNT;
      Progressbar.UseRange(ProgressbarFrom, ProgressbarTo);

      IF Object.FINDSET THEN
        REPEAT

          Progressbar.AddToBar(1);

          DoInsert := NOT ObjectImportLine.GET(ObjectImportLine."Line Type"::"Database Compare Sheet", Object.Type, Object.ID);

          IF DoInsert THEN BEGIN
            ObjectImportLine.INIT;
            ObjectImportLine."Line Type" := ObjectImportLine."Line Type"::"Database Compare Sheet";
            ObjectImportLine.Type := Object.Type;
            ObjectImportLine."No." := Object.ID;
          END;

          ObjectImportLine."New Database Code" := DatabaseCode;
          ObjectImportLine."New Name" := Object.Name;
          ObjectImportLine."New Modified" := Object.Modified;
          ObjectImportLine."New Version List" := Object."Version List";
          ObjectImportLine."New Date" := Object.Date;
          ObjectImportLine."New Time" := Object.Time;
          ObjectImportLine."New Compiled" := Object.Compiled;
          ObjectImportLine."New Updated" := Object."DBM Table No.";

          IF DoInsert THEN
            ObjectImportLine.INSERT
          ELSE
            ObjectImportLine.MODIFY;

        UNTIL Object.NEXT = 0;
    END;

    LOCAL PROCEDURE SetDatabaseFilters@7();
    BEGIN
      FILTERGROUP(10);
      IF LeftIsCurrentDatabase THEN
        SETRANGE("Database Code", '')
      ELSE
        SETRANGE("Database Code", LeftDatabaseCode);

      SETRANGE("New Database Code", RightDatabaseCode);

      FILTERGROUP(0);
    END;

    LOCAL PROCEDURE WriteObjectToFile@8(VAR oFile@1000 : File;ObjectImportLine@1001 : Record 11102079;DatabaseCode@1002 : Code[20]);
    VAR
      CALHistoryObject@1003 : Record 11102052;
      TmpCALHistoryLine@1004 : TEMPORARY Record 11102053;
      NAVDatabase@1005 : Record 11102099;
      Object@1006 : Record 2000000001;
      SourceControl@1007 : Codeunit 11102050;
      DatabaseMgt@1008 : Codeunit 11102083;
    BEGIN
      Object.Type := ObjectImportLine.Type;
      Object.ID := ObjectImportLine."No.";

      IF DatabaseCode = '' THEN BEGIN

        IF Object.FIND('=') THEN
          IF CALHistoryObject.TryGoToLastRecord(Object.Type, Object.ID) THEN
            SourceControl.AppendHistoryObjectToFile(oFile, CALHistoryObject."Entry No.");

      END ELSE BEGIN

        NAVDatabase.GET(DatabaseCode);
        DatabaseMgt.GetObjectContent(NAVDatabase, Object, TmpCALHistoryLine);
        SourceControl.AppendHistoryLinesToFile(oFile, TmpCALHistoryLine);

      END;
    END;

    LOCAL PROCEDURE GetRowStyle@9(Updated@1000 : 'Updated,Outdated,Error') : Text;
    BEGIN
      CASE Updated OF
        Updated::Error :
          EXIT('Unfavorable');

        Updated::Outdated :
          EXIT('Attention');

      END;
    END;

    LOCAL PROCEDURE ReadActiveProjects@10();
    VAR
      Project@1000 : Record 11102036;
      ProjectObject@1001 : Record 11102037;
    BEGIN
      TmpProjectObject.RESET;
      TmpProjectObject.DELETEALL;

      Project.SETCURRENTKEY("Status Type");
      Project.SETRANGE("Status Type", Project."Status Type"::Developing);
      IF Project.FINDSET THEN
        REPEAT
          ProjectObject.SETRANGE("Project No.", Project."No.");
          IF ProjectObject.FINDSET THEN
            REPEAT
              TmpProjectObject := ProjectObject;
              TmpProjectObject.INSERT;
            UNTIL ProjectObject.NEXT = 0;
        UNTIL Project.NEXT = 0;
    END;

    LOCAL PROCEDURE ActiveProjectsText@11() ExitValue : Text;
    VAR
      TmpProject@1000 : TEMPORARY Record 11102036;
    BEGIN
      GetActiveProjects(TmpProject);
      IF TmpProject.FINDSET THEN
        REPEAT
          IF STRLEN(ExitValue + ', ' + TmpProject."No.") < 1024 THEN
            IF ExitValue = '' THEN
              ExitValue := TmpProject."No."
            ELSE
              ExitValue := ExitValue + ', ' + TmpProject."No.";
        UNTIL TmpProject.NEXT = 0;
    END;

    LOCAL PROCEDURE AssistEditActiveProjects@12();
    VAR
      TmpProject@1000 : TEMPORARY Record 11102036;
    BEGIN
      GetActiveProjects(TmpProject);
      IF TmpProject.FINDFIRST THEN
        ;
      PAGE.RUNMODAL(PAGE::"OM - Projects", TmpProject);
    END;

    LOCAL PROCEDURE GetActiveProjects@13(VAR Project@1000 : Record 11102036);
    VAR
      Project2@1001 : Record 11102036;
    BEGIN
      TmpProjectObject.SETRANGE("Object Type", Type);
      TmpProjectObject.SETRANGE("Object No.", "No.");

      IF TmpProjectObject.FINDSET THEN
        REPEAT
          IF Project2.GET(TmpProjectObject."Project No.") THEN
            IF NOT Project.GET(Project2."No.") THEN BEGIN
              Project := Project2;
              Project.INSERT;
            END;
        UNTIL TmpProjectObject.NEXT = 0;
    END;

    LOCAL PROCEDURE OpenFile@14(LeftDatabase@1000 : Boolean);
    VAR
      TmpCALHistoryObject@1001 : TEMPORARY Record 11102052;
      TmpCALHistoryLine@1002 : TEMPORARY Record 11102053;
      TmpObject@1003 : TEMPORARY Record 2000000001;
      ImExportMgt@1004 : Codeunit 11102043;
      Progressbar@1005 : Codeunit 11102044;
      SourceControl@1006 : Codeunit 11102050;
      CommonDialog@1007 : Codeunit 11102059;
      ServerFileName@1008 : Text;
      ctAll@1009 : TextConst 'DEU="Object Files|*.txt;*.obp";ENU="Object Files|*.txt;*.obp";ESP="Object Files|*.txt;*.obp";FRA="Object Files|*.txt;*.obp";NLD="Object Files|*.txt;*.obp";DEA="Object Files|*.txt;*.obp"';
      ctImportingObjects@1010 : TextConst 'DEU=Importing objects...;ENU=Importing objects...;ESP=Importing objects...;FRA=Importing objects...;NLD=Objecten importeren...;DEA=Importing objects...';
      ctNotValid@1011 : TextConst 'DEU=The extension ''%1'' is not valid.;ENU=The extension ''%1'' is not valid.;ESP=The extension ''%1'' is not valid.;FRA=The extension ''%1'' is not valid.;NLD=De extensie ''%1'' is niet geldig.;DEA=The extension ''%1'' is not valid.';
    BEGIN
      CommonDialog.AddExtension(ctAll, '');

      CommonDialog.AddKnownExtension('txt');
      CommonDialog.AddKnownExtension('obp');

      IF NOT CommonDialog.OpenFile(ImportFileName, ServerFileName) THEN
        EXIT;

      CASE CommonDialog.GetExtension OF

        'txt' :
          BEGIN
            Progressbar.Open(ctImportingObjects, 1);
            Progressbar.BarSize := ImExportMgt.LengthOfFile(ServerFileName);
            SourceControl.ImportTextFile2(ServerFileName, 1, Progressbar, 0, TmpCALHistoryObject, TmpCALHistoryLine, TRUE);
            IF TmpCALHistoryObject.FINDSET THEN
              REPEAT
                TmpCALHistoryObject.FillObjectFields(TmpObject);
                TmpObject.Compiled := TRUE;
                TmpObject.INSERT;
              UNTIL TmpCALHistoryObject.NEXT = 0;
          END;

        'obp' :
          ImExportMgt.ImportObpFromFile(ServerFileName, TmpObject);

        ELSE
          ERROR(ctNotValid, LOWERCASE(COPYSTR(ImportFileName, STRLEN(ImportFileName) - 2)));
      END;

      Progressbar.Open(ctImportingObjects, 0);
      IF LeftDatabase THEN
        SetObjectsToLeft(TmpObject, LeftDatabaseCode2, Progressbar, 0, 50)
      ELSE
        SetObjectsToRight(TmpObject, '', Progressbar, 0, 50);

      SetCompareFields(Progressbar, 50, 100);
    END;

    LOCAL PROCEDURE LeftDatabaseCode2@15() : Code[20];
    BEGIN
      IF NOT LeftIsCurrentDatabase THEN
        EXIT(LeftDatabaseCode);
    END;

    LOCAL PROCEDURE SetFooterStyle@17();
    BEGIN
      IF (Name <> '') AND ("New Name" <> '') THEN BEGIN
        NameFooterStyle := DifferentStyle(Name <> "New Name");
        ModifiedFooterStyle := DifferentStyle(Modified <> "New Modified");
        VersionListFooterStyle := DifferentStyle("Version List" <> "New Version List");
        DateFooterStyle := DifferentStyle("Object Date" <> "New Date");
        TimeFooterStyle := DifferentStyle("Object Time" <> "New Time");
        CompiledFooterStyle := DifferentStyle(Compiled <> "New Compiled");
      END ELSE BEGIN
        NameFooterStyle := DifferentStyle(FALSE);
        ModifiedFooterStyle := DifferentStyle(FALSE);
        VersionListFooterStyle := DifferentStyle(FALSE);
        DateFooterStyle := DifferentStyle(FALSE);
        TimeFooterStyle := DifferentStyle(FALSE);
        CompiledFooterStyle := DifferentStyle(FALSE);
      END;
    END;

    LOCAL PROCEDURE DifferentStyle@16(IsDifferent@1000 : Boolean) : Text;
    BEGIN
      IF IsDifferent THEN
        EXIT('Unfavorable');
    END;

    LOCAL PROCEDURE GetSelectedObjects@18(VAR TmpObject@1000 : TEMPORARY Record 2000000001;Left@1001 : Boolean);
    VAR
      ObjectImportLine@1002 : Record 11102079;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ObjectImportLine);
      IF Left THEN
        ObjectImportLine.SETFILTER(Name, '<>%1', '')
      ELSE
        ObjectImportLine.SETFILTER("New Name", '<>%1', '');

      IF ObjectImportLine.FINDSET THEN
        REPEAT
          TmpObject.Type := ObjectImportLine.Type;
          TmpObject.ID := ObjectImportLine."No.";
          IF Left THEN
            TmpObject.Name := ObjectImportLine.Name
          ELSE
            TmpObject.Name := ObjectImportLine."New Name";
          TmpObject.INSERT;
        UNTIL ObjectImportLine.NEXT = 0;
    END;

    LOCAL PROCEDURE MergeInto@19(IntoRight@1000 : Boolean);
    VAR
      TmpObject@1001 : TEMPORARY Record 2000000001;
      PushObjects@1002 : Codeunit 11102098;
    BEGIN
      GetSelectedObjects(TmpObject, FALSE);

      IF NOT LeftIsCurrentDatabase THEN
        PushObjects.SetFromDatabaseCode(LeftDatabaseCode);

      PushObjects.SetToDatabaseCode(RightDatabaseCode);

      PushObjects.MergeInto(TmpObject, IntoRight);
    END;

    BEGIN
    END.
  }
}

