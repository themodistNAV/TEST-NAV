OBJECT Report 5982 Maintenance Performance
{
  OBJECT-PROPERTIES
  {
    Date=15/09/15;
    Time=12:00:00 PM;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Maintenance Performance;
               ENG=Maintenance Performance];
    OnInitReport=BEGIN
                   CurrentDate := WORKDATE;
                 END;

    OnPreReport=BEGIN
                  ServContractFilter := "Service Contract Header".GETFILTERS;
                END;

  }
  DATASET
  {
    { 9952;    ;DataItem;                    ;
               DataItemTable=Table5965;
               DataItemTableView=SORTING(Responsibility Center,Service Zone Code,Status,Contract Group Code)
                                 WHERE(Status=CONST(Signed),
                                       Contract Type=CONST(Contract));
               OnPreDataItem=BEGIN
                               IF CurrentDate = 0D THEN
                                 ERROR(Text000);

                               CurrReport.CREATETOTALS(AnnualAmount,ExpectedAmount,ActualAmount);
                             END;

               OnAfterGetRecord=BEGIN
                                  ServContractLine.SETRANGE("Contract Type","Contract Type");
                                  ServContractLine.SETRANGE("Contract No.","Contract No.");
                                  ServContractLine.SETFILTER("Next Planned Service Date",'<>%1',0D);
                                  IF NOT ServContractLine.FINDFIRST THEN
                                    CurrReport.SKIP;

                                  AnnualAmount := 0;
                                  ExpectedAmount := 0;
                                  ActualAmount := 0;

                                  AnnualServices := CalcNoOfVisits("Service Period","Starting Date",0D,TRUE);
                                  ExpectedServices := CalcNoOfVisits("Service Period",
                                      "Starting Date",ServContractLine."Next Planned Service Date",FALSE);

                                  CLEAR(ServShptHeader);
                                  ServShptHeader.SETCURRENTKEY("Contract No.","Posting Date");
                                  ServShptHeader.SETRANGE("Contract No.","Contract No.");
                                  ServShptHeader.SETRANGE("Posting Date",StartingDate,WORKDATE);
                                  ActualServices := 0;
                                  IF ServShptHeader.FIND('-') THEN
                                    REPEAT
                                      IF (ServShptHeader."Posting Date" >= StartingDate) AND (ServShptHeader."Posting Date" <= EndingDate) THEN
                                        ActualServices := ActualServices + 1
                                    UNTIL ServShptHeader.NEXT = 0;

                                  IF AnnualServices > 0 THEN BEGIN
                                    RoundedAmount := ROUND("Annual Amount",1);
                                    AnnualAmount := AnnualAmount + RoundedAmount;
                                    ExpectedAmount := ExpectedAmount + ROUND((RoundedAmount / AnnualServices) * ExpectedServices,1);
                                    ActualAmount := ActualAmount + ROUND((RoundedAmount / AnnualServices) * ActualServices,1);
                                  END;

                                  IF AnnualAmount = 0 THEN
                                    CurrReport.SKIP;

                                  IF NOT RespCenter.GET("Responsibility Center") THEN
                                    CLEAR(RespCenter);
                                END;

               ReqFilterFields=Responsibility Center }

    { 3   ;1   ;Column  ;CompanyName         ;
               SourceExpr=COMPANYNAME }

    { 2   ;1   ;Column  ;TodayFormatted      ;
               SourceExpr=FORMAT(TODAY,0,4) }

    { 4   ;1   ;Column  ;CurrReportPageNo    ;
               SourceExpr=CurrReport.PAGENO }

    { 19  ;1   ;Column  ;SrvcContractHdrFltr ;
               SourceExpr=TABLECAPTION + ': ' + ServContractFilter }

    { 6   ;1   ;Column  ;ServContractFilter  ;
               SourceExpr=ServContractFilter }

    { 18  ;1   ;Column  ;CurrentDateFormatted;
               SourceExpr=Text001 + FORMAT(CALCDATE('<-CY>',CurrentDate)) + ' .. ' + FORMAT(CurrentDate) }

    { 32  ;1   ;Column  ;ActualAmount        ;
               DecimalPlaces=0:0;
               SourceExpr=ActualAmount }

    { 27  ;1   ;Column  ;ExpectedAmount      ;
               DecimalPlaces=0:0;
               SourceExpr=ExpectedAmount }

    { 25  ;1   ;Column  ;AnnualAmount        ;
               DecimalPlaces=0:0;
               SourceExpr=AnnualAmount }

    { 11  ;1   ;Column  ;ResponsCntr_ServiceContractHdr;
               IncludeCaption=Yes;
               SourceExpr="Responsibility Center" }

    { 13  ;1   ;Column  ;RespCenterName      ;
               SourceExpr=RespCenter.Name }

    { 5   ;1   ;Column  ;PageCaption         ;
               SourceExpr=PageCaptionLbl }

    { 1   ;1   ;Column  ;MaintenancePerformanceCaption;
               SourceExpr=MaintenancePerformanceCaptionLbl }

    { 10  ;1   ;Column  ;RealizedCaption     ;
               SourceExpr=RealizedCaptionLbl }

    { 9   ;1   ;Column  ;RealizedAmountCaption;
               SourceExpr=RealizedAmountCaptionLbl }

    { 8   ;1   ;Column  ;ExpectedAmountCaption;
               SourceExpr=ExpectedAmountCaptionLbl }

    { 7   ;1   ;Column  ;AnnualAmountCaption ;
               SourceExpr=AnnualAmountCaptionLbl }

    { 14  ;1   ;Column  ;RespCenterNameCaption;
               SourceExpr=RespCenterNameCaptionLbl }

    { 15  ;1   ;Column  ;TotalCaption        ;
               SourceExpr=TotalCaptionLbl }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 3   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 1   ;1   ;Group     ;
                  CaptionML=[ENU=Options;
                             ENG=Options] }

      { 2   ;2   ;Field     ;
                  CaptionML=[ENU=Current Date;
                             ENG=Current Date];
                  SourceExpr=CurrentDate }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You must enter the current date.;ENG=You must enter the current date.';
      Text001@1001 : TextConst 'ENU="Service Period: ";ENG="Service Period: "';
      ServContractLine@1002 : Record 5964;
      ServShptHeader@1003 : Record 5990;
      RespCenter@1004 : Record 5714;
      AnnualServices@1005 : Decimal;
      ExpectedServices@1006 : Decimal;
      ActualServices@1007 : Decimal;
      RoundedAmount@1008 : Decimal;
      AnnualAmount@1009 : Decimal;
      ExpectedAmount@1010 : Decimal;
      ActualAmount@1011 : Decimal;
      ServContractFilter@1013 : Text;
      StartingDate@1014 : Date;
      EndingDate@1015 : Date;
      CurrentDate@1016 : Date;
      PageCaptionLbl@6215 : TextConst 'ENU=Page;ENG=Page';
      MaintenancePerformanceCaptionLbl@8492 : TextConst 'ENU=Maintenance Performance;ENG=Maintenance Performance';
      RealizedCaptionLbl@5084 : TextConst 'ENU=Realized %;ENG=Realised %';
      RealizedAmountCaptionLbl@9164 : TextConst 'ENU=Realized Amount;ENG=Realised Amount';
      ExpectedAmountCaptionLbl@9258 : TextConst 'ENU=Expected Amount;ENG=Expected Amount';
      AnnualAmountCaptionLbl@9400 : TextConst 'ENU=Annual Amount;ENG=Annual Amount';
      RespCenterNameCaptionLbl@1927 : TextConst 'ENU=Responsibility Center Name;ENG=Responsibility Centre Name';
      TotalCaptionLbl@1909 : TextConst 'ENU=Total;ENG=Total';

    LOCAL PROCEDURE CalcNoOfVisits@2(ServPeriod@1000 : DateFormula;FirstDate@1001 : Date;NextServiceDate@1002 : Date;AllYear@1003 : Boolean) : Integer;
    VAR
      TempDate@1004 : Date;
      i@1005 : Integer;
    BEGIN
      IF FORMAT(ServPeriod) <> '' THEN BEGIN
        i := 0;
        StartingDate := CALCDATE('<-CY>',CurrentDate);
        IF FirstDate > StartingDate THEN
          StartingDate := FirstDate;
        IF AllYear THEN
          EndingDate := CALCDATE('<+CY>',CurrentDate)
        ELSE
          EndingDate := CurrentDate;
        TempDate := StartingDate;
        REPEAT
          IF AllYear THEN BEGIN
            IF TempDate <= EndingDate THEN
              i := i + 1;
          END ELSE BEGIN
            IF (TempDate <= EndingDate) AND (CALCDATE(ServPeriod,TempDate) <= NextServiceDate) THEN
              i := i + 1;
          END;
          TempDate := CALCDATE(ServPeriod,TempDate);
        UNTIL TempDate >= EndingDate;
        EXIT(i);
      END;
      EXIT(0);
    END;

    PROCEDURE InitializeRequest@1(CurrentDateFrom@1000 : Date);
    BEGIN
      CurrentDate := CurrentDateFrom;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>ee33e4b1-f349-403b-8933-e2cdc4244fb7</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="CompanyName">
          <DataField>CompanyName</DataField>
        </Field>
        <Field Name="TodayFormatted">
          <DataField>TodayFormatted</DataField>
        </Field>
        <Field Name="CurrReportPageNo">
          <DataField>CurrReportPageNo</DataField>
        </Field>
        <Field Name="SrvcContractHdrFltr">
          <DataField>SrvcContractHdrFltr</DataField>
        </Field>
        <Field Name="ServContractFilter">
          <DataField>ServContractFilter</DataField>
        </Field>
        <Field Name="CurrentDateFormatted">
          <DataField>CurrentDateFormatted</DataField>
        </Field>
        <Field Name="ActualAmount">
          <DataField>ActualAmount</DataField>
        </Field>
        <Field Name="ActualAmountFormat">
          <DataField>ActualAmountFormat</DataField>
        </Field>
        <Field Name="ExpectedAmount">
          <DataField>ExpectedAmount</DataField>
        </Field>
        <Field Name="ExpectedAmountFormat">
          <DataField>ExpectedAmountFormat</DataField>
        </Field>
        <Field Name="AnnualAmount">
          <DataField>AnnualAmount</DataField>
        </Field>
        <Field Name="AnnualAmountFormat">
          <DataField>AnnualAmountFormat</DataField>
        </Field>
        <Field Name="ResponsCntr_ServiceContractHdr">
          <DataField>ResponsCntr_ServiceContractHdr</DataField>
        </Field>
        <Field Name="RespCenterName">
          <DataField>RespCenterName</DataField>
        </Field>
        <Field Name="PageCaption">
          <DataField>PageCaption</DataField>
        </Field>
        <Field Name="MaintenancePerformanceCaption">
          <DataField>MaintenancePerformanceCaption</DataField>
        </Field>
        <Field Name="RealizedCaption">
          <DataField>RealizedCaption</DataField>
        </Field>
        <Field Name="RealizedAmountCaption">
          <DataField>RealizedAmountCaption</DataField>
        </Field>
        <Field Name="ExpectedAmountCaption">
          <DataField>ExpectedAmountCaption</DataField>
        </Field>
        <Field Name="AnnualAmountCaption">
          <DataField>AnnualAmountCaption</DataField>
        </Field>
        <Field Name="RespCenterNameCaption">
          <DataField>RespCenterNameCaption</DataField>
        </Field>
        <Field Name="TotalCaption">
          <DataField>TotalCaption</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Table1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>0.74803in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.83071in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.06299in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.06299in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.06299in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.55118in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.33307in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ServiceContractHeaderResponsibilityCenterCaption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Parameters!ResponsCntr_ServiceContractHdrCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>17</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="RespCenterNameCaption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!RespCenterNameCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>16</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="AnnualAmountCaption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!AnnualAmountCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>15</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ExpectedAmountCaption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ExpectedAmountCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>14</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="RealizedAmountCaption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!RealizedAmountCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>13</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="RealizedCaption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!RealizedCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>12</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ServiceContractHeaderResponsibilityCenter">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!ResponsCntr_ServiceContractHdr.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>5</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="RespCenterName">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!RespCenterName.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>4</ZIndex>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="AnnualAmount">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!AnnualAmount.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=First(Fields!AnnualAmountFormat.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>3</ZIndex>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ExpectedAmount">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!ExpectedAmount.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=First(Fields!ExpectedAmountFormat.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>2</ZIndex>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ActualAmount">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!ActualAmount.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=First(Fields!ActualAmountFormat.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>1</ZIndex>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Percent">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=code.CalcPct(Sum(Fields!ActualAmount.Value),Sum(Fields!ExpectedAmount.Value))</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Visibility>
                            <Hidden>=IIF(Fields!CompanyName.Value="",True,False)</Hidden>
                          </Visibility>
                          <DataElementOutput>NoOutput</DataElementOutput>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.33307in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TextBox16">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>11</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TotalCaption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TotalCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>10</ZIndex>
                          <Style>
                            <PaddingLeft>2.1cm</PaddingLeft>
                            <PaddingTop>0.423cm</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="AnnualAmountControl29">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!AnnualAmount.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>=First(Fields!AnnualAmountFormat.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>9</ZIndex>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>0.423cm</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ExpectedAmountControl24">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!ExpectedAmount.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>=First(Fields!ExpectedAmountFormat.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>8</ZIndex>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>0.423cm</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ActualAmountControl23">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!ActualAmount.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>=First(Fields!ActualAmountFormat.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>7</ZIndex>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>0.423cm</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox111">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=code.CalcPct(Sum(Fields!ActualAmount.Value),Sum(Fields!ExpectedAmount.Value))</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>6</ZIndex>
                          <Visibility>
                            <Hidden>=IIF(Fields!CompanyName.Value="",True,False)</Hidden>
                          </Visibility>
                          <DataElementOutput>NoOutput</DataElementOutput>
                          <Style>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>0.423cm</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <Group Name="Table1_Group">
                    <GroupExpressions>
                      <GroupExpression>=Fields!ResponsCntr_ServiceContractHdr.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <TablixMembers>
                    <TablixMember>
                      <KeepWithGroup>Before</KeepWithGroup>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>Before</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Top>2.961cm</Top>
            <Height>2.11501cm</Height>
            <Width>16.04998cm</Width>
            <Style />
          </Tablix>
          <Textbox Name="Text001FORMATCALCDATECYCurrentDateFORMATCurrentDate">
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=Fields!CurrentDateFormatted.Value</Value>
                    <Style>
                      <FontSize>7pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Left</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>2.115cm</Top>
            <Height>0.846cm</Height>
            <Width>18cm</Width>
            <ZIndex>1</ZIndex>
            <Visibility>
              <Hidden>=IIF(Fields!CurrReportPageNo.Value&gt;1,True,False)</Hidden>
            </Visibility>
            <DataElementOutput>NoOutput</DataElementOutput>
            <Style />
          </Textbox>
          <Textbox Name="ServiceContractHeaderTABLECAPTIONServContractFilter">
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=Fields!SrvcContractHdrFltr.Value</Value>
                    <Style>
                      <FontSize>7pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <Top>1.692cm</Top>
            <Height>0.423cm</Height>
            <Width>18cm</Width>
            <ZIndex>2</ZIndex>
            <Visibility>
              <Hidden>=IIF(Fields!ServContractFilter.Value="",True,False)</Hidden>
            </Visibility>
            <DataElementOutput>NoOutput</DataElementOutput>
            <Style>
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Textbox>
          <Textbox Name="textbox2">
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=Fields!MaintenancePerformanceCaption.Value</Value>
                    <Style>
                      <FontSize>8pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <Height>0.423cm</Height>
            <Width>9cm</Width>
            <ZIndex>3</ZIndex>
            <Style>
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Textbox>
          <Textbox Name="textbox1">
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=Fields!CompanyName.Value</Value>
                    <Style>
                      <FontSize>7pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <Top>0.423cm</Top>
            <Height>0.423cm</Height>
            <Width>9cm</Width>
            <ZIndex>4</ZIndex>
            <Style>
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Textbox>
          <Textbox Name="textbox6">
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=Fields!PageCaption.Value</Value>
                    <Style>
                      <FontSize>7pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <Top>0.423cm</Top>
            <Left>16.8cm</Left>
            <Height>0.423cm</Height>
            <Width>0.75cm</Width>
            <ZIndex>5</ZIndex>
            <Style>
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Textbox>
          <Textbox Name="textbox5">
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=Fields!TodayFormatted.Value</Value>
                    <Style>
                      <FontSize>7pt</FontSize>
                      <Format>MM-dd-yyyy</Format>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Right</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Left>14.85cm</Left>
            <Height>0.423cm</Height>
            <Width>3.15cm</Width>
            <ZIndex>6</ZIndex>
            <Style>
              <Border />
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Textbox>
          <Textbox Name="textbox4">
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=User!UserID</Value>
                    <Style>
                      <FontSize>7pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Right</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>0.846cm</Top>
            <Left>14.75cm</Left>
            <Height>0.423cm</Height>
            <Width>3.25cm</Width>
            <ZIndex>7</ZIndex>
            <Visibility>
              <Hidden>=IIF(Fields!PageCaption.Value="",True,False)</Hidden>
            </Visibility>
            <DataElementOutput>NoOutput</DataElementOutput>
            <Style>
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Textbox>
          <Textbox Name="textbox3">
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=Fields!CurrReportPageNo.Value</Value>
                    <Style>
                      <FontSize>7pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Right</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>0.423cm</Top>
            <Left>17.55cm</Left>
            <Height>0.423cm</Height>
            <Width>0.45cm</Width>
            <ZIndex>8</ZIndex>
            <Visibility>
              <Hidden>=IIF(Fields!PageCaption.Value="",True,False)</Hidden>
            </Visibility>
            <DataElementOutput>NoOutput</DataElementOutput>
            <Style>
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Textbox>
        </ReportItems>
        <Height>5.07937cm</Height>
        <Style />
      </Body>
      <Width>18.5cm</Width>
      <Page>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <InteractiveHeight>11in</InteractiveHeight>
        <InteractiveWidth>8.5in</InteractiveWidth>
        <LeftMargin>1.5cm</LeftMargin>
        <TopMargin>2cm</TopMargin>
        <BottomMargin>2cm</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="ResponsCntr_ServiceContractHdrCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ResponsCntr_ServiceContractHdrCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>ResponsCntr_ServiceContractHdrCaption</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function

Shared Data1 as Object
Shared Data2 as Object

Public Function GetData(Num as Integer, Group as integer) as Object
  if Group = 1 then
    Return Cstr(Choose(Num, Split(Cstr(Data1),Chr(177))))
  End If
  if Group = 2 then
    Return Cstr(Choose(Num, Split(Cstr(Data2),Chr(177))))
  End If
End Function

Public Function SetData(NewData as Object,Group as integer)
  If Group = 1 and NewData &lt;&gt; "" Then
    Data1 = NewData
  End If
  If Group = 2 and NewData &lt;&gt; "" Then
    Data2 = NewData
  End If
End Function

Shared Pct as Decimal 

Public Function CalcPct(ActAmount as Decimal, ExpAmount as Decimal) as Decimal 
    if ExpAmount &lt;&gt; 0 then
       Pct = 100 * ActAmount / ExpAmount
    else
       Pct = 0
    end if

    Return ROUND(Pct)
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>da5b7005-12f5-48c0-a2b5-834990a354cf</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

